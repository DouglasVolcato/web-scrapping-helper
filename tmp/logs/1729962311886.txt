Request:
{'url': 'https://viamao.govbr.cloud/pronimtb/script.js', 'method': 'GET', 'headers': [('user-agent', 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:131.0) Gecko/20100101 Firefox/131.0'), ('accept', '*/*'), ('accept-language', 'en-US,en;q=0.5'), ('accept-encoding', 'gzip, deflate, br, zstd'), ('referer', 'https://viamao.govbr.cloud/pronimtb/index.asp?acao=4&item=2'), ('sec-fetch-dest', 'script'), ('sec-fetch-mode', 'no-cors'), ('sec-fetch-site', 'same-origin'), ('priority', 'u=2'), ('te', 'trailers'), ('cookie', 'ASPSESSIONIDCEQBRBST=AGHNDONBOOFFBFIAANAMCNHP')], 'params': {}, 'body': b''}

Response:
{'status_code': 200, 'headers': [('content-type', 'application/javascript'), ('last-modified', 'Thu, 26 Sep 2024 20:46:12 GMT'), ('accept-ranges', 'bytes'), ('etag', '"0423e1f5510db1:0"'), ('server', 'Microsoft-IIS/10.0'), ('x-powered-by', 'ASP.NET'), ('date', 'Sat, 26 Oct 2024 17:04:40 GMT'), ('content-length', '282198')], 'body': b'var xmlHttp;\r\nvar msgErro;\r\nvar meuHost = window.location.host;\r\nvar meuHost2 = location.pathname;\r\nvar nomeAplicacaoDWS = "pronimtb";\r\nvar servidorUnico = false;\r\nvar reestruturacao = false;\r\nvar siafic = false;\r\nvar valResultadoPesquisa = "";\r\n\r\n\r\n// 363871 - Pronim TB - Textos de negativas. (Demanda legal)\r\nfunction msnTipoDespesa() {\r\n\r\n    $.ajax({\r\n        type: "GET",\r\n        global: false,\r\n        url: "../acao.asp",\r\n        data: "acao=BuscaTipoDespesas",\r\n        dataType: "json",\r\n        async: false,\r\n        cache: false,\r\n        success: function (jdados) {\r\n\r\n            var dado = jdados.Dados[0];\r\n            var tipoDespesa = dado.text;\r\n            var msgTipoDespesa = $(".msgTipoDespesa");\r\n\r\n            if (tipoDespesa == "6") {\r\n                $(".msgTipoDespesa").val("");\r\n                $(".msgTipoDespesa").append("Nesta op\xe7\xe3o \xe9 poss\xedvel consultar as Despesas de Di\xe1rias e Passagens, caso habilitado. N\xe3o fazemos uso do(s) procedimento(s) administrativo(s) ADIANTAMENTO DE VIAGEM.");\r\n            }\r\n            else if (tipoDespesa == "5") {\r\n                $(".msgTipoDespesa").val("");\r\n                $(".msgTipoDespesa").append("Nesta op\xe7\xe3o \xe9 poss\xedvel consultar as Despesas de Di\xe1rias e Passagens, caso habilitado. N\xe3o fazemos uso do(s) procedimento(s) administrativo(s) PASSAGENS.");\r\n            }\r\n            else if (tipoDespesa == "4") {\r\n                $(".msgTipoDespesa").val("");\r\n                $(".msgTipoDespesa").append("Nesta op\xe7\xe3o \xe9 poss\xedvel consultar as Despesas de Di\xe1rias e Passagens, caso habilitado. N\xe3o fazemos uso do(s) procedimento(s) administrativo(s) DI\xc1RIAS.");\r\n            }\r\n            else if (tipoDespesa == "3") {\r\n                $(".msgTipoDespesa").val("");\r\n                $(".msgTipoDespesa").append("Nesta op\xe7\xe3o \xe9 poss\xedvel consultar as Despesas de Di\xe1rias e Passagens, caso habilitado. N\xe3o fazemos uso do(s) procedimento(s) administrativo(s) DI\xc1RIAS e PASSAGENS.");\r\n            }\r\n            else if (tipoDespesa == "2") {\r\n                $(".msgTipoDespesa").val("");\r\n                $(".msgTipoDespesa").append("Nesta op\xe7\xe3o \xe9 poss\xedvel consultar as Despesas de Di\xe1rias e Passagens, caso habilitado. N\xe3o fazemos uso do(s) procedimento(s) administrativo(s) DI\xc1RIAS e ADIANTAMENTO DE VIAGEM.");\r\n            }\r\n            else if (tipoDespesa == "1") {\r\n                $(".msgTipoDespesa").val("");\r\n                $(".msgTipoDespesa").append("Nesta op\xe7\xe3o \xe9 poss\xedvel consultar as Despesas de Di\xe1rias e Passagens, caso habilitado. N\xe3o fazemos uso do(s) procedimento(s) administrativo(s) PASSAGENS e ADIANTAMENTO DE VIAGEM.");\r\n            }\r\n\r\n        },\r\n        error: function (jerro) {\r\n            $(".msgTipoDespesa").val("");\r\n            $(".msgTipoDespesa").append("Nesta op\xe7\xe3o \xe9 poss\xedvel consultar as Despesas de Di\xe1rias e Passagens.");\r\n        }\r\n    });\r\n}\r\n\r\n\r\n\r\nif (!$.fn.on) {\r\n    $.fn.on = function (ev, data, action) {\r\n        this.live(ev, data, action);\r\n    }\r\n}\r\n\r\nString.prototype.replaceAll = function (search, replacement) {\r\n    var target = this;\r\n    return target.replace(new RegExp(search, \'g\'), replacement);\r\n};\r\n\r\nfunction MostraTela(id) {\r\n    if (document.getElementById(id).style.display == \'block\')\r\n        document.getElementById(id).style.display = \'none\';\r\n    else\r\n        document.getElementById(id).style.display = \'block\';\r\n}\r\n\r\nfunction mudar_cor_over(celula) {\r\n    //celula.style.backgroundColor = "#C3C3C3";\r\n}\r\n\r\nfunction mudar_cor_out(celula, cor) {\r\n    //celula.style.backgroundColor = cor;\r\n}\r\n\r\nfunction OpcaoMenu(acaoMenu, itemMenu) {\r\n    document.getElementById(\'hndAcao\') = acaoMenu;\r\n    document.getElementById(\'hndItem\') = itemMenu;\r\n}\r\n\r\nfunction MudaCorObjeto_In(nome) {\r\n    document.getElementById(nome).style.backgroundColor = \'#F5F5F5\';\r\n}\r\n\r\nfunction MudaCorObjeto_Out(nome) {\r\n    document.getElementById(nome).style.backgroundColor = \'#FFFFFF\';\r\n}\r\n\r\nfunction formataData(campo) {\r\n    var valor = $(campo).val();\r\n    valor = valor.replace(/\\D/g, "")                             //Remove tudo o que n\xe3o \xe9 d\xedgito\r\n    valor = valor.replace(/^(\\d{2})(\\d)/, "$1/$2")               //Coloca uma barra entre o segundo e o terceiro d\xedgitos\r\n    valor = valor.replace(/^(\\d{2})\\/(\\d{2})(\\d)/, "$1/$2/$3")   //Coloca uma barra entre o quarto e o quinto d\xedgitos\r\n    if (valor.length > 10) {\r\n        valor = valor.substring(0, 10);\r\n    }\r\n    $(campo).val(valor);\r\n}\r\n\r\nfunction validaData(campo, opcional) {\r\n    var retorno = true;\r\n    var valor = $(campo).val();\r\n\r\n    if (valor.length >= 10) {\r\n\r\n        if (opcional && valor == "") { retorno = true; }\r\n\r\n        if (retorno && valor != "") { retorno = isDate(valor); }\r\n\r\n        if (!retorno) {\r\n            alert("A data informada \xe9 inv\xe1lida.");\r\n            document.getElementById(campo.id).value = ""\r\n            document.getElementById(campo.id).focus();\r\n        }\r\n    }\r\n    return retorno;\r\n}\r\n\r\nfunction validaDataProibeCampoVazio(campo, opcional) {\r\n    var retorno = true;\r\n    var valor = $(campo).val();\r\n\r\n    validaData(campo);\r\n\r\n    if (valor.length == 0 || valor.length != 10) {\r\n        document.getElementById(campo.id).value = "";\r\n        document.getElementById(campo.id).focus();\r\n        //document.getElementById(\'mensagemDataSpan\').style = "color: red;";\r\n        retorno = false;\r\n    }\r\n\r\n    return retorno;\r\n}\r\n\r\n\r\nfunction isDate(pDate) {\r\n    var currVal = pDate;\r\n    if (currVal == \'\')\r\n        return false;\r\n\r\n    //Declare Regex\r\n    var rxDatePattern = /^(\\d{1,2})(\\/|-)(\\d{1,2})(\\/|-)(\\d{4})$/;\r\n    var dtArray = currVal.match(rxDatePattern); // is format OK?\r\n\r\n    if (dtArray == null)\r\n        return false;\r\n\r\n    dtDay = dtArray[1];\r\n    dtMonth = dtArray[3];\r\n    dtYear = dtArray[5];\r\n\r\n    if (dtMonth < 1 || dtMonth > 12)\r\n        return false;\r\n    else if (dtDay < 1 || dtDay > 31)\r\n        return false;\r\n    else if ((dtMonth == 4 || dtMonth == 6 || dtMonth == 9 || dtMonth == 11) && dtDay == 31)\r\n        return false;\r\n    else if (dtMonth == 2) {\r\n        var isleap = (dtYear % 4 == 0 && (dtYear % 100 != 0 || dtYear % 400 == 0));\r\n        if (dtDay > 29 || (dtDay == 29 && !isleap))\r\n            return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nfunction validaEntidadeCalamidade(Entidade) {\r\n    msgErro = "";\r\n    if (Entidade == "" || Entidade == null) {\r\n        msgErro = "N\xe3o existem dados a serem consultados!";\r\n    }\r\n    return msgErro;\r\n}\r\n\r\nfunction validaDataInicialFinal(idDataInicial, idDataFinal, obrigatorio, validaPeriodo) {\r\n    //msgErro = "";\r\n    if ($("#" + idDataInicial).val() != "" ||\r\n        $("#" + idDataFinal).val() != "") {\r\n        if ($("#" + idDataInicial).val() == "") {\r\n            if (msgErro != "") { msgErro += "\\n\\n"; }\r\n            msgErro += "Favor informar a data inicial.";\r\n        }\r\n        else {\r\n            if ($("#" + idDataInicial).val().length != 10) {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro += "Favor informar uma data inicial v\xe1lida.";\r\n            }\r\n        }\r\n        if ($("#" + idDataFinal).val() == "") {\r\n            if (msgErro != "") { msgErro += "\\n\\n"; }\r\n            msgErro += "Favor informar a data final.";\r\n        }\r\n        else {\r\n            if ($("#" + idDataFinal).val().length != 10) {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro += "Favor informar uma data final v\xe1lida.";\r\n            }\r\n        }\r\n        if (msgErro == "") {\r\n            //new Date(year, month, day, hours, minutes, seconds, milliseconds)\r\n            //O m\xeas inicia em zero\r\n            var auxData = $("#" + idDataInicial).val().split(\'/\');\r\n            var dataInicial = new Date(auxData[2], auxData[1] - 1, auxData[0]);\r\n\r\n            //new Date(year, month, day, hours, minutes, seconds, milliseconds)\r\n            //O m\xeas inicia em zero\r\n            auxData = $("#" + idDataFinal).val().split(\'/\');\r\n            var dataFinal = new Date(auxData[2], auxData[1] - 1, auxData[0]);\r\n\r\n            if (dataFinal < dataInicial) {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro += "A Data Final n\xe3o pode ser menor que a Data Inicial.";\r\n            }\r\n            else {\r\n                if (dataInicial.getFullYear() < 1900) {\r\n                    if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                    msgErro = "Informe um per\xedodo v\xe1lido.";\r\n                }\r\n                else {\r\n                    if (typeof validaPeriodo == "undefined") {\r\n                        validaPeriodo = true;\r\n                    }\r\n                    if (validaPeriodo) {\r\n                        if (dataFinal.getFullYear() != dataInicial.getFullYear()) {\r\n                            if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                            msgErro += "Apenas s\xe3o permitidas consultas no mesmo exerc\xedcio.";\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        if (obrigatorio) {\r\n            if (msgErro != "") { msgErro += "\\n\\n"; }\r\n            msgErro += "Favor informar um per\xedodo.";\r\n        }\r\n\r\n    }\r\n\r\n    return msgErro;\r\n}\r\n\r\nfunction formataCPFCNPJ(campo) {\r\n    var valor = $(campo).val();\r\n    valor = valor.replace(/\\D/g, "") //Remove tudo o que n\xe3o \xe9 d\xedgito\r\n\r\n    if (valor.length > 11) {\r\n        //CNPJ\r\n        valor = valor.replace(/^(\\d{2})(\\d)/, "$1.$2") //Coloca ponto entre o segundo e o terceiro d\xedgitos\r\n        valor = valor.replace(/^(\\d{2})\\.(\\d{3})(\\d)/, "$1.$2.$3") //Coloca ponto entre o quinto e o sexto d\xedgitos\r\n        valor = valor.replace(/\\.(\\d{3})(\\d)/, ".$1/$2") //Coloca uma barra entre o oitavo e o nono d\xedgitos\r\n        valor = valor.replace(/(\\d{4})(\\d)/, "$1-$2") //Coloca um h\xedfen depois do bloco de quatro d\xedgitos\r\n    }\r\n    else {\r\n        //CPF\r\n        valor = valor.replace(/(\\d{3})(\\d)/, "$1.$2") //Coloca um ponto entre o terceiro e o quarto d\xedgitos\r\n        valor = valor.replace(/(\\d{3})(\\d)/, "$1.$2") //Coloca um ponto entre o terceiro e o quarto d\xedgitos\r\n        //de novo (para o segundo bloco de n\xfameros)\r\n        valor = valor.replace(/(\\d{3})(\\d{1,2})$/, "$1-$2") //Coloca um h\xedfen entre o terceiro e o quarto d\xedgitos\r\n    }\r\n    if (valor.length > 18) {\r\n        valor = valor.substring(0, 18);\r\n    }\r\n    $(campo).val(valor);\r\n}\r\n\r\nfunction validaCPF(cpf) {\r\n    var numeros, digitos, soma, i, resultado, digitos_iguais;\r\n    digitos_iguais = 1;\r\n    if (cpf.length < 11) {\r\n        return false;\r\n    }\r\n    for (i = 0; i < cpf.length - 1; i++) {\r\n        if (cpf.charAt(i) != cpf.charAt(i + 1)) {\r\n            digitos_iguais = 0;\r\n            break;\r\n        }\r\n    }\r\n    if (!digitos_iguais) {\r\n        numeros = cpf.substring(0, 9);\r\n        digitos = cpf.substring(9);\r\n        soma = 0;\r\n        for (i = 10; i > 1; i--) {\r\n            soma += numeros.charAt(10 - i) * i;\r\n        }\r\n        resultado = soma % 11 < 2 ? 0 : 11 - soma % 11;\r\n        if (resultado != digitos.charAt(0)) {\r\n            return false;\r\n        }\r\n        numeros = cpf.substring(0, 10);\r\n        soma = 0;\r\n        for (i = 11; i > 1; i--) {\r\n            soma += numeros.charAt(11 - i) * i;\r\n        }\r\n        resultado = soma % 11 < 2 ? 0 : 11 - soma % 11;\r\n        if (resultado != digitos.charAt(1)) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    else {\r\n        return false;\r\n    }\r\n}\r\n\r\nfunction ConsultaUf(prParam1) {\r\n    var params = "";\r\n\r\n    if ($("#" + prParam1).val() != "") {\r\n\r\n        // valida\xe7\xe3o campo #1\r\n        if ($("#" + prParam1) && $("#" + prParam1).val() != "") {\r\n            params += "&param1=" + $("#" + prParam1).val();\r\n        }\r\n        // chamada ajax\r\n        $.ajax({\r\n            type: "GET",\r\n            global: false,\r\n            url: "acao.asp",\r\n            data: "acao=RetornaUfPrefeitura" + replaceAll(params, "/", "|"),\r\n            dataType: "json",\r\n            async: false,\r\n            cache: false,\r\n            success: function (jdados) {\r\n                if (jdados) {\r\n                    if (jdados.Dados.length > 0) {\r\n                        for (x = 0; x < jdados.Dados.length; x++) {\r\n                            var dado = jdados.Dados[x];\r\n                            document.getElementById(\'trChamamentoCredenciamento\').style.visibility = "visible";\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            error: function (jerro) {\r\n                alert(jerro.responseText);\r\n                destino.css("background-color", "#ffffff");\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n\r\nfunction alteraTXTDiariasPassagens() {\r\n    var valor = $("#cmbDiariasPassagens").val();\r\n    if (valor == 0) {\r\n        $("#TBiframe").contents().find("p").text("");\r\n    };\r\n    if (valor == 1) {\r\n        $("#TBiframe").contents().find("p").text("As di\xe1rias s\xe3o despesas or\xe7ament\xe1rias com cobertura de alimenta\xe7\xe3o, pousada e locomo\xe7\xe3o urbana, do servidor p\xfablico estatut\xe1rio ou celetista que se desloca de sua sede em objeto de servi\xe7o, em car\xe1ter eventual ou transit\xf3rio, entendido como sede o Munic\xedpio onde a reparti\xe7\xe3o estiver instalada e onde o servidor tiver exerc\xedcio em car\xe1ter permanente.");\r\n    };\r\n    if (valor == 2) {\r\n        $("#TBiframe").contents().find("p").text("Nesta op\xe7\xe3o s\xe3o consideradas as despesas or\xe7ament\xe1rias, realizadas diretamente ou por meio de empresa contratada, com aquisi\xe7\xe3o de passagens (a\xe9reas, terrestres, fluviais ou mar\xedtimas), taxas de embarque, seguros, fretamento, ped\xe1gios, loca\xe7\xe3o ou uso de ve\xedculos para transporte de pessoas e suas respectivas bagagens, inclusive quando decorrentes de mudan\xe7as de domic\xedlio no interesse da administra\xe7\xe3o.");\r\n    };\r\n    if (valor == 3) {\r\n        $("#TBiframe").contents().find("p").text("O adiantamento caracteriza-se pela concess\xe3o de um valor (considerando os limites previstos em lei) ao agente p\xfablico, para realiza\xe7\xe3o de despesas de pronto pagamento, com a presta\xe7\xe3o de contas ocorrendo posteriormente.");\r\n    };\r\n    if (valor == 0 || valor == "") {\r\n        $("#TBiframe").contents().find("p").text("");\r\n    };\r\n}\r\n\r\nfunction alteraTXTTipoTransferencia() {\r\n    var valor = $("#cmbTipoTransferencia").val();\r\n    if (valor == 41) {\r\n        $("#TBiframe").contents().find("p").text("Contribui\xe7\xf5es: Despesas or\xe7ament\xe1rias \xe0s quais n\xe3o correspondam contrapresta\xe7\xe3o direta em bens e servi\xe7os e n\xe3o sejam reembols\xe1veis pelo recebedor, inclusive as destinadas a atender a despesas de manuten\xe7\xe3o de outras entidades de direito p\xfablico ou privado, observado o disposto na legisla\xe7\xe3o vigente.");\r\n    };\r\n    if (valor == 42) {\r\n        $("#TBiframe").contents().find("p").text("Aux\xedlios: Despesas or\xe7ament\xe1rias destinadas a atender a despesas de investimentos ou invers\xf5es financeiras de outras esferas de governo ou de entidades privadas sem fins lucrativos, observado, respectivamente, o disposto nos artigos 25 e 26 da Lei de Responsabilidade Fiscal.");\r\n    };\r\n    if (valor == 43) {\r\n        $("#TBiframe").contents().find("p").text("Subven\xe7\xf5es Sociais: Despesas or\xe7ament\xe1rias para cobertura de despesas de institui\xe7\xf5es privadas de car\xe1ter assistencial ou cultural, sem finalidade lucrativa, de acordo com os artigos. 16, par\xe1grafo \xfanico, e 17 da Lei n\xba 4.320/1964, observado o disposto no artigo 26 da Lei de Responsabilidade Fiscal.");\r\n    };\r\n    if (valor == 45) {\r\n        $("#TBiframe").contents().find("p").text("Subven\xe7\xf5es Econ\xf4micas: Despesas or\xe7ament\xe1rias com o pagamento de subven\xe7\xf5es econ\xf4micas, a qualquer t\xedtulo, autorizadas em leis espec\xedficas, tais como: ajuda financeira a entidades privadas com fins lucrativos; concess\xe3o de bonifica\xe7\xf5es a produtores, distribuidores e vendedores; cobertura, direta ou indireta, de parcela de encargos de empr\xe9stimos e financiamentos e dos custos de aquisi\xe7\xe3o, de produ\xe7\xe3o, de escoamento, de distribui\xe7\xe3o, de venda e de manuten\xe7\xe3o de bens, produtos e servi\xe7os em geral; e, ainda, outras opera\xe7\xf5es com caracter\xedsticas semelhantes.");\r\n    };\r\n    if (valor == 0 || valor == "") {\r\n        $("#TBiframe").contents().find("p").text("");\r\n    };\r\n}\r\n\r\nfunction alteraTXTOrigemRecurso() {\r\n    var valor = $("#cmbOrigemRecurso").val();\r\n    if (valor == 1) {\r\n        $("#TBiframe").contents().find("p").text("Recursos da Uni\xe3o: S\xe3o os valores repassados da esfera federal para a entidade.");\r\n    };\r\n    if (valor == 2) {\r\n        $("#TBiframe").contents().find("p").text("Recursos do Estado: S\xe3o os valores repassados da esfera estadual para a entidade.");\r\n    };\r\n    if (valor == 3) {\r\n        $("#TBiframe").contents().find("p").text("Outros: S\xe3o os valores repassados de outras esferas ou outras entidades.");\r\n    };\r\n    if (valor == 0 || valor == "") {\r\n        $("#TBiframe").contents().find("p").text("");\r\n    };\r\n}\r\n\r\nfunction textogp() {\r\n    var valor = $("#cmbVinculoGP").val();\r\n    if (valor == 0 || valor == "") {\r\n        $("#TBiframe").contents().find("p").text("Lista todos os Servidores em atividade.");\r\n    };\r\n    if (valor == 1) {\r\n        $("#TBiframe").contents().find("p").text("Servidor efetivo \xe9 aquele aprovado em concurso p\xfablico, mantendo rela\xe7\xe3o com a administra\xe7\xe3o por tempo indeterminado.");\r\n    };\r\n    if (valor == 2) {\r\n        $("#TBiframe").contents().find("p").text("Servidor comissionado \xe9 aquele nomeado para o exerc\xedcio de fun\xe7\xe3o de dire\xe7\xe3o, chefia e assessoramento, sem a necessidade de aprova\xe7\xe3o pr\xe9via em concurso p\xfablico.");\r\n    };\r\n    if (valor == 3) {\r\n        $("#TBiframe").contents().find("p").text("Servidor cedido/recebido \xe9 aquele requisitado para trabalhar em local diferente do seu \xf3rg\xe3o de origem.");\r\n    };\r\n    if (valor == 4) {\r\n        $("#TBiframe").contents().find("p").text("Servidor cedido \xe9 aquele requisitado para trabalhar em local diferente do seu \xf3rg\xe3o de origem.");\r\n    };\r\n    if (valor == 5) {\r\n        $("#TBiframe").contents().find("p").text("Servidor recebido \xe9 aquele requisitado para trabalhar em local diferente do seu \xf3rg\xe3o de origem.");\r\n    };\r\n    if (valor == 6) {\r\n        $("#TBiframe").contents().find("p").text("Estagi\xe1rio \xe9 o aluno matriculado e que esteja frequentando curso vinculado ao ensino em escola p\xfablica e/ou privado que desenvolve, no servi\xe7o p\xfablico, atividades relacionadas \xe0 sua \xe1rea de forma\xe7\xe3o profissional.");\r\n    };\r\n    if (valor == 7) {\r\n        $("#TBiframe").contents().find("p").text("Servidor tempor\xe1rio \xe9 aquele contratado por tempo determinado para atender \xe0 necessidade tempor\xe1ria de exepcional interesse p\xfablico.");\r\n    };\r\n    if (valor == 8) {\r\n        $("#TBiframe").contents().find("p").text("Agente pol\xedtico.");\r\n    };\r\n    if (valor == "") {\r\n        $("#TBiframe").contents().find("p").text("");\r\n    };\r\n}\r\n\r\nfunction MinMaxTeste(divID) {\r\n    $("#" + divID).find("tr").each(function (index) {\r\n        if (index > 0) {\r\n            var child = $(this);\r\n            if (child.css("display") == "none") {\r\n                child.show();\r\n            }\r\n            else {\r\n                child.hide();\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\nfunction retiraAcento(obj) {\r\n    com_acento = \'\xe1\xe0\xe3\xe2\xe4\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf3\xf2\xf5\xf4\xf6\xfa\xf9\xfb\xfc\xe7\xc1\xc0\xc3\xc2\xc4\xc9\xc8\xca\xcb\xcd\xcc\xce\xcf\xd3\xd2\xd5\xd6\xd4\xda\xd9\xdb\xdc\xc7\';\r\n    sem_acento = \'aaaaaeeeeiiiiooooouuuucAAAAAEEEEIIIIOOOOOUUUUC\';\r\n    nova = \'\';\r\n    for (i = 0; i < obj.length; i++) {\r\n        if (com_acento.search(obj.substr(i, 1)) >= 0) {\r\n            nova += sem_acento.substr(com_acento.search(obj.substr(i, 1)), 1);\r\n        }\r\n        else {\r\n            nova += obj.substr(i, 1);\r\n        }\r\n    }\r\n    return nova.toUpperCase();\r\n}\r\n\r\nfunction reestruturacaoIframe(reestruturacao, siafic) {\r\n    document.getElementById(\'linhaRodape\').style.visibility = "hidden";\r\n    document.getElementById(\'linhaTopo\').style.visibility = "hidden";\r\n    document.getElementById(\'menu\').style.visibility = "hidden";\r\n    document.getElementById(\'topo\').style.visibility = "hidden";\r\n    document.getElementById(\'pesquisaTopo\').style.visibility = "hidden";\r\n\r\n    $("#formulario").css("background", "white");\r\n    $("#menu").remove();\r\n    $("#topo").remove();\r\n    $(".rodapeLegado").css("color", "white");\r\n    $(".rodapeLegado a").css("color", "white");\r\n\r\n    if (reestruturacao) {\r\n        sessionStorage.setItem(\'CookiesReestruturacao\', \'reestruturacao\');\r\n        reestruturacao = true;\r\n    }\r\n    if (siafic) {\r\n        sessionStorage.setItem(\'CookiesSiafic\', \'siafic\');\r\n        siafic = true;\r\n    }\r\n}\r\n\r\nfunction verificaLocalStorage() {\r\n    reestruturacao = false;\r\n    siafic = false;\r\n}\r\n\r\nfunction readCookie(name) {\r\n    return window.localStorage.getItem(name);\r\n}\r\n\r\nfunction eraseCookie(name) {\r\n    var auxLocal = readCookie(name);\r\n    if (auxLocal !== null) {\r\n        window.storage.removeItem(name);\r\n    }\r\n}\r\n\r\nfunction limparCookies() {\r\n    localStorage.clear();\r\n}\r\n\r\n$(document).ready(function () {\r\n    // Nome dinamico da aplica\xe7\xe3o epla URL ===================================================================================\r\n\r\n    var url = window.location.href;\r\n\r\n    //Verifica se \xe9 para Gerar menu objJson\r\n\r\n    verificaChamadaGeraMenuJSON(url);\r\n    if (retornogeradorMenu === true) {\r\n        montaObjItensMenuPeloMapaSite();\r\n    }\r\n\r\n    // Fim \r\n\r\n    var urls = url.split("/");\r\n    var urlsReestruturacao = url.split("&");\r\n\r\n    for (var i = 0; i < urls.length; i++) {\r\n\r\n        if (i == 3) {\r\n            if (urls[i] === "index.asp") {\r\n                nomeAplicacaoDWS = "pronimtb";\r\n            } else {\r\n                nomeAplicacaoDWS = urls[i];\r\n                servidorUnico = true;\r\n            }\r\n\r\n        } else {\r\n            if (!servidorUnico) {\r\n                nomeAplicacaoDWS = "pronimtb";\r\n            }\r\n        }\r\n\r\n    }\r\n    for (var i = 0; i < urlsReestruturacao.length; i++) {\r\n        if (urlsReestruturacao[i] === "reestruturacao") {\r\n            reestruturacao = true;\r\n        }\r\n        if (urlsReestruturacao[i] === "siafic") {\r\n            siafic = true;\r\n        }\r\n    }\r\n\r\n    if (sessionStorage.getItem("CookiesReestruturacao") === "reestruturacao") {\r\n        reestruturacao = true;\r\n    }\r\n\r\n    if (sessionStorage.getItem("CookiesSiafic") === "siafic") {\r\n        reestruturacaoIframe(false, true);\r\n        siafic = false;\r\n    }   \r\n\r\n    if (reestruturacao) {\r\n        reestruturacaoIframe(true, false);\r\n    }\r\n    else if (siafic) {        \r\n        reestruturacaoIframe(false, true);\r\n        jAlert(\'Voc\xea foi redirecionado para essa p\xe1gina, onde ser\xe1 poss\xedvel filtrar as informa\xe7\xf5es de uma ou mais entidades. Devido ao SIAFIC(Sistema \xdanico e Integrado de Execu\xe7\xe3o Or\xe7ament\xe1ria, Administra\xe7\xe3o Financeira e Controle), os dados da entidade ficam disponibilizados juntamente ao portal de transpar\xeancia da prefeitura.\', \'Aten\xe7\xe3o\');\r\n    } else {\r\n        verificaLocalStorage();\r\n    }\r\n\r\n    // Fim do nome dinamico da aplica\xe7\xe3o epla URL =============================================================================\r\n\r\n\r\n    menuFavoritos()\r\n\r\n    if (($("#hndAcao").val() == null)) {\r\n    }\r\n    else {\r\n\r\n        //document.getElementById("btExportarPDF").onclick = function (e) {\r\n        //    exportarPDF();\r\n        //    e.preventDefault();\r\n        //}\r\n\r\n        validaProdutosInstalados();\r\n\r\n        var exportXML = $(\'#hndItemExporta\').val();\r\n\r\n        document.getElementById(\'imprimirPDF\').style.visibility = "hidden";\r\n        document.getElementById(\'exportarXML\').style.visibility = "hidden";\r\n        document.getElementById(\'exportarCSV\').style.visibility = "hidden";\r\n    }\r\n\r\n    if (($("#hndAcao").val() == 1) && ($("#hndItem").val() == 5)) {\r\n        $("#cmbEstoqueUnidadeCM option:first").attr(\'selected\', \'selected\');\r\n        $("#cmbEstoqueDataVigenciaLC option:first").attr(\'selected\', \'selected\');\r\n        $("#cmbEstoqueAlmoxarifado option:first").attr(\'selected\', \'selected\');\r\n        $("#cmbEstoqueUnidadeGestoraLC option:first").attr(\'selected\', \'selected\');\r\n        $("#cmbEstoqueMesInicial option:first").attr(\'selected\', \'selected\');\r\n        $("#cmbEstoqueMesFinal option:first").attr(\'selected\', \'selected\');\r\n        $("#cmbEstoqueTipoMovimento option:first").attr(\'selected\', \'selected\');\r\n    }\r\n\r\n    if (($("#hndAcao").val() == 1) && ($("#hndItem").val() == 6)) {\r\n        $("#cmbPatrimonioUnidadePP option:first").attr(\'selected\', \'selected\');\r\n        $("#cmbPatrimonioUnidadeGestoraLC option:first").attr(\'selected\', \'selected\');\r\n    }\r\n    //Frotas\r\n    if (($("#hndAcao").val() == 1) && ($("#hndItem").val() == 7)) {\r\n        $("#cmbFrotasUnidadeAF option:first").attr(\'selected\', \'selected\');\r\n        $("#cmbFrotasUnidadeGestora option:first").attr(\'selected\', \'selected\');\r\n    }\r\n    if (($("#hndAcao").val() == 3) && ($("#hndItem").val() == 13)) {\r\n        $(\'#cmbUnidadeCP\').change(function () {\r\n            consultarDadosCP(\'UnidadeGestoraCP\', \'cmbUnidadeGestora\', \'cmbUnidadeCP\', this.id, \'CP_Fato_EmpenhoDespesa\', \'CP_Fato_saldodespesa\', \'cmbUnidadeCP\');\r\n        })\r\n    }\r\n\r\n    if (($("#hndAcao").val() == 3) && ($("#hndItem").val() == 19)) {\r\n        $(\'#cmbUnidadeCP\').change(function () {\r\n            consultarDadosCP(\'UnidadeGestoraCP\', \'cmbUnidadeGestora\', \'cmbUnidadeCP\', this.id, \'CP_Fato_EmpenhoDespesa\', \'CP_Fato_saldodespesa\', \'cmbUnidadeCP\');\r\n        })\r\n    }\r\n\r\n    // Valida se foi acionado o bot\xe3o de exporta\xe7\xe3o da estrutura organizacional, e exporta\r\n    if (($("#hndAcao").val() == 20) && ($("#hndItem").val() == 2)) {\r\n\r\n        function mostrarValorEstrutura() {\r\n            downloadXMLNovo(13);\r\n        }\r\n\r\n        document.getElementById("exportarXML").onclick = function (e) {\r\n            mostrarValorEstrutura();\r\n            e.preventDefault();\r\n        }\r\n\r\n        document.getElementById("exportarCSV").onclick = function (e) {\r\n            exportacaoCSV(1, 0);\r\n            e.preventDefault();\r\n        }\r\n\r\n    }\r\n\r\n    // Valida se foi acionado o bot\xe3o de exporta\xe7\xe3o da estrutura organizacional, e exporta\r\n    if (($("#hndAcao").val() == 20) && ($("#hndItem").val() == 6)) {\r\n\r\n        function mostrarValorEstrutura() {\r\n            downloadXMLNovo(15);\r\n        }\r\n\r\n        document.getElementById("exportarXML").onclick = function (e) {\r\n            mostrarValorEstrutura();\r\n            e.preventDefault();\r\n        }\r\n\r\n        document.getElementById("exportarCSV").onclick = function (e) {\r\n            exportacaoCSV(1, 1);\r\n            e.preventDefault();\r\n        }\r\n\r\n    }\r\n\r\n    //LC -Contratos\r\n    if (($("#hndAcao").val() == 1) && ($("#hndItem").val() == 1)) {\r\n        //grid contratos com.\r\n        if ($("#ckContrato").attr("checked")) {\r\n            $(\'.contratos\').css(\'display\', "");\r\n        }\r\n        $("#ckContrato").click(function () {\r\n            if ($("#ckContrato").attr("checked")) {\r\n                $(\'.contratos\').css(\'display\', "");\r\n            } else {\r\n                $(\'.contratos\').css(\'display\', \'none\');\r\n                $(\'.contratosCom input\').attr("checked", false);\r\n            }\r\n        });\r\n\r\n\r\n        //setar todos os tipos contratos\r\n        $(\'.TipoContratoTodos\').click(function () {\r\n            if ($(\'.TipoContratoTodos  input\').attr("checked")) {\r\n                $(\'.TipoContrato input\').attr("checked", true);\r\n            } else {\r\n                $(\'.TipoContrato  input\').attr("checked", false);\r\n            }\r\n        });\r\n        $(\'.TipoContrato\').click(function () {\r\n            VerificaInputChecked(\'TipoContrato\', \'TipoContratoTodos\');\r\n        });\r\n\r\n        //setar todos instrumentos contratual\r\n        $(\'.instrumentoContratualTodos\').click(function () {\r\n            //alert(\'teste\');\r\n            if ($(\'.instrumentoContratualTodos input\').attr("checked")) {\r\n                $(\'.instrumentoContratual  input\').attr("checked", true);\r\n                $(\'.contratos\').css(\'display\', "");\r\n            } else {\r\n                $(\'.instrumentoContratual  input\').attr("checked", false);\r\n                $(\'.contratosComTodos  input\').attr("checked", false);\r\n                $(\'.contratosCom input\').attr("checked", false);\r\n                $(\'.contratos\').css(\'display\', \'none\');\r\n            }\r\n        });\r\n        $(\'.instrumentoContratual\').click(function () {\r\n            VerificaInputChecked(\'instrumentoContratual\', \'instrumentoContratualTodos\');\r\n        });\r\n\r\n        //setar todos os tipos Aditivos\r\n        $(\'.contratosComTodos\').click(function () {\r\n            if ($(\'.contratosComTodos input\').attr("checked")) {\r\n                $(\'.contratosCom input\').attr("checked", true);\r\n            } else {\r\n                $(\'.contratosCom input\').attr("checked", false);\r\n            }\r\n        });\r\n        $(\'.contratosCom\').click(function () {\r\n            VerificaInputChecked(\'contratosCom\', \'contratosComTodos\');\r\n        });\r\n\r\n    };\r\n\r\n    function VerificaInputChecked(checked, notChecked) {\r\n        var estado = true;\r\n        var totalNaoChecadas = 0;\r\n        var totalChecadas = 0;\r\n        $.each($("." + checked + " input"), function () {\r\n            if (!$(this).attr(\'checked\')) {\r\n                totalNaoChecadas++;\r\n                estado = false\r\n            } else {\r\n                totalChecadas++;\r\n            }\r\n        });\r\n        console.log(\'N\xe3o Checadas:\' + totalNaoChecadas + " Checadas:" + totalChecadas + " Estado:" + estado);\r\n        if (totalNaoChecadas != 0) {\r\n            $("." + notChecked + " input").attr(\'checked\', estado ? "checked" : "");\r\n        } else {\r\n            $("." + notChecked + " input").attr(\'checked\', estado ? "checked" : "");\r\n        }\r\n    }\r\n\r\n    // Valida se foi acionado o bot\xe3o de exporta\xe7\xe3o da estrutura organizacional, e exporta\r\n    if (($("#hndAcao").val() == 20) && ($("#hndItem").val() == 1)) {\r\n\r\n        function mostrarValorPerguntas() {\r\n            downloadXMLNovo(14);\r\n        }\r\n\r\n        document.getElementById("exportarXML").onclick = function (e) {\r\n            mostrarValorPerguntas();\r\n            e.preventDefault();\r\n        }\r\n\r\n        document.getElementById("exportarCSV").onclick = function (e) {\r\n            exportacaoCSV(2, 0);\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    // Controle de sele\xe7\xe3o de todos (Selecionar Tudo)\r\n    $(".todos").click(function () {\r\n\r\n        var estado = $(this).find(\'input\').attr(\'checked\');\r\n        // Selecionar todos as modalidades\r\n        $.each($(".modalidade input"), function () {\r\n            $(this).attr(\'checked\', estado ? "checked" : "");\r\n            console.log(estado);\r\n        });\r\n\r\n        // Selecionar todos as modalidades\r\n        //$.each($(".finalidade input"), function () {\r\n        //$(this).attr(\'checked\', estado ? "checked" : "");\r\n\r\n        //$(this).attr("disabled", estado ? "" : "disabled");\r\n        //});\r\n    });\r\n\r\n    $(".todosFinalidade").click(function () {\r\n\r\n        var estado = $(this).find(\'input\').attr(\'checked\');\r\n        // Selecionar todos as modalidades\r\n        //$.each($(".modalidade input"), function () {\r\n        //$(this).attr(\'checked\', estado ? "checked" : "");\r\n        //});\r\n\r\n        // Selecionar todos as modalidades\r\n        $.each($(".finalidade input"), function () {\r\n            $(this).attr(\'checked\', estado ? "checked" : "");\r\n\r\n            //$(this).attr("disabled", estado ? "" : "disabled");\r\n        });\r\n    });\r\n\r\n    $(".modalidade").click(function () {\r\n        var estado = true;\r\n        var totalModalidadesNaoChecadas = 0;\r\n        var totalModalidadesChecadas = 0;\r\n        $.each($(".modalidade input"), function () {\r\n            if (!$(this).attr(\'checked\')) {\r\n                totalModalidadesNaoChecadas++;\r\n                estado = false\r\n            } else {\r\n                totalModalidadesChecadas++;\r\n            }\r\n        });\r\n        console.log(\'N\xe3o Checadas:\' + totalModalidadesNaoChecadas + " Checadas:" + totalModalidadesChecadas + " Estado:" + estado);\r\n        if (totalModalidadesChecadas != 0) {\r\n            $(".finalidade input").attr("disabled", "");\r\n        } else {\r\n            $(".finalidade input").attr("disabled", true);\r\n            $(".finalidade input").attr("checked", "");\r\n        }\r\n        if (totalModalidadesNaoChecadas != 0)\r\n            $(\'#ckTipoModalidadeTodos\').attr(\'checked\', estado ? "checked" : "");\r\n    });\r\n\r\n    $(".finalidade").click(function () {\r\n        var estado = true;\r\n        var totalFinalidadesNaoChecadas = 0;\r\n        var totalModalidadesNaoChecadas = 0;\r\n        $.each($(".modalidade input"), function () {\r\n            if (!$(this).attr(\'checked\')) {\r\n                totalModalidadesNaoChecadas++;\r\n                estado = false\r\n            }\r\n        });\r\n        $.each($(".finalidade input"), function () {\r\n            if (!$(this).attr(\'checked\')) {\r\n                totalFinalidadesNaoChecadas++;\r\n                estado = false\r\n            }\r\n        });\r\n        if (totalModalidadesNaoChecadas != 0 || totalFinalidadesNaoChecadas != 0)\r\n            $(\'#ckTipoModalidadeTodos\').attr(\'checked\', estado ? "checked" : "");\r\n    });\r\n\r\n\r\n    $("h4").live("click", function () {\r\n        var meuHost = window.location.host;\r\n        var mudaImagem = $(this).parent().find("h4").find("img");\r\n        $(this).parent().find("p").toggle();\r\n        if (mudaImagem.attr(\'src\') == "/" + nomeAplicacaoDWS + "/imagens/setaParaBaixo_nova.png") {\r\n            mudaImagem.attr(\'src\', "/" + nomeAplicacaoDWS + "/imagens/setaDireita.png");\r\n        }\r\n        else {\r\n            mudaImagem.attr(\'src\', "/" + nomeAplicacaoDWS + "/imagens/setaDireita.png");\r\n        }\r\n    });\r\n\r\n    // Busca publica\xe7\xf5es Presta\xe7\xe3o de contas\r\n    if ((($("#hndAcao").val() == 21) && ($("#hndItem").val() == 2)) || (($("#hndAcao").val() == 21) && ($("#hndItem").val() == 3) || (($("#hndAcao").val() == 21) && ($("#hndItem").val() == 4)) || (($("#hndAcao").val() == 21) && ($("#hndItem").val() == 5) && ($("#hndItem").val() == 6)))) {\r\n        exibirAguarde();\r\n        var valParametro = "";\r\n\r\n        switch ($("#hndItem").val()) {\r\n            case "2": {\r\n                valParametro = 1;//13; // Presta\xe7\xe3o de Contas\r\n            } break;\r\n            case "3": {\r\n                valParametro = 2;//5; // Execu\xe7\xe3o Or\xe7ament\xe1ria\r\n            } break;\r\n            case "4": {\r\n                valParametro = 3;//4; // Gest\xe3o Fiscal\r\n            } break;\r\n            case "5": {\r\n                valParametro = 4;//12; // Lei de acesso a informa\xe7\xe3o\r\n            } break;\r\n            case "6": {\r\n                valParametro = 5;//12; // Lei de acesso a informa\xe7\xe3o\r\n            } break;\r\n        }\r\n\r\n        $.ajax({\r\n            type: "GET",\r\n            url: "acao.asp?acao=RetornaPublicacoesMenu&param1=" + valParametro,\r\n            dataType: "json",\r\n            //crossDomain: false,\r\n            success: function (jdados) {\r\n                var htm = "";\r\n\r\n                htm += "<div id=\'geraPublicacoes\' style=\'width: 100%; font-size: 14px; color:black !important;\'>";\r\n                htm += "<div style=\'width: 100%; font-size: 8px;\'></div>";\r\n                htm += "<div style=\'width: 100%; text-align: center;\'></div>";\r\n                htm += "<p2>";\r\n\r\n                if (jdados.Dados.length > 0) {\r\n                    htm += "<h1 style=\'display:block; font-size: 11px; padding-left: 20px;\'> Total de Publica\xe7\xf5es: " + jdados.Dados.length + "</h1>";\r\n                }\r\n\r\n                var iTitulo = 0;\r\n                var strNomeTema = "";\r\n\r\n                for (var i = 0; i < jdados.Dados.length; i++) {\r\n                    var objResult = jdados.Dados[i];\r\n\r\n\r\n                    if (iTitulo == 0) {\r\n                        strNomeTema = objResult.Nome_tema;\r\n\r\n                        htm += "<div id=\'linhaPerguntas\' style=\'width: 100%; text-align: center; bottom: 0px; left: 0px; border: 1px ridge\'></div>";\r\n                        htm += "<table id=\'publicacoesArquivos\'>";\r\n                        htm += "<div style=\'width:100%\'>";\r\n\r\n                        htm += "<h4 style=\'height:3px; padding-left: 20px;\'><img id=\'image\' src=\'/" + nomeAplicacaoDWS + "/imagens/setaParaBaixo_nova.png\' width=\'20\' height=\'20\'><b> Tema: " + objResult.Nome_tema + "</b></h4>";\r\n\r\n\r\n                        // htm += "<div style=\'font-size: 8px; width:100%; height:100%; hspace:10px;\'>";\r\n                        if (objResult.Descricao_tema != "") {\r\n                            htm += "<p2 style=\'display:block; font-size: 11px; padding-left: 50px; padding-top: 10px;\'> " + objResult.Descricao_tema + "</p2>";\r\n                            htm += "</br>";\r\n                        }\r\n                        // htm += "</div>";\r\n\r\n                        //htm += "<div style=\'width: 100%; font-size: 8px;\'>&nbsp;&nbsp;&nbsp;</div>";\r\n                        iTitulo += 1;\r\n                    }\r\n\r\n                    if (strNomeTema != objResult.Nome_tema) {\r\n\r\n                        htm += "</div>";\r\n                        htm += " </table>";\r\n\r\n                        htm += "<div id=\'linhaPerguntas\' style=\'width: 100%; text-align: center; bottom: 0px; left: 0px; border: 1px ridge\'></div>";\r\n                        htm += "<table id=\'publicacoesArquivos\'>";\r\n                        htm += "<div style=\'width:100%;\'>";\r\n\r\n                        htm += "<h4 style=\'height:3px; padding-left: 20px;\'><img id=\'image\' src=\'/" + nomeAplicacaoDWS + "/imagens/setaParaBaixo_nova.png\' width=\'20\' height=\'20\'><b> Tema: " + objResult.Nome_tema + "</b></h4>";\r\n\r\n                        // htm += "<div style=\'font-size: 8px; width:100%; height:100%; hspace:10px;\'>";\r\n                        if (objResult.Descricao_tema != null) {\r\n                            htm += "<p2 style=\'display:block; font-size: 11px; padding-left: 50px; padding-top: 10px;\'> " + objResult.Descricao_tema + "</p2>";\r\n                            htm += "</br>";\r\n                        }\r\n                        //htm += "</div>";\r\n\r\n                        // htm += "<div style=\'width: 100%; font-size: 8px;\'>&nbsp;&nbsp;&nbsp;</div>";\r\n                        strNomeTema = objResult.Nome_tema;\r\n\r\n                    }\r\n\r\n                    if (objResult.Nome_arquivo != null && objResult.Nome_arquivo != "") {\r\n                        htm += "<p2 style=\'display:block; font-size: 11px; padding-left: 50px;\'><b>Nome:</b>  " + objResult.Nome_arquivo + "</p2>";\r\n                    } else {\r\n                        htm += "<p2 style=\'display:block; font-size: 11px; padding-left: 50px;\'><b>Nome:</b>  " + objResult.Nome_tema + " - " + objResult.NOME_RELATORIO + "</p2>";\r\n                    }\r\n\r\n                    if (objResult.IMG_ARQUIVO != null) {\r\n                        htm += "<p2 style=\'display:block; font-size: 11px; padding-left: 50px;\'>";\r\n\r\n                        switch (objResult.ID_AREA) {\r\n                            // DRO 353214 - 07/11/2018 - Inicio\r\n                            case "0": {\r\n                                htm += " Arquivo: <a style=\'font-size: 12px;!important; text-decoration: underline; padding-left: 0px; backgound: none;\' class=\'but\' href=\'/" + nomeAplicacaoDWS + "/upload/Outros/" + objResult.IMG_ARQUIVO + "\'> " + objResult.IMG_ARQUIVO + "</a>";\r\n\r\n                            } break;\r\n                            // DRO 353214 - 07/11/2018 - Fim\r\n                            case "1": {\r\n                                htm += " Arquivo: <a style=\'font-size: 12px;!important; text-decoration: underline; padding-left: 0px; backgound: none;\' class=\'but\' href=\'/" + nomeAplicacaoDWS + "/upload/Gestao_de_Pessoal/" + objResult.IMG_ARQUIVO + "\'> " + objResult.IMG_ARQUIVO + "</a>";\r\n                            } break;\r\n                            case "2": {\r\n                                htm += " Arquivo: <a style=\'font-size: 12px;!important; text-decoration: underline; padding-left: 0px; backgound: none;\' class=\'but\' href=\'/" + nomeAplicacaoDWS + "/upload/Administracao_Geral/" + objResult.IMG_ARQUIVO + "\'> " + objResult.IMG_ARQUIVO + "</a>";\r\n\r\n                            } break;\r\n                            case "3": {\r\n                                htm += " Arquivo: <a style=\'font-size: 12px;!important; text-decoration: underline; padding-left: 0px; backgound: none;\' class=\'but\' href=\'/" + nomeAplicacaoDWS + "/upload/Arrecadacao/" + objResult.IMG_ARQUIVO + "\'> " + objResult.IMG_ARQUIVO + "</a>";\r\n\r\n                            } break;\r\n                            case "4": {\r\n                                htm += " Arquivo: <a style=\'font-size: 12px;!important; text-decoration: underline; padding-left: 0px; backgound: none;\' class=\'but\' href=\'/" + nomeAplicacaoDWS + "/upload/Financeira/" + objResult.IMG_ARQUIVO + "\'> " + objResult.IMG_ARQUIVO + "</a>";\r\n\r\n                            } break;\r\n                            case "5": {\r\n                                htm += " Arquivo: <a style=\'font-size: 12px;!important; text-decoration: underline; padding-left: 0px; backgound: none;\' class=\'but\' href=\'/" + nomeAplicacaoDWS + "/upload/Outros/" + objResult.IMG_ARQUIVO + "\'> " + objResult.IMG_ARQUIVO + "</a>";\r\n\r\n                            } break;\r\n                        };\r\n\r\n\r\n                        htm += "</p2>";\r\n\r\n                        if (objResult.DT_VIGENCIA_INICIO != null && objResult.DT_VIGENCIA_INICIO != "") {\r\n\r\n                            if (objResult.DT_VIGENCIA_FIM != null && objResult.DT_VIGENCIA_FIM != "") {\r\n                                htm += "<p2 style=\'display:block; font-size: 11px; padding-left: 50px;\'> Refer\xeancia:  " + objResult.DT_VIGENCIA_INICIO + " a " + objResult.DT_VIGENCIA_FIM + "</p2>";\r\n                            } else {\r\n                                htm += "<p2 style=\'display:block; font-size: 11px; padding-left: 50px;\'> Refer\xeancia:  " + objResult.DT_VIGENCIA_INICIO + " a Vigente </p2>";\r\n                            }\r\n                        }\r\n\r\n                        if (objResult.DS_DESCRICAO != null) {\r\n                            htm += "<p2 style=\'display:block; font-size: 11px; padding-left: 50px;\'> Descri\xe7\xe3o:  " + objResult.DS_DESCRICAO + "</p2>";\r\n                        }\r\n\r\n                        if (objResult.DT_INCLUSAOARQUIVO != null) {\r\n                            htm += "<p2 style=\'display:block; font-size: 11px; padding-left: 50px;\'> Data inclus\xe3o no Portal:  " + objResult.DT_INCLUSAOARQUIVO + "</p2>";\r\n                        }\r\n\r\n\r\n                        htm += "<p2 style=\'display:none; width: 50%; text-align: center; bottom: 0px; left: 0px; border: 1px ridge\'>";\r\n                        htm += "</p2>";\r\n                        htm += "</br>";\r\n                        htm += "</br>";\r\n                    };\r\n                }\r\n\r\n                if (jdados.Dados.length == 0) {\r\n                    htm += "<p2 style=\'font-size: 16px; padding-left: 20px;\'><b> N\xe3o foi encontrada nenhuma publica\xe7\xe3o para a consulta selecionada! </b></p2>";\r\n                }\r\n\r\n                htm += " </div>";\r\n                htm += " </table>";\r\n                htm += " </div>";\r\n\r\n                document.getElementById(\'confirma\').style.display = \'none\';\r\n                document.getElementById(\'tamanhoTabela\').style.width = \'2000px !important\';\r\n                document.getElementById(\'linhaPublicacoesAcessoRapido\').innerHTML = htm;\r\n                exibirAguarde(false);\r\n            },\r\n\r\n            error: function (jerro) {\r\n                console.log("Erro ao retornar os arquivos!");\r\n                exibirAguarde(false);\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n    // Busca Ano Cargas - Publica\xe7\xe3o\r\n    if (($("#hndAcao").val() == 21) && ($("#hndItem").val() == 1) || ($("#hndAcao").val() == 21) && ($("#hndItem").val() == 6)) {\r\n\r\n        $("#cmbOrdenacao").change(function () {\r\n            if ($("#cmbOrdenacao").find(\'option:selected\').val() == 0) {\r\n                $(\'#cmbCriterioOrdenacao\').attr(\'disabled\', \'disabled\');\r\n                document.getElementById("cmbCriterioOrdenacao").value = 0;\r\n            } else {\r\n                $(\'#cmbCriterioOrdenacao\').removeAttr(\'disabled\')\r\n            }\r\n        });\r\n        $("#cmbOrdenacao option:first").attr(\'selected\', \'selected\');\r\n        $("#cmbCriterioOrdenacao option:first").attr(\'selected\', \'selected\');\r\n        var destino = $("#cmbAnoCargasPublicacoes");\r\n        if ((destino) && (destino.is(":visible"))) {\r\n            limparDados("cmbAnoCargasPublicacoes");\r\n            destino.css("background-color", "#cecece");\r\n\r\n            destino.attr("disabled", true);\r\n            $.ajax({\r\n                type: "GET",\r\n                global: false,\r\n                url: "acao.asp",\r\n                data: "acao=BuscaAnoCargas",\r\n                dataType: "json",\r\n                async: false,\r\n                cache: false,\r\n                success: function (jdados) {\r\n                    limparDados("cmbAnoCargasPublicacoes");\r\n                    if (jdados) {\r\n                        if (jdados.Dados.length > 0) {\r\n                            destino.removeAttr("disabled");\r\n                            for (x = 0; x < jdados.Dados.length; x++) {\r\n                                var dado = jdados.Dados[x];\r\n                                var optn = document.createElement("OPTION");\r\n                                optn.text = dado.EXERCICO_ANO;\r\n                                optn.value = dado.EXERCICO_ANO;\r\n                                destino.find("option").end().append("<option value=\'" + dado.text + "\'>" + dado.text + "</option>").val("\'" + dado.EXERCICO_ANO + "\'");\r\n                            };\r\n                        }\r\n                    }\r\n                    destino.css("background-color", "#ffffff");\r\n                    destino.attr("disabled", false);\r\n                },\r\n                error: function (jerro) {\r\n                    alert(jerro.responseText);\r\n                    destino.css("background-color", "#ffffff");\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n\r\n\r\n\r\n    if (($("#hndAcao").val() == 21) && ($("#hndItem").val() == 1) || ($("#hndAcao").val() == 21) && ($("#hndItem").val() == 6)) {\r\n        $("#txtReferenciaDePublicacoes").blur(function () {\r\n            //alert($(\'#cmbAnoCargasPublicacoes\').val())\r\n\r\n            //DRO - 361507 - 26/02/2019 - Inicio\r\n            //if ($("#txtReferenciaDePublicacoes").val() != "") {\r\n            //    if ($(\'#cmbAnoCargasPublicacoes\').val() != $("#txtReferenciaDePublicacoes").val().substr(6, 10)) {\r\n            //        alert("Ano de Refer\xeancia maior que ano de Exerc\xedcio.")\r\n            //        $("#txtReferenciaDePublicacoes").focus();\r\n            //    }\r\n            //}\r\n\r\n            if (!$("#cmbAnoCargasPublicacoes").is(\':disabled\')) {\r\n                if ($("#txtReferenciaDePublicacoes").val() != "") {\r\n                    if ($(\'#cmbAnoCargasPublicacoes\').val() != $("#txtReferenciaDePublicacoes").val().substr(6, 10)) {\r\n\r\n                        if (($("#hndAcao").val() == 21) && ($("#hndItem").val() == 6)) {\r\n                            alert("Ano de Refer\xeancia maior que ano de Exerc\xedcio.")\r\n                            $("#txtReferenciaDePublicacoes").focus();\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n\r\n            //DRO - 361507 - 26/02/2019 - Fim\r\n        });\r\n\r\n        //DRO - 361507 - 26/02/2019 - Inicio\r\n        //if ($("#txtReferenciaAtePublicacoes").val() < $("#txtReferenciaDePublicacoes").val()) {\r\n        //    alert("Refer\xeancia final menor que refer\xeancia inicial!")\r\n        //    $("#txtReferenciaAtePublicacoes").focus();\r\n        //}\r\n        if ($("#txtReferenciaAtePublicacoes").val() !== "" && $("#txtReferenciaDePublicacoes").val() !== "") {\r\n            if ($("#txtReferenciaAtePublicacoes").val() < $("#txtReferenciaDePublicacoes").val()) {\r\n                alert("Refer\xeancia final menor que refer\xeancia inicial!")\r\n                $("#txtReferenciaAtePublicacoes").focus();\r\n            }\r\n        }\r\n        //DRO - 361507 - 26/02/2019 - Fim\r\n\r\n        $("#txtReferenciaAtePublicacoes").blur(function () {\r\n            if ($("#txtReferenciaAtePublicacoes").val() != "" && $("#txtReferenciaDePublicacoes").val() == "") {\r\n                alert("Favor preencher a data in\xedcial!")\r\n                $("#txtReferenciaDePublicacoes").focus();\r\n            }\r\n        });\r\n        preencheComboTema();\r\n    }\r\n\r\n\r\n    // Busca perguntas Frequentes\r\n    if (($("#hndAcao").val() == 20) && ($("#hndItem").val() == 1)) {\r\n\r\n        // Alterar a URL para usar esta abaixo - N\xc3O ESQUECER\r\n        // meuHost\r\n        // url: "http://" + meuHost + ":90/api/perguntasfrequentes",\r\n        //url: "http://ws713:90/api/perguntasfrequentes",\r\n\r\n        $.ajax({\r\n            type: "GET",\r\n            url: "acao.asp?acao=RetornaPerguntasFrequentes",\r\n            dataType: "json",\r\n            //crossDomain: false,\r\n            success: function (jdados) {\r\n                var htm = "";\r\n                htm += "<div style=\'width: 100%; text-align: center; \'>Abaixo est\xe3o relacionadas perguntas e respostas para ajudar o usu\xe1rio do Portal da Transpar\xeancia a tirar suas d\xfavidas mais frequentes.</div>";\r\n                htm += "<p>";\r\n                for (var i = 0; i < jdados.length; i++) {\r\n\r\n                    var objResult = jdados[i];\r\n                    //htm += "<div id=\'linhaPerguntas\' style=\'width: 100%; text-align: center; bottom: 0px; left: 0px; border: 1px ridge\'></div>";\r\n                    htm += "<table>";\r\n                    htm += "<div style=\'width:100%\'>";\r\n                    htm += "<h4 style=\'height:4px; padding-left: 20px; \'><img id=\'image\' src=\'/" + nomeAplicacaoDWS + "/imagens/setaParaBaixo_nova.png\' width=\'20\' height=\'20\'> &nbsp;&nbsp; " + objResult.Pergunta + "</h4>";\r\n                    htm += " <b><p style=\'display:block; width:100%; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; padding-top: 10px;\'></b> " + objResult.Resposta + "</p>";\r\n                    htm += " </div>";\r\n                    htm += " </table>";\r\n\r\n                }\r\n\r\n                //htm += "<div id=\'linhaPerguntas\' style=\'width: 100%; text-align: center; bottom: 0px; left: 0px; border: 1px ridge\'></div>"\r\n\r\n                document.getElementById(\'confirma\').style.display = \'none\';\r\n                document.getElementById(\'imprimirPDF\').style.visibility = "visible";\r\n                document.getElementById(\'exportarXML\').style.visibility = "visible";\r\n                document.getElementById(\'exportarCSV\').style.visibility = "visible";\r\n                document.getElementById(\'linhaPerguntasFrequentes\').innerHTML = htm;\r\n\r\n            },\r\n\r\n            error: function (jerro) {\r\n                alert(jerro.responseText + "Erro ao receber o arquivo!");\r\n            }\r\n        });\r\n    };\r\n\r\n    // Busca Pedidos Informa\xe7\xe3o\r\n    if (($("#hndAcao").val() == 20) && ($("#hndItem").val() == 5)) {\r\n\r\n        $.ajax({\r\n            type: "GET",\r\n            url: "acao.asp?acao=RetornaPedidosInformacao",\r\n            dataType: "json",\r\n            //crossDomain: false,\r\n            success: function (jdados) {\r\n                var htm = "";\r\n                htm += "<div style=\'width: 100%; text-align: center; \'></div>";\r\n                htm += "<p>";\r\n                for (var i = 0; i < jdados.length; i++) {\r\n\r\n                    var objResult = jdados[i];\r\n                    //htm += "<div id=\'linhaPerguntas\' style=\'width: 100%; text-align: center; bottom: 0px; left: 0px; border: 1px ridge\'></div>";\r\n                    htm += "<table>";\r\n                    htm += "<div style=\'width:100%\'>";\r\n                    htm += "<div id=\'coluna_esquerda\'>&nbsp;</div>"\r\n\r\n                    htm += " <div style=\'text-align:justify; font-style: italic; font-family: initial; font-size: 17px; colspan= 20; height:100%; padding-left: 90px; padding-top: 10px;\'>" + objResult.texto + "</div>";\r\n                    htm += "</br>";\r\n\r\n                    htm += " <div style=\'text-align:left; \'>O acesso encontra-se dispon\xedvel no endere\xe7o: <a href=" + objResult.linkPedidos + ">" + objResult.linkPedidos + "</a></div>";\r\n                    htm += " </div>";\r\n                    htm += " </table>";\r\n\r\n                }\r\n\r\n                //htm += "<div id=\'linhaPerguntas\' style=\'width: 100%; text-align: center; bottom: 0px; left: 0px; border: 1px ridge\'></div>"\r\n\r\n                document.getElementById(\'confirma\').style.display = \'none\';\r\n                document.getElementById(\'imprimirPDF\').style.display = \'none\';\r\n                document.getElementById(\'exportarXML\').style.display = \'none\';\r\n                document.getElementById(\'exportarCSV\').style.display = \'none\';\r\n                document.getElementById(\'linhaPedidosInformacao\').innerHTML = htm;\r\n\r\n            },\r\n\r\n            error: function (jerro) {\r\n                alert(jerro.responseText + "Erro ao receber o arquivo!");\r\n            }\r\n        });\r\n    };\r\n\r\n    // Busca Estrutura Organizacional\r\n    if (($("#hndAcao").val() == 20) && ($("#hndItem").val() == 2)) {\r\n\r\n        // Alterar a URL para usar esta abaixo - N\xc3O ESQUECER\r\n        // meuHost\r\n        // url: "http://" + meuHost + ":90/api/EstruturaOrganizacional",\r\n        //url: "http://ws713:90/api/EstruturaOrganizacional",\r\n\r\n        $.ajax({\r\n            type: "GET",\r\n            url: "acao.asp?acao=RetornaEstruturaOrganizacional&param1=0",\r\n            dataType: "json",\r\n            //crossDomain: false,\r\n            success: function (jdados) {\r\n                var htm = "";\r\n                htm += "<div style=\'width: 100%; text-align: center;\'>Consulta da Estrutura Organizacional das Entidades</div>";\r\n                htm += "<p>";\r\n                for (var i = 0; i < jdados.length; i++) {\r\n\r\n                    var objResult = jdados[i];\r\n\r\n                    // htm += "<div id=\'linhaPerguntas\' style=\'width: 100%; text-align: center; bottom: 0px; left: 0px; border: 1px ridge\'></div>";\r\n                    htm += "<table id=\'EstruturaOrganizacional\'>";\r\n                    htm += "<div style=\'font-family:Verdana; font-size:14px; text-align: left; width:100%;\'>";\r\n\r\n                    if (objResult.nomeEntidade != null) {\r\n                        htm += "<h4 style=\'height:4px; padding-left: 20px; \'><img id=\'image\' src=\'/" + nomeAplicacaoDWS + "/imagens/setaDireita.png\' width=\'20\' height=\'20\'><b> &nbsp;&nbsp; Nome da Entidade:    " + objResult.nomeEntidade + "</b></h4>";\r\n                    }\r\n                    if (objResult.nmEntidadePrincipal != null && objResult.nmEntidadePrincipal != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; width:100%; padding-left: 60px; padding-top: 10px;\'> Nome Entidade Principal:  " + objResult.nmEntidadePrincipal + "</p>";\r\n                    }\r\n                    if (objResult.CompetenciasEntidade != null && objResult.CompetenciasEntidade != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; width:100%; padding-left: 60px; padding-top: 10px;\'> Compet\xeancias da Entidade:   " + objResult.CompetenciasEntidade + "</p>";\r\n                    }\r\n                    if (objResult.Logradouro != null && objResult.Logradouro != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; width:100%; padding-left: 60px; \'> Logradouro:   " + objResult.Logradouro + "</p>";\r\n                    }\r\n                    if (objResult.Bairro != null && objResult.Bairro != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; width:100%; padding-left: 60px; \'> Bairro:   " + objResult.Bairro + "</p>";\r\n                    }\r\n                    if (objResult.CEP != null && objResult.CEP != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; width:100%; padding-left: 60px; \'> CEP:   " + objResult.CEP + "</p>";\r\n                    }\r\n                    if (objResult.Complemento != null && objResult.Complemento != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; width:100%; padding-left: 60px; \'> Complemento:   " + objResult.Complemento + "</p>";\r\n                    }\r\n                    if (objResult.TelefoneFixo != null && objResult.TelefoneFixo != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; width:100%; padding-left: 60px; \'> Telefone Fixo:    " + objResult.TelefoneFixo + "</p>";\r\n                    }\r\n                    if (objResult.Celular != null && objResult.Celular != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Celular:    " + objResult.Celular + "</p>";\r\n                    }\r\n                    if (objResult.Fax != null && objResult.Fax != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> FAX:    " + objResult.Fax + "</p>";\r\n                    }\r\n                    if (objResult.EnderecoEletronico != null && objResult.EnderecoEletronico != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; width:100%; padding-left: 60px; \'> Endere\xe7o Eletr\xf4nico: <a href=\'mailto:" + objResult.EnderecoEletronico + "\'>" + objResult.EnderecoEletronico + "</a></p>";\r\n                    }\r\n                    if (objResult.SiteEntidade != null && objResult.SiteEntidade != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; width:100%; padding-left: 60px; \'> Site da Entidade: <a href=\'http://" + objResult.SiteEntidade + "\'>" + objResult.SiteEntidade + "</a></p>";\r\n                    }\r\n\r\n                    if (objResult.hroAtendimento != null && objResult.hroAtendimento != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; width:100%; padding-left: 60px; \'> Hor\xe1rio de Atendimento:   " + objResult.hroAtendimento + "</p>";\r\n                    }\r\n                    if (objResult.cntEletronicoEntidade != null && objResult.cntEletronicoEntidade != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; width:100%; padding-left: 60px; \'> Contato Eletr\xf4nico da Entidade: <a href=\'http://" + objResult.cntEletronicoEntidade + "\'>" + objResult.cntEletronicoEntidade + "</a></p>";\r\n                    }\r\n                    if (objResult.nmResponsavel != null && objResult.nmResponsavel != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; width:100%; padding-left: 60px; \'> Nome do respons\xe1vel:   " + objResult.nmResponsavel + "</p>";\r\n                    }\r\n                    if (objResult.cntEletronicoResponsavel != null && objResult.cntEletronicoResponsavel != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; width:100%; padding-left: 60px; \'> Contato Eletr\xf4nico do respons\xe1vel:   " + objResult.cntEletronicoResponsavel + "</p>";\r\n                    }\r\n                    if (objResult.respTelefone != null && objResult.respTelefone != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; width:100%; padding-left: 60px; \'> Telefone Fixo do respons\xe1vel:   " + objResult.respTelefone + "</p>";\r\n                    }\r\n                    if (objResult.respCelular != null && objResult.respCelular != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; width:100%; padding-left: 60px; \'> Celular respons\xe1vel:   " + objResult.respCelular + "</p>";\r\n                    }\r\n\r\n                    var fileName = objResult.arqEstruturaOrganizacional.toString().toUpperCase();\r\n                    if (objResult.arqEstruturaOrganizacional != null && objResult.arqEstruturaOrganizacional != "" && fileName.endsWith(\'PDF\') == false) {\r\n                        htm += "<p style=\'display:none; text-align:center; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; padding-botton: 3px\'> <img alt=\'\' src=\'/" + nomeAplicacaoDWS + "/imagens/" + objResult.arqEstruturaOrganizacional + "\' /></p>";\r\n                    }\r\n\r\n                    if (objResult.arqEstruturaOrganizacional != null && objResult.arqEstruturaOrganizacional != "" && fileName.endsWith(\'PDF\') == true) {\r\n                        htm += "<p style=\'display:none; text-align:center; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; padding-botton: 3px\'> <a href=\'/" + nomeAplicacaoDWS + "/imagens/" + objResult.arqEstruturaOrganizacional + "\' title=\'Clique aqui para realizar o Donwload do PDF disponibilizado\'> " + objResult.arqEstruturaOrganizacional + " </a> <img  border=\'0\' src=\'Imagens/download.jpg\' width=\'18px\' height=\'18px\'> </a>";\r\n                    }\r\n\r\n                    htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; width:100%; padding-left: 60px; \'><b>Programas:</b></p>";\r\n                    var data = objResult.Programas\r\n                    for (var x in data) {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; width:100%; padding-left: 60px; \'>" + data[x] + "</p>";\r\n                    }\r\n\r\n                    htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; width:100%; padding-left: 60px; \'><b>Projetos e A\xe7\xf5es:</b></p>";\r\n                    var data = objResult.Projetos\r\n                    for (var y in data) {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; width:100%; padding-left: 60px; \'>" + data[y] + "</p>";\r\n                    }\r\n\r\n                    htm += " </div>";\r\n                    htm += " </table>";\r\n\r\n                }\r\n\r\n                htm += "<div id=\'linhaDivisao\' style=\'padding-top: 10px;\'></div>"\r\n                // htm += "<div id=\'linhaEstruturaRopade\' style=\'width: 100%; text-align: center; bottom: 0px; left: 0px; border: 1px ridge;\'></div>"\r\n\r\n                document.getElementById(\'confirma\').style.display = \'none\';\r\n                document.getElementById(\'imprimirPDF\').style.visibility = "visible";\r\n                document.getElementById(\'exportarXML\').style.visibility = "visible";\r\n                document.getElementById(\'exportarCSV\').style.visibility = "visible";\r\n                document.getElementById(\'linhaEstruturaOrganizacional\').innerHTML = htm;\r\n\r\n                // teste();\r\n            },\r\n\r\n            error: function (jerro) {\r\n                alert(jerro.responseText + "Erro ao receber o arquivo!");\r\n            }\r\n        });\r\n    };\r\n\r\n    // Busca Estrutura Organizacional_SIC\r\n    if (($("#hndAcao").val() == 20) && ($("#hndItem").val() == 6)) {\r\n\r\n\r\n        $.ajax({\r\n            type: "GET",\r\n            url: "acao.asp?acao=RetornaEstruturaOrganizacional&param1=1",\r\n            dataType: "json",\r\n            //crossDomain: false,\r\n            success: function (jdados) {\r\n                var htm = "";\r\n                htm += "<div style=\'width: 100%; text-align: center;\'>Consulta da Estrutura Organizacional das Entidades que possuem SIC</div>";\r\n                htm += "<p>";\r\n                for (var i = 0; i < jdados.length; i++) {\r\n\r\n                    var objResult = jdados[i];\r\n\r\n                    // htm += "<div id=\'linhaPerguntas\' style=\'width: 100%; text-align: center; bottom: 0px; left: 0px; border: 1px ridge\'></div>";\r\n                    htm += "<table id=\'EstruturaOrganizacional\'>";\r\n                    htm += "<div style=\'font-family:Verdana; font-size:14px; text-align: left; width:100%;\'>";\r\n\r\n                    if (objResult.nomeEntidade != null) {\r\n                        htm += "<h4 style=\'height:4px; padding-left: 20px; \'><img id=\'image\' src=\'/" + nomeAplicacaoDWS + "/imagens/setaDireita.png\' width=\'20\' height=\'20\'><b> &nbsp;&nbsp; Nome da Entidade:    " + objResult.nomeEntidade + "</b></h4>";\r\n                    }\r\n                    if (objResult.nmEntidadePrincipal != null && objResult.nmEntidadePrincipal != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; padding-top: 10px;\'> Nome Entidade Principal:  " + objResult.nmEntidadePrincipal + "</p>";\r\n                    }\r\n                    if (objResult.CompetenciasEntidade != null && objResult.CompetenciasEntidade != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; padding-top: 10px;\'> Compet\xeancias da Entidade:   " + objResult.CompetenciasEntidade + "</p>";\r\n                    }\r\n                    if (objResult.Logradouro != null && objResult.Logradouro != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Logradouro:   " + objResult.Logradouro + "</p>";\r\n                    }\r\n                    if (objResult.Bairro != null && objResult.Bairro != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Bairro:   " + objResult.Bairro + "</p>";\r\n                    }\r\n                    if (objResult.CEP != null && objResult.CEP != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> CEP:   " + objResult.CEP + "</p>";\r\n                    }\r\n                    if (objResult.Complemento != null && objResult.Complemento != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Complemento:   " + objResult.Complemento + "</p>";\r\n                    }\r\n                    if (objResult.TelefoneFixo != null && objResult.TelefoneFixo != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Telefone Fixo:    " + objResult.TelefoneFixo + "</p>";\r\n                    }\r\n                    if (objResult.Celular != null && objResult.Celular != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Celular:    " + objResult.Celular + "</p>";\r\n                    }\r\n                    if (objResult.Fax != null && objResult.Fax != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> FAX:    " + objResult.Fax + "</p>";\r\n                    }\r\n                    if (objResult.EnderecoEletronico != null && objResult.EnderecoEletronico != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Endere\xe7o Eletr\xf4nico: <a href=\'mailto:" + objResult.EnderecoEletronico + "\'>" + objResult.EnderecoEletronico + "</a></p>";\r\n                    }\r\n                    if (objResult.SiteEntidade != null && objResult.SiteEntidade != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Site da Entidade: <a href=\'http://" + objResult.SiteEntidade + "\'>" + objResult.SiteEntidade + "</a></p>";\r\n                    }\r\n\r\n                    if (objResult.hroAtendimento != null && objResult.hroAtendimento != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Hor\xe1rio de Atendimento:   " + objResult.hroAtendimento + "</p>";\r\n                    }\r\n                    if (objResult.cntEletronicoEntidade != null && objResult.cntEletronicoEntidade != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Contato Eletr\xf4nico da Entidade: <a href=\'http://" + objResult.cntEletronicoEntidade + "\'>" + objResult.cntEletronicoEntidade + "</a></p>";\r\n                    }\r\n                    if (objResult.nmResponsavel != null && objResult.nmResponsavel != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Nome do respons\xe1vel:   " + objResult.nmResponsavel + "</p>";\r\n                    }\r\n                    if (objResult.cntEletronicoResponsavel != null && objResult.cntEletronicoResponsavel != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Contato Eletr\xf4nico do respons\xe1vel:   " + objResult.cntEletronicoResponsavel + "</p>";\r\n                    }\r\n                    if (objResult.respTelefone != null && objResult.respTelefone != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Telefone Fixo do respons\xe1vel:   " + objResult.respTelefone + "</p>";\r\n                    }\r\n                    if (objResult.respCelular != null && objResult.respCelular != "") {\r\n                        htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Celular respons\xe1vel:   " + objResult.respCelular + "</p>";\r\n                    }\r\n                    if (objResult.arqEstruturaOrganizacional != null && objResult.arqEstruturaOrganizacional != "") {\r\n                        htm += "<p style=\'display:none; text-align:center; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; padding-botton: 3px\'> <img alt=\'\' src=\'/" + nomeAplicacaoDWS + "/imagens/" + objResult.arqEstruturaOrganizacional + "\' /></p>";\r\n                    }\r\n\r\n                    htm += " </div>";\r\n                    htm += " </table>";\r\n\r\n                }\r\n\r\n                htm += "<div id=\'linhaDivisao\' style=\'padding-top: 10px;\'></div>"\r\n                htm += "<div id=\'linhaEstruturaSIC_Ropade\' style=\'width: 100%; text-align: center; bottom: 0px; left: 0px; border: 1px ridge;\'></div>"\r\n\r\n                document.getElementById(\'confirma\').style.display = \'none\';\r\n                document.getElementById(\'imprimirPDF\').style.visibility = "visible";\r\n                document.getElementById(\'exportarXML\').style.visibility = "visible";\r\n                document.getElementById(\'exportarCSV\').style.visibility = "visible";\r\n                document.getElementById(\'linhaEstruturaOrganizacional\').innerHTML = htm;\r\n\r\n                // teste();\r\n            },\r\n\r\n            error: function (jerro) {\r\n                alert(jerro.responseText + "Erro ao receber o arquivo!");\r\n            }\r\n        });\r\n    };\r\n\r\n    // Some com o bot\xe3o de confirma\xe7\xe3o para as telas de perguntas frequentes e estrutura organizacional\r\n    if (($("#hndAcao").val() == 20) && ($("#hndItem").val() == 3)) {\r\n\r\n        document.getElementById(\'confirma\').style.display = \'none\';\r\n    }\r\n\r\n    $(\'#cmbEstoqueDataVigenciaLC\').change(function () {\r\n\r\n        if (this.value > 0) {\r\n\r\n            LimpaCombo("cmbEstoqueMesInicial");\r\n            LimpaCombo("cmbEstoqueMesFinal");\r\n\r\n            $("#cmbEstoqueMesInicial").css("display", "block");\r\n            //$("#mensagemAteCombo").css("display", "block");\r\n\r\n            $("#cmbEstoqueMesInicial").removeAttr("style");\r\n            //$("#mensagemAteCombo").removeAttr("style");\r\n\r\n            var comboMesesEstoque;\r\n\r\n            for (xx = 0; xx < 2; xx++) {\r\n\r\n                if (xx == 0) {\r\n                    comboMesesEstoque = document.getElementById("cmbEstoqueMesInicial");\r\n                } else {\r\n                    comboMesesEstoque = document.getElementById("cmbEstoqueMesFinal");\r\n                }\r\n\r\n                var opt0 = document.createElement("option");\r\n                opt0.value = "0";\r\n                opt0.text = "SELECIONE";\r\n                comboMesesEstoque.add(opt0, comboMesesEstoque.options[0]);\r\n\r\n                for (x = 1; x < 13; x++) {\r\n                    var opt = document.createElement("option");\r\n                    opt.value = x;\r\n                    if (x == 1) {\r\n                        opt.text = "Janeiro";\r\n                    } else if (x == 2) {\r\n                        opt.text = "Fevereiro";\r\n                    } else if (x == 3) {\r\n                        opt.text = "Mar\xe7o";\r\n                    } else if (x == 4) {\r\n                        opt.text = "Abril";\r\n                    } else if (x == 5) {\r\n                        opt.text = "Maio";\r\n                    } else if (x == 6) {\r\n                        opt.text = "Junho";\r\n                    } else if (x == 7) {\r\n                        opt.text = "Julho";\r\n                    } else if (x == 8) {\r\n                        opt.text = "Agosto";\r\n                    } else if (x == 9) {\r\n                        opt.text = "Setembro";\r\n                    } else if (x == 10) {\r\n                        opt.text = "Outubro";\r\n                    } else if (x == 11) {\r\n                        opt.text = "Novembro";\r\n                    } else if (x == 12) {\r\n                        opt.text = "Dezembro";\r\n                    }\r\n\r\n                    comboMesesEstoque.add(opt, comboMesesEstoque.options[x]);\r\n                };\r\n            };\r\n\r\n        } else {\r\n            limparDados("cmbEstoqueMesInicial");\r\n        }\r\n    }).change();\r\n\r\n    // Tela de Pesquisa\r\n    if (($("#hndAcao").val() == 20) && ($("#hndItem").val() == 4)) {\r\n\r\n        var url = $.url(unescape(window.location.href));\r\n        var textoPesquisa = unescape(url.param(\'txtPesquisa\'));\r\n\r\n        var valResultadoPesquisa = retiraAcento(textoPesquisa);\r\n\r\n        if (valResultadoPesquisa != "") {\r\n            var meuHost = window.location.host;\r\n\r\n            $.ajax({\r\n                type: "GET",\r\n                global: false,\r\n                url: "acao.asp",\r\n                data: "acao=buscaPesquisa&param1=" + valResultadoPesquisa.toString(),\r\n                dataType: "json",\r\n                async: false,\r\n                cache: false,\r\n                success: function (jdados) {\r\n                    var htm = "";\r\n                    if (jdados) {\r\n                        // Menu XML\r\n\r\n                        htm = "";\r\n                        htm += "<table id=\'pesquisaRapida\'>";\r\n                        htm += "<div style=\'width:100%; \'>";\r\n\r\n                        htm += "<div style=\'width:100%;height:0px;\' ><td style=\'font-family:Verdana; text-align: left; font-size:18px;\'>";\r\n                        var vMenu = 0;\r\n\r\n                        for (var i = 0; i < jdados.length; i++) {\r\n                            var objResult = jdados[i];\r\n                            if (objResult.Pai != "" && typeof objResult.Pai != "undefined") {\r\n\r\n                                if (vMenu == 0) {\r\n                                    htm += "<p style=\'height:0px;\'><b> Menu </b></p>";\r\n                                    vMenu += 1;\r\n                                }\r\n\r\n                                htm += "<tr style=\'font-family:Verdana; font-size:14px; text-align: left; color:#0074B2;\' ><td>";\r\n                                htm += "<h4 style=\'height:3px; padding-left: 20px;\'><img id=\'image\' src=\'/" + nomeAplicacaoDWS + "/imagens/setaDireita.png\' width=\'20px\' height=\'20px\'><b style=\'padding-left: 9px;\'>" + objResult.Pai.toUpperCase() + "</b></h4>";\r\n\r\n                                if (objResult.Filho != "" && typeof objResult.Filho != "undefined") {\r\n\r\n                                    var strFilhos = objResult.Filho;\r\n                                    var resFilhos = strFilhos.split("|");\r\n\r\n                                    var strURL = objResult.URL;\r\n                                    var resURL = strURL.split("|");\r\n\r\n                                    // htm += " <p style=\'display:none; height:3px; padding-left: 40px;\' > <a style=\'font-size: 12px;!important; text-decoration:none;\' class=\'but\' >" + objResult.Filho + "</a></p>";\r\n\r\n                                    htm += " <p style=\'display:none;width: auto; height:3px; padding-left: 40px;\' >";\r\n                                    htm += " | ";\r\n\r\n                                    for (var i1 = 0; i1 < resFilhos.length; i1++) {\r\n                                        if (resURL[i1] != \'Vazio\') {\r\n                                            var vHttp = resURL[i1].indexOf("http") > -1 ? true : false;\r\n                                            //Aqui eu Verifico o Link que o Usuario Cadastrou, quando n\xe3o \xe9 um link interno do sistema eu ignoro o meu Host\r\n                                            //e escrevo o link que o cliente cadastrou.\r\n                                            if (vHttp) {\r\n                                                htm += " <a style=\'font-size: 12px;!important; padding: 10px 0px;\'  class=\'but\' href=\'" + resURL[i1] + "\' target=\'_blank\'>" + resFilhos[i1] + "</a>";\r\n                                                htm += " | ";\r\n                                            }\r\n                                            else {\r\n                                                htm += " <a style=\'font-size: 12px;!important; padding: 10px 0px;\'  class=\'but\' href=\'http://" + meuHost + "/" + nomeAplicacaoDWS + "" + resURL[i1] + "\' >" + resFilhos[i1] + "</a>";\r\n                                                htm += " | ";\r\n                                            }\r\n                                        }\r\n                                        else {\r\n                                            htm += " <a style=\'font-size: 12px;!important;\' class=\'but\' >" + resFilhos[i1] + "</a>";\r\n                                        }\r\n                                    }\r\n\r\n                                    htm += "</p>";\r\n\r\n                                }\r\n                                htm += "</td></tr>";\r\n                            }\r\n                        }\r\n                        htm += "</td></div>";\r\n                        htm += " </div>";\r\n                        htm += " </table>";\r\n\r\n                        // ---- Perguntas Frequentes\r\n\r\n                        htm += "<div style=\'font-family:Verdana; text-align: left; font-size:18px; \'><td>";\r\n                        htm += "<table id=\'pesquisaRapidaPerguntas\'>";\r\n                        htm += "<div style=\'width:100%; \'>";\r\n\r\n                        var vPerguntasFrequentes = 0;\r\n\r\n                        for (var i = 0; i < jdados.length; i++) {\r\n                            var objResult = jdados[i];\r\n                            if (objResult.Pergunta != "" && typeof objResult.Pergunta != "undefined") {\r\n\r\n                                if (vPerguntasFrequentes == 0) {\r\n                                    htm += "<p style=\'height:0px;\'><b> Perguntas Frequentes </b></p>";\r\n                                    vPerguntasFrequentes += 1;\r\n                                }\r\n\r\n                                htm += "<tr style=\'font-family:Verdana; font-size:14px; color:#0074B2;\'><td>";\r\n                                htm += "<h4 style=\'height:3px; padding-left: 20px;\'><img id=\'image\' src=\'/" + nomeAplicacaoDWS + "/imagens/setaDireita.png\' width=\'20px\' height=\'20px\'><b style=\'padding-left: 5px;\'> " + objResult.Pergunta.toUpperCase() + "</b></h4>";\r\n                                htm += " <p style=\'display:block ; text-align:justify; \'height:3px;\'><a style=\'font-size: 12px;!important; padding-left: 70px;\' class=\'but\' href=\'http://" + meuHost + "/" + nomeAplicacaoDWS + "/index.asp?acao=20&item=1\' >" + objResult.Resposta + "</a></p>";\r\n                                htm += "</td></tr>";\r\n                            }\r\n                        }\r\n\r\n                        htm += "</td></div>";\r\n\r\n                        htm += " </div>";\r\n                        htm += " </table>";\r\n\r\n                        // ---- Publica\xe7\xf5es\r\n\r\n                        htm += "<div id=\'geraPublicacoes\' style=\'font-family:Verdana; text-align: left; font-size:18px;\'>";\r\n                        htm += "<div style=\'width: 100%; font-size: 8px;\'>&nbsp;&nbsp;&nbsp;</div>";\r\n                        htm += "<div style=\'width: 100%; text-align: center;\'></div>";\r\n                        htm += "<p>";\r\n\r\n                        var iTitulo = 0;\r\n                        var strNomeTema = "";\r\n\r\n                        var vPublicacoes = 0;\r\n\r\n                        for (var i = 0; i < jdados.length; i++) {\r\n                            var objResult = jdados[i];\r\n                            if (objResult.ID_AREA != "" && typeof objResult.ID_AREA != "undefined") {\r\n\r\n                                if (vPublicacoes == 0) {\r\n                                    htm += "<p><b>Publica\xe7\xf5es </b></p>";\r\n                                    vPublicacoes += 1;\r\n                                }\r\n\r\n                                if (iTitulo == 0) {\r\n                                    strNomeTema = objResult.Nome_tema;\r\n\r\n                                    htm += "<div id=\'linhaPerguntas\'  style=\'font-family:Verdana; font-size:14px; color:#0074B2;\'></div>";\r\n                                    htm += "<table id=\'publicacoesArquivos\'>";\r\n                                    htm += "<div style=\'width:100%\'>";\r\n\r\n                                    htm += "<h4 style=\'height:3px; padding-left: 20px;\'><img id=\'image\' src=\'/" + nomeAplicacaoDWS + "/imagens/setaDireita.png\' width=\'20px\' height=\'20px\'><b style=\'font-family:Verdana; font-size:14px; color:#0074B2; padding-left: 5px;\'> " + objResult.Nome_tema + "</b></h4>";\r\n\r\n\r\n                                    htm += "<div style=\'font-size: 3px; width:100%; height:100%; \'>";\r\n                                    if (objResult.Descricao_tema != "") {\r\n                                        htm += "<div style=\'width:1px; height:1px;\'></div>";\r\n                                        htm += "<p style=\'display:block; font-size: 11px;!important; width:100%; text-align:justify; height:100%; padding-left: 70px;\'><a style=\'font-size: 12px;!important; padding-left: 0px;\' class=\'but\' href=\'http://" + meuHost + "/" + nomeAplicacaoDWS + "/index.asp?acao=21&item=1\'>" + objResult.Descricao_tema + "</a></p>";\r\n                                    }\r\n                                    htm += "</div>";\r\n\r\n                                    iTitulo += 1;\r\n                                }\r\n\r\n                                if (strNomeTema != objResult.Nome_tema) {\r\n\r\n                                    htm += "</div>";\r\n                                    htm += " </table>";\r\n\r\n                                    htm += "<div id=\'linhaPerguntas\' style=\'font-family:Verdana; font-size:14px; color:#0074B2;\'></div>";\r\n                                    htm += "<table id=\'publicacoesArquivos\'>";\r\n                                    htm += "<div style=\'width:100%;\'>";\r\n\r\n                                    htm += "<h4 style=\'height:3px; padding-left: 20px;\'><img id=\'image\' src=\'/" + nomeAplicacaoDWS + "/imagens/setaDireita.png\' width=\'20px\' height=\'20px\'><b style=\'font-family:Verdana; font-size:14px; color:#0074B2; padding-left: 5px;\'> " + objResult.Nome_tema + "</b></h4>";\r\n\r\n                                    htm += "<div style=\'font-size: 3px; width:100%; height:100%;\'>";\r\n                                    if (objResult.Descricao_tema != null) {\r\n                                        htm += "<div style=\'width:1px; height:1px;\'></div>";\r\n                                        htm += "<p style=\'display:block; font-size: 11px;!important; width:100%; text-align:justify; height:100%; padding-left: 70px;\'><a style=\'font-size: 12px;!important; padding-left: 0px;\' class=\'but\' href=\'http://" + meuHost + "/" + nomeAplicacaoDWS + "/index.asp?acao=21&item=1\'>" + objResult.Descricao_tema + "</a></p>";\r\n                                    }\r\n                                    htm += "</div>";\r\n\r\n                                    strNomeTema = objResult.Nome_tema;\r\n\r\n                                }\r\n\r\n\r\n                                if (objResult.Nome_arquivo != null && objResult.Nome_arquivo != "") {\r\n                                    htm += "<p style=\'display:none; font-size: 11px;padding-left: 70px;\'>Nome:  " + objResult.Nome_arquivo + "</p>";\r\n                                } else {\r\n                                    htm += "<p style=\'display:none; font-size: 11px;padding-left: 70px;\'>Nome:  " + objResult.Nome_tema + " - " + objResult.NOME_RELATORIO + "</p>";\r\n                                }\r\n\r\n                                if (objResult.IMG_ARQUIVO != null) {\r\n                                    htm += "<p style=\'display:none; font-size: 11px;padding-left: 70px;\'>";\r\n\r\n                                    switch (objResult.ID_AREA) {\r\n                                        // DRO 353214 - 07/11/2018 - Inicio\r\n                                        case "0": {\r\n                                            htm += "Arquivo: <a style=\'font-size: 12px;!important; text-decoration: underline; padding-left: 0px; backgound: none;\' class=\'but\'  href=\'http://" + meuHost + "/" + nomeAplicacaoDWS + "/upload/Outros/" + objResult.IMG_ARQUIVO + "\'> " + objResult.IMG_ARQUIVO + "</a>";\r\n\r\n                                        } break;\r\n                                        // DRO 353214 - 07/11/2018 - Fim\r\n                                        case "1": {\r\n                                            htm += "Arquivo: <a style=\'font-size: 12px;!important; text-decoration: underline; padding-left: 0px; backgound: none;\' class=\'but\'   href=\'http://" + meuHost + "/" + nomeAplicacaoDWS + "/upload/Gestao_de_Pessoal/" + objResult.IMG_ARQUIVO + "\'> " + objResult.IMG_ARQUIVO + "</a>";\r\n                                        } break;\r\n                                        case "2": {\r\n                                            htm += "Arquivo: <a style=\'font-size: 12px;!important; text-decoration: underline; padding-left: 0px;  backgound: none;\' class=\'but\'  href=\'http://" + meuHost + "/" + nomeAplicacaoDWS + "/upload/Administracao_Geral/" + objResult.IMG_ARQUIVO + "\'> " + objResult.IMG_ARQUIVO + "</a>";\r\n\r\n                                        } break;\r\n                                        case "3": {\r\n                                            htm += "Arquivo: <a style=\'font-size: 12px;!important; text-decoration: underline; padding-left: 0px; backgound: none;\' class=\'but\'  href=\'http://" + meuHost + "/" + nomeAplicacaoDWS + "/upload/Arrecadacao/" + objResult.IMG_ARQUIVO + "\'> " + objResult.IMG_ARQUIVO + "</a>";\r\n\r\n                                        } break;\r\n                                        case "4": {\r\n                                            htm += "Arquivo: <a style=\'font-size: 12px;!important; text-decoration: underline; padding-left: 0px; backgound: none;\' class=\'but\'  href=\'http://" + meuHost + "/" + nomeAplicacaoDWS + "/upload/Financeira/" + objResult.IMG_ARQUIVO + "\'> " + objResult.IMG_ARQUIVO + "</a>";\r\n\r\n                                        } break;\r\n                                        case "5": {\r\n                                            htm += "Arquivo: <a style=\'font-size: 12px;!important; text-decoration: underline; padding-left: 0px; backgound: none;\' class=\'but\'  href=\'http://" + meuHost + "/" + nomeAplicacaoDWS + "/upload/Outros/" + objResult.IMG_ARQUIVO + "\'> " + objResult.IMG_ARQUIVO + "</a>";\r\n\r\n                                        } break;\r\n                                    };\r\n\r\n\r\n                                    htm += "</p>";\r\n\r\n                                    if (objResult.DT_VIGENCIA_INICIO != null && objResult.DT_VIGENCIA_INICIO != "") {\r\n\r\n                                        if (objResult.DT_VIGENCIA_FIM != null && objResult.DT_VIGENCIA_FIM != "") {\r\n                                            htm += "<p style=\'display:none; font-size: 11px; padding-left: 70px;\'>Refer\xeancia:  " + objResult.DT_VIGENCIA_INICIO + " a " + objResult.DT_VIGENCIA_FIM + "</p>";\r\n                                        } else {\r\n                                            htm += "<p style=\'display:none; font-size: 11px; padding-left: 70px;\'>Refer\xeancia:  " + objResult.DT_VIGENCIA_INICIO + " a Vigente </p>";\r\n                                        }\r\n                                    }\r\n\r\n                                    if (objResult.DS_DESCRICAO != null) {\r\n                                        htm += "<p style=\'display:none; font-size: 11px; padding-left: 70px;\'>Descri\xe7\xe3o:  " + objResult.DS_DESCRICAO + "</p>";\r\n                                    }\r\n\r\n                                    if (objResult.DT_INCLUSAOARQUIVO != null) {\r\n                                        htm += "<p style=\'display:none; font-size: 11px; padding-left: 70px;\'>Data inclus\xe3o no Portal:  " + objResult.DT_INCLUSAOARQUIVO + "</p>";\r\n                                    }\r\n\r\n                                    htm += "<p style=\'display:none; width: 50%; text-align: center; bottom: 0px;  border: 1px ridge\'>";\r\n                                    htm += "</p>";\r\n                                };\r\n                            }\r\n                        }\r\n\r\n                        htm += " </div>";\r\n                        htm += " </table>";\r\n                        htm += " </div>";\r\n\r\n                        var vEstrutura = 0;\r\n                        // Estrutura Organizacional\r\n                        //htm += "<div style=\'width: 100%; text-align: center;\'>Consulta da Estrutura Organizacional das Entidades</div>";\r\n                        htm += "<div id=\'geraPublicacoes\' style=\'font-family:Verdana; text-align: left; font-size:18px;\'>";\r\n                        htm += "<div style=\'width: 100%; font-size: 8px;\'>&nbsp;&nbsp;&nbsp;</div>";\r\n                        htm += "<div style=\'width: 100%; text-align: center;\'></div>";\r\n                        htm += "<p>";\r\n                        for (var i = 0; i < jdados.length; i++) {\r\n\r\n                            var objResult = jdados[i];\r\n\r\n                            if (objResult.nomeEntidade != "" && typeof objResult.nomeEntidade != "undefined") {\r\n\r\n                                if (vEstrutura == 0) {\r\n                                    htm += "<p><b>Estrutura Organizacional </b></p>";\r\n                                    vEstrutura += 1;\r\n                                }\r\n\r\n                                //htm += "<div id=\'linhaPerguntas\' style=\'width: 100%; text-align: center; bottom: 0px; left: 0px; border: 1px ridge\'></div>";\r\n                                htm += "<table id=\'EstruturaOrganizacional\'>";\r\n                                htm += "<div style=\'font-family:Verdana; font-size:14px; text-align: left; width:100%;\'>";\r\n\r\n                                if (objResult.nomeEntidade != null) {\r\n                                    htm += "<h4 style=\'height:4px; padding-left: 20px; \'><img id=\'image\' src=\'/" + nomeAplicacaoDWS + "/imagens/setaDireita.png\' width=\'20\' height=\'20\'><b <b style=\'font-family:Verdana; font-size:14px; color:#0074B2; padding-left: 5px;\'> NOME DA ENTIDADE:    " + objResult.nomeEntidade.toUpperCase() + "</b></h4>";\r\n                                }\r\n                                if (objResult.nmEntidadePrincipal != null && objResult.nmEntidadePrincipal != "") {\r\n                                    htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; padding-top: 10px;\'> Nome Entidade Principal:  " + objResult.nmEntidadePrincipal + "</p>";\r\n                                }\r\n                                if (objResult.CompetenciasEntidade != null && objResult.CompetenciasEntidade != "") {\r\n                                    htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; padding-top: 10px;\'> Compet\xeancias da Entidade:   " + objResult.CompetenciasEntidade + "</p>";\r\n                                }\r\n                                if (objResult.Logradouro != null && objResult.Logradouro != "") {\r\n                                    htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Logradouro:   " + objResult.Logradouro + "</p>";\r\n                                }\r\n                                if (objResult.Bairro != null && objResult.Bairro != "") {\r\n                                    htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Bairro:   " + objResult.Bairro + "</p>";\r\n                                }\r\n                                if (objResult.CEP != null && objResult.CEP != "") {\r\n                                    htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> CEP:   " + objResult.CEP + "</p>";\r\n                                }\r\n                                if (objResult.Complemento != null && objResult.Complemento != "") {\r\n                                    htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Complemento:   " + objResult.Complemento + "</p>";\r\n                                }\r\n                                if (objResult.TelefoneFixo != null && objResult.TelefoneFixo != "") {\r\n                                    htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Telefone Fixo:    " + objResult.TelefoneFixo + "</p>";\r\n                                }\r\n                                if (objResult.Celular != null && objResult.Celular != "") {\r\n                                    htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Celular:    " + objResult.Celular + "</p>";\r\n                                }\r\n                                if (objResult.Fax != null && objResult.Fax != "") {\r\n                                    htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> FAX:    " + objResult.Fax + "</p>";\r\n                                }\r\n                                if (objResult.EnderecoEletronico != null && objResult.EnderecoEletronico != "") {\r\n                                    htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Endere\xe7o Eletr\xf4nico: <a style=\'font-size: 12px;!important; text-decoration: underline; padding-left: 0px; backgound: none;\' class=\'but\' href=\'mailto:" + objResult.EnderecoEletronico + "\'>" + objResult.EnderecoEletronico + "</a></p>";\r\n                                }\r\n                                if (objResult.SiteEntidade != null && objResult.SiteEntidade != "") {\r\n                                    htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Site da Entidade: <a style=\'font-size: 12px;!important; text-decoration: underline; padding-left: 0px; backgound: none;\' class=\'but\' href=\'http://" + objResult.SiteEntidade + "\'>" + objResult.SiteEntidade + "</a></p>";\r\n                                }\r\n                                if (objResult.hroAtendimento != null && objResult.hroAtendimento != "") {\r\n                                    htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Hor\xe1rio de Atendimento:   " + objResult.hroAtendimento + "</p>";\r\n                                }\r\n                                if (objResult.cntEletronicoEntidade != null && objResult.cntEletronicoEntidade != "") {\r\n                                    htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Contato Eletr\xf4nico da Entidade: <a style=\'font-size: 12px;!important; text-decoration: underline; padding-left: 0px; backgound: none;\' class=\'but\' href=\'http://" + objResult.cntEletronicoEntidade + "\'>" + objResult.cntEletronicoEntidade + "</a></p>";\r\n                                }\r\n                                if (objResult.nmResponsavel != null && objResult.nmResponsavel != "") {\r\n                                    htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Nome do respons\xe1vel:   " + objResult.nmResponsavel + "</p>";\r\n                                }\r\n                                if (objResult.cntEletronicoResponsavel != null && objResult.cntEletronicoResponsavel != "") {\r\n                                    htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Contato Eletr\xf4nico do respons\xe1vel:   " + objResult.cntEletronicoResponsavel + "</p>";\r\n                                }\r\n                                if (objResult.respTelefone != null && objResult.respTelefone != "") {\r\n                                    htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Telefone Fixo do respons\xe1vel:   " + objResult.respTelefone + "</p>";\r\n                                }\r\n                                if (objResult.respCelular != null && objResult.respCelular != "") {\r\n                                    htm += "<p style=\'display:none; text-align:justify; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; \'> Celular respons\xe1vel:   " + objResult.respCelular + "</p>";\r\n                                }\r\n                                if (objResult.arqEstruturaOrganizacional != null && objResult.arqEstruturaOrganizacional != "") {\r\n                                    htm += "<p style=\'display:none; text-align:center; font-size: 11px; colspan= 20; height:100%; padding-left: 60px; padding-botton: 3px\'> <img alt=\'\' src=\'/" + nomeAplicacaoDWS + "/imagens/" + objResult.arqEstruturaOrganizacional + "\' /></p>";\r\n                                }\r\n\r\n                                htm += " </div>";\r\n                                htm += " </table>";\r\n                            }\r\n\r\n                        }\r\n                        htm += " </div>";\r\n\r\n                        htm += "<div id=\'linhaDivisao\' style=\'padding-top: 10px;\'></div>"\r\n                        htm += "<div id=\'linhaEstruturaRopade\' style=\'width: 100%; text-align: center; bottom: 0px; left: 0px; border: 1px ridge;\'></div>"\r\n\r\n\r\n                        document.getElementById(\'confirma\').style.display = \'none\';\r\n                        document.getElementById(\'linhaResultadoPesquisa\').innerHTML = htm;\r\n\r\n                    }\r\n\r\n                    if (jdados.length == 0) {\r\n                        htm += " <b>N\xe3o foi encontrado nenhum item para a pesquisa realizada, por favor refa\xe7a a sua pesquisa!</b>  ";\r\n\r\n\r\n                        document.getElementById(\'confirma\').style.display = \'none\';\r\n                        document.getElementById(\'linhaResultadoPesquisa\').innerHTML = htm;\r\n\r\n\r\n                    }\r\n\r\n                },\r\n\r\n                error: function (jerro) {\r\n                    alert(jerro.responseText + "Erro ao receber o arquivo!");\r\n                }\r\n            });\r\n\r\n        }\r\n\r\n    }\r\n\r\n    // Some com o bot\xe3o de confirma\xe7\xe3o para as telas de perguntas frequentes e estrutura organizacional\r\n    if (($("#hndAcao").val() == 22)) {\r\n\r\n\r\n        document.getElementById(\'confirma\').style.display = \'none\';\r\n        document.getElementById(\'tamanhoTabela\').style.display = \'none\';\r\n        document.getElementById(\'tamanhoTabela\').style.visibility = \'hidden\';\r\n\r\n\r\n    }\r\n\r\n\r\n    //PP\r\n    $("#cmbPatrimonioStatus").change(function () {\r\n        if ($("#cmbPatrimonioSituacaoBem").val() == 1) {\r\n            //em uso\r\n            if ($("#cmbPatrimonioStatus").val() == "N") {\r\n                LimpaCompoTipoIngressoPP()\r\n                CarregaComboTipoingresso()\r\n            }//baixado\r\n            else if ($("#cmbPatrimonioStatus").val() == "B") {\r\n                LimpaCompoTipoIngressoPP()\r\n                $("#TipoPatrimonio").text("Tipo de Baixa:")\r\n                CarregaComboTipoingresso()\r\n            }\r\n        }\r\n        if ($("#cmbPatrimonioStatus").val() == "C") {\r\n            LimpaCompoTipoIngressoPP()\r\n        }\r\n        if ($("#cmbPatrimonioStatus").val() != "B") {\r\n            $("#TipoPatrimonio").text("Tipo de Ingresso:");\r\n        }\r\n    });\r\n\r\n    $("#cmbPatrimonioSituacaoBem").change(function () {\r\n        $("#TipoPatrimonio").text("Tipo de Ingresso:");\r\n        if ($("#cmbPatrimonioSituacaoBem").val() != 1) {\r\n            LimpaCompoTipoIngressoPP()\r\n        }\r\n\r\n        if ($("#cmbPatrimonioSituacaoBem").val() == 1) {\r\n            //em uso\r\n            if ($("#cmbPatrimonioStatus").val() == "N") {\r\n                LimpaCompoTipoIngressoPP()\r\n                CarregaComboTipoingresso()\r\n            }//baixado\r\n            else if ($("#cmbPatrimonioStatus").val() == "B") {\r\n                LimpaCompoTipoIngressoPP()\r\n                $("#TipoPatrimonio").text("Tipo de Baixa:")\r\n                CarregaComboTipoingresso()\r\n            }\r\n        }\r\n    });\r\n    //AF\r\n    $(\'#quantEspecf\').focusout(function () {\r\n        if ($(\'#quantEspecf\').val() != \'\') {\r\n            $("input[name=\'nrMovimentos\']:checked").attr("checked", false);\r\n        }\r\n    });\r\n    $("input[name=\'nrMovimentos\']").click(function () {\r\n        $(\'#quantEspecf\').val(\'\');\r\n    });\r\n    $(\'.tipoDespesaTodas\').click(function () {\r\n        var estado = $(\'.tipoDespesaTodas\').attr(\'checked\');\r\n        //alert(estado);\r\n        $.each($(\'.tipoDespesa\'), function () {\r\n            $(this).attr(\'checked\', estado ? "checked" : "");\r\n        });\r\n    });\r\n    $(\'.tipoDespesa\').click(function () {\r\n        var estado = true;\r\n        var totalNaoChecadas = 0;\r\n        var totalChecadas = 0;\r\n        $.each($(".tipoDespesa"), function () {\r\n            if (!$(this).attr(\'checked\')) {\r\n                totalNaoChecadas++;\r\n                estado = false\r\n            } else {\r\n                totalChecadas++;\r\n            }\r\n        });\r\n        $(\'.tipoDespesaTodas\').attr(\'checked\', estado ? "checked" : "")\r\n    });\r\n\r\n\r\n\r\n\r\n    //MSR - 369133 - 11/07/2019\r\n\r\n    //if ($("#hndAcao").val() == 3 && $("#hndItem").val() == 15) {\r\n    //    preencheComboTipoDespesa();\r\n    //}\r\n\r\n    //MSR Descomentado esse trecho, conforme solicita\xe7\xe3o 369133\r\n    if (($("#hndAcao").val() == 3 && $("#hndItem").val() == 15) || ($("#hndAcao").val() == 10 && $("#hndItem").val() == 6) || ($("#hndAcao").val() == 10 && $("#hndItem").val() == 7)) {\r\n        preencheComboTipoDespesa();\r\n    }\r\n\r\n\r\n    if ($("#hndAcao").val() == 1 && $("#hndItem").val() == 4) {\r\n        consultaHistoricoLances();\r\n    }\r\n\r\n\r\n\r\n});\r\n\r\nfunction LimpaCompoTipoIngressoPP() {\r\n    $("#cmbPatrimonioTipoIngresso").empty();\r\n    $("#cmbPatrimonioTipoIngresso").append("<option value=\'\'>SELECIONE</option>")\r\n}\r\n\r\nfunction CarregaComboTipoingresso() {\r\n    consultarDados(\'RetornaTipoDeIngressoPP\', \'cmbPatrimonioTipoIngresso\', \'cmbPatrimonioUnidadePP\', \'cmbPatrimonioStatus\', \'\', \'\', \'\');\r\n}\r\n\r\nfunction pesquisaRapida() {\r\n\r\n    valResultadoPesquisa = document.getElementById(\'txtPesquisa\').value.toString();\r\n    window.location.href = "http://" + meuHost + "/" + nomeAplicacaoDWS + "/index.asp?acao=20&item=4&txtPesquisa=" + valResultadoPesquisa;\r\n\r\n}\r\n\r\nfunction telaAcessbilidade() {\r\n    var meuHost = window.location.host;\r\n    window.location.href = "http://" + meuHost + "/" + nomeAplicacaoDWS + "/index.asp?acao=20&item=3";\r\n}\r\n\r\nfunction menuFavoritos() {\r\n    var destino = $("#cmbMenuFavoritos");\r\n    if ((destino) && (destino.is(":visible"))) {\r\n        limparDadosFavoritos("cmbMenuFavoritos");\r\n        destino.css("background-color", "#cecece");\r\n\r\n        // destino.attr("disabled", true);\r\n        $.ajax({\r\n            type: "GET",\r\n            global: false,\r\n            url: "acao.asp",\r\n            data: "acao=BuscaFavoritos",\r\n            dataType: "json",\r\n            async: false,\r\n            cache: false,\r\n            success: function (jdados) {\r\n                limparDadosFavoritos("cmbMenuFavoritos");\r\n                if (jdados) {\r\n                    if (jdados.Dados.length > 0) {\r\n                        destino.removeAttr("disabled");\r\n                        for (x = 0; x < jdados.Dados.length; x++) {\r\n                            var dado = jdados.Dados[x];\r\n                            var optn = document.createElement("OPTION");\r\n                            optn.text = dado.descricao;\r\n                            optn.value = dado.value;\r\n                            destino.find("option").end().append("<option value=\'http://" + meuHost + "/" + nomeAplicacaoDWS + "" + dado.value + "\'>" + dado.descricao + "</option>").val("\'" + dado.value + "\'");\r\n                        };\r\n                    }\r\n                }\r\n                destino.css("background-color", "#ffffff");\r\n                //destino.attr("disabled", false);\r\n            },\r\n            error: function (jerro) {\r\n                alert(jerro.responseText);\r\n                destino.css("background-color", "#ffffff");\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n\r\n// Gera exporta\xe7\xe3o de CSV para as telas de estrutura organizacional e perguntas frequentes\r\nfunction exportacaoCSV(tipoExport, validaEsic) {\r\n    // url: "http://ws713:90/api/perguntasfrequentes",\r\n    // url: "http://ws713:90/api/EstruturaOrganizacional",\r\n\r\n    if (tipoExport == 1) {\r\n        $.ajax({\r\n            type: "GET",\r\n            url: "acao.asp?acao=RetornaEstruturaOrganizacional&param1=" + validaEsic,\r\n            dataType: "json",\r\n            //crossDomain: false,\r\n            success: function (jdados) {\r\n                var htm = "";\r\n\r\n                htm += "ENTIDADE;";\r\n                htm += "ENTIDADE PRINCIPAL;";\r\n                htm += "ESTRUTURA ORGANIZACIONAL;";\r\n                htm += "COMPETENCIAS;";\r\n                htm += "ENDERECO;";\r\n                htm += "BAIRRO;";\r\n                htm += "CEP;";\r\n                htm += "COMPLEMENTO;";\r\n                htm += "TELEFONE FIXO;";\r\n                htm += "TELEFONE CELULAR;";\r\n                htm += "FAX;";\r\n                htm += "ENDERECO ELETRONICO;";\r\n                htm += "SITE DA ENTIDADE;";\r\n                htm += "HORARIO DE ATENDIMENTO;";\r\n                htm += "CONTATO ELETRONICO;";\r\n                htm += "NOME RESPONSAVEL;";\r\n                htm += "CONTATO ELETRONICO RESPONSAVEL;";\r\n                htm += "TELEFONE FIXO RESPONSAVEL;";\r\n                htm += "TELEFONE CELULAR RESPONSAVEL;";\r\n                htm += "E-SIC;";\r\n                htm += "\\n";\r\n\r\n                for (var i = 0; i < jdados.length; i++) {\r\n                    var objResult = jdados[i];\r\n                    htm += objResult.nomeEntidade + ";";\r\n                    htm += objResult.nmEntidadePrincipal + ";";\r\n                    htm += objResult.arqEstruturaOrganizacional + ";";\r\n                    htm += objResult.CompetenciasEntidade + ";";\r\n                    htm += objResult.Logradouro + ";";\r\n                    htm += objResult.Bairro + ";";\r\n                    htm += objResult.CEP + ";";\r\n                    htm += objResult.Complemento + ";";\r\n                    htm += objResult.TelefoneFixo + ";";\r\n                    htm += objResult.Celular + ";";\r\n                    htm += objResult.Fax + ";";\r\n                    htm += objResult.EnderecoEletronico + ";";\r\n                    htm += objResult.SiteEntidade + ";";\r\n                    htm += objResult.hroAtendimento + ";";\r\n                    htm += objResult.cntEletronicoEntidade + ";";\r\n                    htm += objResult.nmResponsavel + ";";\r\n                    htm += objResult.cntEletronicoResponsavel + ";";\r\n                    htm += objResult.respTelefone + ";";\r\n                    htm += objResult.respCelular + ";";\r\n                    htm += objResult.nrSIC + ";";\r\n                    htm += "\\n";\r\n                }\r\n\r\n                ExportToCsv(\'estruturaOrganizacional\', htm);\r\n            },\r\n\r\n            error: function (jerro) {\r\n                alert(jerro.responseText + "Erro ao receber o arquivo!");\r\n            }\r\n        });\r\n    } else {\r\n        $.ajax({\r\n            type: "GET",\r\n            url: "acao.asp?acao=RetornaPerguntasFrequentes",\r\n            dataType: "json",\r\n            //crossDomain: false,\r\n            success: function (jdados) {\r\n                var htm = "";\r\n                for (var i = 0; i < jdados.length; i++) {\r\n\r\n                    var objResult = jdados[i];\r\n                    htm += objResult.Pergunta + ";";\r\n                    htm += objResult.Resposta + ";";\r\n                    htm += "\\n";\r\n                }\r\n\r\n                ExportToCsv(\'perguntasFrequentes\', htm);\r\n            },\r\n\r\n            error: function (jerro) {\r\n                alert(jerro.responseText + "Erro ao receber o arquivo!");\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nfunction validaCNPJ(cnpj) {\r\n    var numeros, digitos, soma, i, resultado, pos, tamanho, digitos_iguais;\r\n    digitos_iguais = 1;\r\n    if (cnpj.length < 14 && cnpj.length < 15) {\r\n        return false;\r\n    }\r\n    for (i = 0; i < cnpj.length - 1; i++) {\r\n        if (cnpj.charAt(i) != cnpj.charAt(i + 1)) {\r\n            digitos_iguais = 0;\r\n            break;\r\n        }\r\n    }\r\n    if (!digitos_iguais) {\r\n        tamanho = cnpj.length - 2\r\n        numeros = cnpj.substring(0, tamanho);\r\n        digitos = cnpj.substring(tamanho);\r\n        soma = 0;\r\n        pos = tamanho - 7;\r\n        for (i = tamanho; i >= 1; i--) {\r\n            soma += numeros.charAt(tamanho - i) * pos--;\r\n            if (pos < 2) {\r\n                pos = 9;\r\n            }\r\n        }\r\n        resultado = soma % 11 < 2 ? 0 : 11 - soma % 11;\r\n        if (resultado != digitos.charAt(0)) {\r\n            return false;\r\n        }\r\n        tamanho = tamanho + 1;\r\n        numeros = cnpj.substring(0, tamanho);\r\n        soma = 0;\r\n        pos = tamanho - 7;\r\n        for (i = tamanho; i >= 1; i--) {\r\n            soma += numeros.charAt(tamanho - i) * pos--;\r\n            if (pos < 2) {\r\n                pos = 9;\r\n            }\r\n        }\r\n        resultado = soma % 11 < 2 ? 0 : 11 - soma % 11;\r\n        if (resultado != digitos.charAt(1)) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    else {\r\n        return false;\r\n    }\r\n}\r\n\r\nfunction ApenasNumeros(campo) {\r\n\r\n    var tecla = (window.event) ? event.keyCode : e.which;\r\n    if ((tecla > 47 && tecla < 58)) return true;\r\n    else {\r\n        if (tecla == 8 || tecla == 0) return true;\r\n        else return false;\r\n    }\r\n\r\n    //if (document.all) // Internet Explorer\r\n    //    var tecla = event.keyCode;\r\n    //else if (document.layers) // Nestcape\r\n    //    var tecla = e.which;\r\n\r\n    //if ((tecla > 47 && tecla < 58)) // numeros de 0 a 9\r\n    //    return true;\r\n    //else {\r\n    //    if (tecla != 8) // backspace\r\n    //        //event.keyCode = 0;\r\n    //        return false;\r\n    //    else\r\n    //        return true;\r\n    //}\r\n    //$(campo).val($(campo).val().replace(/\\D/g,""));\r\n}\r\n\r\nfunction VerificaSeCheckadas() {\r\n\r\n    PreencheHidden(\'cmbDataFiltro\', \'hndDataFiltro\');\r\n    var estado = false;\r\n    var estado2 = true;\r\n    var totalModalidadesChecadas = 0;\r\n    var totalModalidadesNaoChecadas = 0;\r\n    var totalFinalidadesChecadas = 0;\r\n    $.each($(".modalidade input"), function () {\r\n        if ($(this).attr(\'checked\')) {\r\n            totalModalidadesChecadas++;\r\n            estado = true;\r\n        } else {\r\n            totalModalidadesNaoChecadas++;\r\n            estado2 = false\r\n        }\r\n    });\r\n    $.each($(".finalidade input"), function () {\r\n        if (!$(this).attr(\'checked\')) {\r\n            totalFinalidadesChecadas++;\r\n        }\r\n    });\r\n    if (totalModalidadesNaoChecadas != 0 || totalFinalidadesChecadas != 0)\r\n        $(\'#ckTipoModalidadeTodos\').attr(\'checked\', estado2 ? "checked" : "");\r\n    if (totalModalidadesChecadas != 0) {\r\n        // Selecionar todos as modalidades\r\n        $.each($(".finalidade input"), function () {\r\n            $(this).attr("disabled", estado ? "" : "disabled");\r\n        });\r\n    } else {\r\n        $.each($(".finalidade input"), function () {\r\n            $(this).attr("disabled", estado ? "" : "disabled");\r\n            $(this).attr(\'checked\', estado ? "checked" : "");\r\n        });\r\n    }\r\n    $.each($(".finalidade input"), function () {\r\n        if (!$(this).attr(\'checked\')) {\r\n            totalFinalidadesChecadas++;\r\n            estado = false;\r\n        }\r\n    });\r\n    $.each($(".modalidade input"), function () {\r\n        if ($(this).attr(\'checked\')) {\r\n            totalModalidadesChecadas++;\r\n            estado = false;\r\n        }\r\n    });\r\n    if (totalFinalidadesChecadas != 0 || totalModalidadesChecadas != 0)\r\n        $(\'#ckTipoModalidadeTodos\').attr(\'checked\', estado ? "checked" : "");\r\n}\r\n\r\nfunction PostForm() {\r\n    //Cookies para os dados do filtro\r\n    if ($("#cmbDataGP").val() != "") { createCookie("ckDataGP", $("#cmbDataGP").val(), 1) };\r\n    if ($("#cmbAnoGP").val() != "") { createCookie("ckAnoGP", $("#cmbAnoGP").val(), 1) };\r\n    if ($("#cmbAno").val() != "") { createCookie("ckAno", $("#cmbAno").val(), 1) };\r\n    if ($("#cmbExercicio").val() != "") { createCookie("ckExercicio", $("#cmbExercicio").val(), 1) };\r\n    if ($("#cmbUnidadeCP").val() != "") { createCookie("ckUnidadeCP", $("#cmbUnidadeCP").val(), 1) };\r\n    if ($("#cmbMesInicial").val() != "") { createCookie("ckMesInicial", $("#cmbMesInicial").val(), 1) };\r\n    if ($("#cmbMesFinal").val() != "") { createCookie("ckMesFinal", $("#cmbMesFinal").val(), 1) };\r\n    if ($("#cmbMesInicialGP").val() != "") { createCookie("ckMesInicialGP", $("#cmbMesInicialGP").val(), 1) };\r\n    if ($("#cmbMesFinalGP").val() != "") { createCookie("ckMesFinalGP", $("#cmbMesFinalGP").val(), 1) };\r\n    if ($("#txtDataInicial").val() != "") { createCookie("ckDataInicial", $("#txtDataInicial").val(), 1) };\r\n    if ($("#txtDataFinal").val() != "") { createCookie("ckDataFinal", $("#txtDataFinal").val(), 1) };\r\n    if ($("#txtDataInicialAR").val() != "") { createCookie("ckDataInicialAR", $("#txtDataInicialAR").val(), 1) };\r\n    if ($("#txtDataFinalAR").val() != "") { createCookie("ckDataFinalAR", $("#txtDataFinalAR").val(), 1) };\r\n    if ($("#cmbSituacaoDividaAtivaAR").val() != "") { createCookie("ckSituacaoDividaAtivaAR", $("#cmbSituacaoDividaAtivaAR").val(), 1) };\r\n    if ($("#txtNomeRazaoSocialInscritoDividaAtivaAR").val() != "") { createCookie("ckNomeRazaoSocialInscritoDividaAtivaAR", $("#txtNomeRazaoSocialInscritoDividaAtivaAR").val(), 1) };\r\n    if ($("#txtCPFCNPJInscritoDividaAtivaAR").val() != "") { createCookie("ckCPFCNPJInscritoDividaAtivaAR", $("#txtCPFCNPJInscritoDividaAtivaAR").val(), 1) };\r\n    if ($("#cmbUnidadeGestora").val() != "") { createCookie("ckUnidadeGestora", $("#cmbUnidadeGestora").val(), 1) };\r\n    if ($("#cmbApresentarPor").val() != "") { createCookie("ckApresentarPor", $("#cmbApresentarPor").val(), 1) };\r\n    if ($("#ckEmpenhoOrcamentario").val() != "") { createCookie("ckEmpenhoOrcamentario", $("#ckEmpenhoOrcamentario").val(), 1) };\r\n    if ($("#ckEmpenhoExtra").val() != "") { createCookie("ckEmpenhoExtra", $("#ckEmpenhoExtra").val(), 1) };\r\n    if ($("#ckEmpenhoResto").val() != "") { createCookie("ckEmpenhoResto", $("#ckEmpenhoResto").val(), 1) };\r\n    if ($("#cmbEstado").val() != "") { createCookie("ckEstado", $("#cmbEstado").val(), 1) };\r\n    if ($("#cmbMunicipio").val() != "") { createCookie("ckMunicipio", $("#cmbMunicipio").val(), 1) };\r\n    if ($("#cmbDataFiltro").val() != "") { createCookie("ckDataFiltro", $("#cmbDataFiltro").val(), 1) };\r\n    if ($("#cmbCategoria").val() != "") { createCookie("ckCategoria", $("#cmbCategoria").val(), 1) };\r\n    if ($("#cmbSitProcessoLicit").val() != "") { createCookie("ckSitProcessoLicit", $("#cmbSitProcessoLicit").val(), 1) };\r\n    if ($("#cmbDataVigenciaLC").val() != "") { createCookie("ckDataVigenciaLC", $("#cmbDataVigenciaLC").val(), 1) };\r\n    if ($("#cmbLeiLicitacoes").val() != "") { createCookie("ckLeiLicitacoes", $("#cmbLeiLicitacoes").val(), 1) };\r\n    if ($("#cmbLicitacaoCompartilhada").val() != "") { createCookie("ckLicitacaoCompartilhada", $("#cmbLicitacaoCompartilhada").val(), 1) };\r\n    if ($("#cmbModoExecucaoModalidade").val() != "") { createCookie("ckModoExecucaoModalidade", $("#cmbModoExecucaoModalidade").val(), 1) };\r\n    if ($("#cmbRegistroPrecos").val() != "") { createCookie("ckRegistroPrecos", $("#cmbRegistroPrecos").val(), 1) };\r\n    if ($("#cmbSituacaoEmergenciaLicitacoes").val() != "") { createCookie("ckSituacaoEmergenciaLicitacoes", $("#cmbSituacaoEmergenciaLicitacoes").val(), 1) };\r\n    if ($("#cmbSituacaoEmergenciaContratos").val() != "") { createCookie("ckSituacaoEmergenciaContratos", $("#cmbSituacaoEmergenciaContratos").val(), 1) };\r\n    if ($("#cmbSituacaoEmergenciaReceitasDespesas").val() != "") { createCookie("ckSituacaoEmergenciaReceitasDespesas", $("#cmbSituacaoEmergenciaReceitasDespesas").val(), 1) };\r\n    if ($("#cmbFonteRecursoCodigoAplicacaoAcaoGoverno").val() != "") { createCookie("ckFonteRecursoCodigoAplicacaoAcaoGoverno", $("#cmbFonteRecursoCodigoAplicacaoAcaoGoverno").val(), 1) };\r\n\r\n    //Estoque\r\n    if ($("#cmbEstoqueDataVigenciaLC").val() != "") { createCookie("ckEstoqueAno", $("#cmbEstoqueDataVigenciaLC").val(), 1) };\r\n    if ($("#cmbEstoqueUnidadeGestoraLC").val() != "") { createCookie("ckEstoqueUnidadeGestora", $("#cmbEstoqueUnidadeGestoraLC").val(), 1) };\r\n    if ($("#cmbEstoqueAlmoxarifado").val() != "") { createCookie("ckEstoqueAlmoxarifado", $("#cmbEstoqueAlmoxarifado").val(), 1) };\r\n    if ($("#txtEstoqueLocalizacao").val() != "") { createCookie("ckEstoqueLocalizacao", $("#txtEstoqueLocalizacao").val(), 1) };\r\n    if ($("#txtEstoqueMaterial").val() != "") { createCookie("ckEstoqueMaterial", $("#txtEstoqueMaterial").val(), 1) };\r\n    if ($("#cmbEstoqueMesInicial").val() != "") { createCookie("ckEstoqueDataInicial", $("#cmbEstoqueMesInicial").val(), 1) };\r\n    if ($("#cmbEstoqueMesFinal").val() != "") { createCookie("ckEstoqueDataFinal", $("#cmbEstoqueMesFinal").val(), 1) };\r\n    if ($("#txtEstoqueClassificacao").val() != "") { createCookie("ckEstoqueClassificacao", $("#txtEstoqueClassificacao").val(), 1) };\r\n\r\n    //Patrimonio\r\n    if ($("#cmbPatrimonioUnidadeGestoraLC").val() != "") { createCookie("ckPatrimonioUnidadeGestora", $("#cmbPatrimonioUnidadeGestoraLC").val(), 1) };\r\n    if ($("#txtPatrimonioDescricaoBem").val() != "") { createCookie("ckPatrimonioDescricaoBem", $("#txtPatrimonioDescricaoBem").val(), 1) };\r\n    if ($("#txtPatrimonioDataInicial").val() != "") { createCookie("ckPatrimonioDataInicial", $("#txtPatrimonioDataInicial").val(), 1) };\r\n    if ($("#txtPatrimonioDataFinal").val() != "") { createCookie("ckPatrimonioDataFinal", $("#txtPatrimonioDataFinal").val(), 1) };\r\n    if ($("#txtPatrimonioClassificacao").val() != "") { createCookie("ckPatrimonioClassificacao", $("#txtPatrimonioClassificacao").val(), 1) };\r\n    if ($("#txtPatrimonioLocalizacao").val() != "") { createCookie("ckPatrimonioLocalizacao", $("#txtPatrimonioLocalizacao").val(), 1) };\r\n    if ($("#cmbPatrimonioSituacaoBem").val() != "") { createCookie("ckPatrimonioSituacaoBem", $("#cmbPatrimonioSituacaoBem").val(), 1) };\r\n    if ($("#cmbPatrimonioStatus").val() != "") { createCookie("ckPatrimonioStatus", $("#cmbPatrimonioStatus").val(), 1) };\r\n\r\n    //Frotas\r\n    if ($("#cmbFrotasUnidadeGestora").val() != "") { createCookie("ckFrotasUnidadeGestora", $("#cmbFrotasUnidadeGestora").val(), 1) };\r\n    if ($("#cmbFrotasTipoVeiculo").val() != "") { createCookie("ckFrotasTipoVeiculo", $("#cmbFrotasTipoVeiculo").val(), 1) };\r\n    if ($("#txtFrotasDescricao").val() != "") { createCookie("ckFrotasDescricao", $("#txtFrotasDescricao").val(), 1) };\r\n    if ($("#txtFrotasDataInicial").val() != "") { createCookie("ckFrotasDataInicial", $("#txtFrotasDataInicial").val(), 1) };\r\n    if ($("#txtFrotasDataFinal").val() != "") { createCookie("ckFrotasDataFinal", $("#txtFrotasDataFinal").val(), 1) };\r\n    if ($("#txtFrotasLocalizacao").val() != "") { createCookie("ckFrotasLocalizacao", $("#txtFrotasLocalizacao").val(), 1) };\r\n    if ($("#txtFrotasPlaca").val() != "") { createCookie("ckFrotasPlaca", $("#txtFrotasPlaca").val(), 1) };\r\n    if ($("#txtFrotasAnoFabricacao").val() != "") { createCookie("ckFrotasAnoFabricacao", $("#txtFrotasAnoFabricacao").val(), 1) };\r\n    if ($("#cmbFrotasSituacaoVeiculo").val() != "") { createCookie("ckFrotaSituacaoVeiculo", $("#cmbFrotasSituacaoVeiculo").val(), 1) };\r\n\r\n\r\n    document.getElementById("mensagemReferencia").style.display = "none";\r\n\r\n    //Ug LC\r\n    if ($("#cmbUnidadeGestoraLC").val() != "") { createCookie("ckUnidadeGestoraLC", $("#cmbUnidadeGestoraLC").val(), 1) };\r\n\r\n    //Cookies para os dados do filtro\r\n    //Hidden para tela do Filtro Utilizado\r\n    PreencheHidden(\'cmbAno\', \'hndAno\');\r\n    PreencheHidden(\'cmbExercicio\', \'hndExercicio\');\r\n    PreencheHidden(\'cmbUnidadeGestora\', \'hndUnidadeGestora\');\r\n    PreencheHidden(\'cmbDiariasPassagens\', \'hndDiariasPassagens\');\r\n    PreencheHidden(\'cmbCategoria\', \'hndCategoria\');\r\n    PreencheHidden(\'cmbMesInicial\', \'hndMesInicial\');\r\n    PreencheHidden(\'cmbMesFinal\', \'hndMesFinal\');\r\n    PreencheHidden(\'cmbUnidadeCP\', \'hndUnidadeCP\');\r\n    PreencheHidden(\'cmbUnidadeGestoraLC\', \'hndUnidadeGestoraLC\');\r\n\r\n    PreencheHidden(\'cmbOrgaoLC\', \'hndOrgaoLC\');\r\n\r\n    PreencheHidden(\'cmbSitProcessoLicit\', \'hndSitProcessoLicit\');\r\n    PreencheHidden(\'cmbDataVigenciaLC\', \'hndDataVigenciaLC\');\r\n    PreencheHidden(\'cmbLeiLicitacoes\', \'hndLeiLicitacoes\');\r\n    PreencheHidden(\'cmbLicitacaoCompartilhada\', \'hndLicitacaoCompartilhada\');\r\n    PreencheHidden(\'cmbModoExecucaoModalidade\', \'hndModoExecucaoModalidade\');\r\n    PreencheHidden(\'cmbRegistroPrecos\', \'hndRegistroPrecos\');\r\n    PreencheHidden(\'cmbSituacaoEmergenciaLicitacoes\', \'hndSituacaoEmergenciaLicitacoes\');\r\n    PreencheHidden(\'cmbSituacaoEmergenciaContratos\', \'hndSituacaoEmergenciaContratos\');\r\n    PreencheHidden(\'cmbSituacaoEmergenciaReceitasDespesas\', \'hndSituacaoEmergenciaReceitasDespesas\');\r\n    PreencheHidden(\'cmbFonteRecursoCodigoAplicacaoAcaoGoverno\', \'hndFonteRecursoCodigoAplicacaoAcaoGoverno\');\r\n\r\n    PreencheHidden(\'cmbFuncao\', \'hndFuncao\');\r\n    //AR\r\n    PreencheHidden(\'cmbUnidadeGestoraAR\', \'hndUnidadeGestoraAR\');\r\n    PreencheHidden(\'cmbSituacaoDividaAtivaAR\', \'hndSituacaoDividaAtivaAR\');\r\n    //GP\r\n    PreencheHidden(\'cmbVinculoGP\', \'hndVinculoGP\');\r\n    PreencheHidden(\'cmbUnidadeGP\', \'hndUnidadeGP\');\r\n    PreencheHidden(\'cmbAnoGP\', \'hndAnoGP\');\r\n    PreencheHidden(\'cmbMesInicialGP\', \'hndMesInicialGP\');\r\n    PreencheHidden(\'cmbMesFinalGP\', \'hndMesFinalGP\');\r\n    PreencheHidden(\'cmbDiariasPassagens\', \'hndDiariasPassagens\');\r\n    PreencheHidden(\'cmbTipoTransferencia\', \'hndTipoTransferencia\');\r\n    PreencheHidden(\'cmbOrigemRecurso\', \'hndOrigemRecurso\');\r\n    //Estoque\r\n    PreencheHidden(\'cmbEstoqueDataVigenciaLC\', \'hndEstoqueDataVigenciaLC\');\r\n    PreencheHidden(\'cmbEstoqueUnidadeGestoraLC\', \'hndEstoqueUnidadeGestoraLC\');\r\n    PreencheHidden(\'cmbEstoqueAlmoxarifado\', \'hndEstoqueAlmoxarifado\');\r\n    PreencheHidden(\'cmbEstoqueMesInicial\', \'hndEstoqueMesInicial\');\r\n    PreencheHidden(\'cmbEstoqueMesFinal\', \'hndEstoqueMesFinal\');\r\n    PreencheHidden(\'cmbEstoqueTipoMovimento\', \'hndEstoqueTipoMovimento\');\r\n\r\n    //Patrimonio\r\n    PreencheHidden(\'cmbPatrimonioUnidadeGestoraLC\', \'hndPatrimonioUnidadeGestoraLC\');\r\n    PreencheHidden(\'cmbPatrimonioSituacaoBem\', \'hndPatrimonioSituacaoBem\');\r\n    PreencheHidden(\'cmbPatrimonioStatus\', \'hndPatrimonioStatus\');\r\n    PreencheHidden(\'cmbPatrimonioTipoIngresso\', \'hndPatrimonioTipoIngresso\');\r\n\r\n    //Frotas\r\n    PreencheHidden(\'cmbFrotasUnidadeGestora\', \'hndFrotasUnidadeGestora\');\r\n    PreencheHidden(\'cmbFrotasTipoVeiculo\', \'hndFrotasTipoVeiculo\');\r\n    PreencheHidden(\'cmbFrotasSituacaoVeiculo\', \'hndFrotasSituacaoVeiculo\');\r\n\r\n\r\n    if (($("#hndAcao").val() == 3) && ($("#hndItem").val() == 7)) {\r\n        PreencheHidden(\'cmbApresentarPor\', \'hndApresentarPorCP\');\r\n    }\r\n    if ($("#hndAcao").val() == 1) {\r\n        switch ($("#hndItem").val()) {\r\n            //---------jds 22-07-2020\r\n            case "91": // Licita\xe7\xf5es Calamidade Publica\r\n                {\r\n                    VerificaSeCheckadas();\r\n                } break;\r\n            case "2":\r\n                {\r\n                    VerificaSeCheckadas();\r\n                } break;\r\n            //=================================\r\n            case "3":\r\n                {\r\n                    PreencheHidden(\'cmbEstado\', \'hndEstado\');\r\n                    PreencheHidden(\'cmbMunicipio\', \'hndMunicipio\');\r\n                } break;\r\n        }\r\n    }\r\n\r\n    //Servidores Ativos/Inativo/Quadro de Pessoal\r\n\r\n    if (($("#hndAcao").val() == 4) && ($("#hndItem").val() == 2) || ($("#hndAcao").val() == 4) && ($("#hndItem").val() == 3) || ($("#hndAcao").val() == 4) && ($("#hndItem").val() == 4)) {\r\n        PreencheHidden(\'hndApresentar\', \'hndApresentarPorGP\');\r\n    }\r\n    else {\r\n        PreencheHidden(\'ckTipoGestaoPessoas\', \'hndApresentarPorGP\');\r\n    }\r\n\r\n    //Hidden para tela do Filtro Utilizado\r\n    //Limpar vari\xe1veis da sess\xe3o\r\n    if ($("#hndAcao").val() != 10) {\r\n        $.ajax({\r\n            type: "POST",\r\n            url: "acao.asp?acao=LimparHistoricos",\r\n            data: "",\r\n            async: false,\r\n            cache: false,\r\n            error: function (jerro) {\r\n                alert(jerro.responseText);\r\n            }\r\n        });\r\n    }\r\n    //Limpar vari\xe1veis da sess\xe3o\r\n\r\n    document.getElementById(\'hndvisao\').value = 1;\r\n}\r\n\r\nfunction consultaHistoricoLances() {\r\n    $.ajax({\r\n        type: "GET",\r\n        url: "acao.asp?acao=RetornaConsultaHistoricoLances",\r\n        dataType: "json",\r\n        success: function (jdados) {\r\n\r\n        },\r\n\r\n        error: function (jerro) {\r\n            alert(jerro.responseText + "Erro ao consultar hist\xf3rico de lances!");\r\n        }\r\n    });\r\n\r\n}\r\n\r\nfunction validaProdutosInstalados() {\r\n    $("#AtalhosAdm").css("display", "none");\r\n    $("#amdEstoque").css("display", "none");\r\n    $("#admPatrimonio").css("display", "none");\r\n    $("#admFrotas").css("display", "none");\r\n    $(".admAG").css("display", "none");\r\n    $("#AtalhosReceitas").css("display", "none");\r\n    $("#AtalhosDespesas").css("display", "none");\r\n    $("#AtalhosTransf").css("display", "none");\r\n    $("#AtalhosTransfVolun").css("display", "none");\r\n    $("#AtalhosCredores").css("display", "none");\r\n    $("#AtalhosGP").css("display", "none");\r\n\r\n    $.ajax({\r\n        type: "GET",\r\n        url: "acao.asp?acao=RetornaProdutosTB",\r\n        dataType: "json",\r\n        success: function (jdados) {\r\n            var htm = "";\r\n            for (var i = 0; i < jdados.length; i++) {\r\n                var objResult = jdados[i];\r\n                if (objResult.TipoProduto == \'AG\') {\r\n                    $(".admAG").css("display", "block");\r\n                    $(".admAG").removeAttr("style");\r\n                    $("#AtalhosAdm").css("display", "block");\r\n                    $("#AtalhosAdm").removeAttr("style");\r\n                }\r\n                if (objResult.TipoProduto == \'CM\') {\r\n                    $("#amdEstoque").css("display", "block");\r\n                    $("#amdEstoque").removeAttr("style");\r\n                    $("#AtalhosAdm").css("display", "block");\r\n                    $("#AtalhosAdm").removeAttr("style");\r\n                }\r\n                if (objResult.TipoProduto == \'PP\') {\r\n                    $("#admPatrimonio").css("display", "block");\r\n                    $("#admPatrimonio").removeAttr("style");\r\n                    $("#AtalhosAdm").css("display", "block");\r\n                    $("#AtalhosAdm").removeAttr("style");\r\n                }\r\n                if (objResult.TipoProduto == \'AF\') {\r\n                    $("#admFrotas").css("display", "block");\r\n                    $("#admFrotas").removeAttr("style");\r\n                    $("#AtalhosAdm").css("display", "block");\r\n                    $("#AtalhosAdm").removeAttr("style");\r\n                }\r\n                if (objResult.TipoProduto == \'FA\') {\r\n                    $("#AtalhosReceitas").css("display", "block");\r\n                    $("#AtalhosReceitas").removeAttr("style");\r\n                }\r\n                if (objResult.TipoProduto == \'FC\') {\r\n                    $("#AtalhosCredores").css("display", "block");\r\n                    $("#AtalhosCredores").removeAttr("style");\r\n                }\r\n                if (objResult.TipoProduto == \'FR\') {\r\n                    $("#AtalhosReceitas").css("display", "block");\r\n                    $("#AtalhosReceitas").removeAttr("style");\r\n                }\r\n                if (objResult.TipoProduto == \'FD\') {\r\n                    $("#AtalhosDespesas").css("display", "block");\r\n                    $("#AtalhosDespesas").removeAttr("style");\r\n                }\r\n                if (objResult.TipoProduto == \'TV\') {\r\n                    $("#AtalhosTransfVolun").css("display", "block");\r\n                    $("#AtalhosTransfVolun").removeAttr("style");\r\n                }\r\n                if (objResult.TipoProduto == \'TF\') {\r\n                    $("#AtalhosTransf").css("display", "block");\r\n                    $("#AtalhosTransf").removeAttr("style");\r\n                }\r\n                if (objResult.TipoProduto == \'GP\') {\r\n                    $("#AtalhosGP").css("display", "block");\r\n                    $("#AtalhosGP").removeAttr("style");\r\n                }\r\n            }\r\n        },\r\n\r\n        error: function (jerro) {\r\n            alert(jerro.responseText + "Erro ao receber o arquivo!");\r\n        }\r\n    });\r\n\r\n}\r\n// jds 22-07-2020\r\nfunction ValidaContrato() {\r\n\r\n    if (($("#txtValorContratoInicial").val() != "" && $("#txtValorContratoFinal").val() != "") &&\r\n        ($("#txtValorContratoInicial").val().replace(".", "") > $("#txtValorContratoFinal").val().replace(".", ""))) {\r\n        if (msgErro != "") { msgErro += "\\n\\n"; }\r\n        msgErro += "O Valor do Contrato possui um intervalo inv\xe1lido."\r\n    }\r\n    if ($("#txtAnoContrato").val() != "" || $("#txtNumeroContrato").val() != "") {\r\n        if ($("#txtAnoContrato").val() == "") {\r\n            if (msgErro != "") { msgErro += "\\n\\n"; }\r\n            msgErro += "Favor preencher o Ano do contrato."\r\n        }\r\n        if ($("#txtNumeroContrato").val() == "") {\r\n            if (msgErro != "") { msgErro += "\\n\\n"; }\r\n            msgErro += "Favor preencher o N\xfamero do contrato."\r\n        }\r\n    }\r\n\r\n    if (msgErro == "") {\r\n        //Tipo Contrato\r\n        var totalTipoContratoChecadas = 0;\r\n        $.each($(".TipoContrato input"), function () {\r\n            if ($(this).attr(\'checked\')) {\r\n                totalTipoContratoChecadas++;\r\n            }\r\n        });\r\n        if (totalTipoContratoChecadas == 0) {\r\n            $.each($(".TipoContrato input"), function () {\r\n                $(this).attr(\'checked\', true)\r\n            });\r\n        };\r\n        //Instrumento Contratual\r\n        var totalInstContratualChecadas = 0;\r\n        $.each($(".instrumentoContratual input"), function () {\r\n            if ($(this).attr(\'checked\')) {\r\n                totalInstContratualChecadas++;\r\n            }\r\n        });\r\n        if (totalInstContratualChecadas == 0) {\r\n            $.each($(".instrumentoContratual input"), function () {\r\n                $(this).attr(\'checked\', true)\r\n            });\r\n        };\r\n        //Contrato Com\r\n        var totalAditivosChecadas = 0;\r\n        if ($(\'#ckContrato\').attr(\'checked\')) {\r\n            $(\'.contratos\').css(\'display\', \'none\');\r\n            $.each($(".contratosCom input"), function () {\r\n                if ($(this).attr(\'checked\')) {\r\n                    totalAditivosChecadas++;\r\n                }\r\n            });\r\n            if (totalAditivosChecadas == 0) {\r\n                $.each($(".contratosCom input"), function () {\r\n                    $(this).attr(\'checked\', true)\r\n                });\r\n            };\r\n        }\r\n    }\r\n}\r\nfunction ValidaProcesso() {\r\n\r\n    //checked todas as finalidades caso n\xe3o exista alguma selecionada\r\n    var totalModalidadesChecadas = 0;\r\n    $.each($(".modalidade input"), function () {\r\n        if ($(this).attr(\'checked\')) {\r\n            totalModalidadesChecadas++;\r\n        }\r\n    });\r\n    if (totalModalidadesChecadas == 0) {\r\n        $.each($(".modalidade input"), function () {\r\n            $(this).attr("disabled", "");\r\n            $(this).attr(\'checked\', true)\r\n        });\r\n    };\r\n    var totalFinalidadesChecadas = 0;\r\n    $.each($(".finalidade input"), function () {\r\n        if ($(this).attr(\'checked\')) {\r\n            totalFinalidadesChecadas++;\r\n        }\r\n    });\r\n    if (totalFinalidadesChecadas == 0) {\r\n        $.each($(".finalidade input"), function () {\r\n            $(this).attr("disabled", "");\r\n            $(this).attr(\'checked\', true)\r\n        });\r\n    };\r\n}\r\nfunction AlgumCheckSelecionado(classOrID) {\r\n\r\n    var resultado = false;\r\n\r\n    jQuery.each($(classOrID + " > input:checkbox"), function () {\r\n\r\n        if ($(this).is(\':checked\'))\r\n            resultado = true;\r\n    });\r\n\r\n    return resultado;\r\n\r\n}\r\n\r\n//---------------------\r\nfunction ValidaForm() {\r\n\r\n    msgErro = "";\r\n\r\n    if ($("#cmbOrgaoLC").val() == "") {\r\n        ($("#cmbOrgaoLC").val(-1))\r\n    }\r\n\r\n    if ($("#cmbFuncao").val() == "") {\r\n        ($("#cmbFuncao").val(-1))\r\n    }\r\n\r\n    if ($("#hndAcao").val() == 10) {\r\n\r\n        if ($("#hndItem").val() == 1) {\r\n\r\n            if ($("#cmbUnidadeGestoraLC").val() == "") {\r\n                ($("#cmbUnidadeGestoraLC").val(-1))\r\n            }\r\n        }\r\n\r\n\r\n\r\n        if ($("#hndItem").val() >= 4 && $("#hndItem").val() <= 7) //Despesas\r\n        {\r\n            if ($("#cmbUnidadeGestora").val() == "" && ($("#cmbUnidadeGestora").val() == "" && $("#cmbUnidadeCP").val() == "")) {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro += "Favor informar o campo Unidade Gestora!";\r\n            }\r\n            if ($("#cmbDiariasPassagens").val() == "" && $("#cmbDiariasPassagens").css("display") == "none") {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro += "Favor informar o Tipo de Despesa!";\r\n            }\r\n        }\r\n\r\n        //\'DRO - 382156 - 18/02/2018 - Inicio\r\n        if ($("#hndItem").val() >= 8 && $("#hndItem").val() <= 10) { //Exporta\xe7\xe3o GP\r\n            if ($("#cmbExercicio").attr(\'selectedIndex\') == 0 && $("#cmbMesInicial").val() == \'\') {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro = validaDataInicialFinal("txtDataInicial", "txtDataFinal", true);\r\n            }\r\n            else {\r\n                if ($("#cmbMesInicial").val() == "" || $("#cmbMesFinal").val() == "") {\r\n                    if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                    msgErro += "Favor informar o campo Per\xedodo!";\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            //\'DRO - 382156 - 18/02/2018 - Fim\r\n\r\n            //Valida\xe7\xe3o para todas as telas do CP e Exporta\xe7\xe3o\r\n            if ($("#hndItem").val() != 1) {\r\n\r\n                if ($("#txtDataInicial").val() != "" || $("#txtDataFinal").val() != "") {\r\n                    msgErro = validaDataInicialFinal("txtDataInicial", "txtDataFinal", true);\r\n                }\r\n                else {\r\n                    if ($("#cmbMesInicial").val() == null && $("#cmbMesFinal").val() == null) {\r\n                        if (msgErro != "") {\r\n                            msgErro += "\\n\\n";\r\n                        }\r\n                        msgErro += "Favor informar o campo Per\xedodo!";\r\n                    }\r\n\r\n                }\r\n                //\'DRO - 353774 - 27/10/2018 - Fim\r\n            }\r\n            //\'DRO - 382156 - 18/02/2018 - Inicio\r\n        }\r\n        //\'DRO - 382156 - 18/02/2018 - Fim\r\n\r\n        // Valida Dados para a exporta\xe7\xe3o\r\n        if ($("#hndItem").val() == 1) {\r\n            if ($("#cmbUnidadeLC").val() == "") {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro += "Favor informar o campo Entidade!";\r\n            }\r\n            if ($("#cmbUnidadeGestoraLC").val() == "" && ($("#cmbUnidadeGestoraLC").val() == "" && $("#cmbUnidadeGestoraLC").val() == "")) {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro += "Favor informar o campo Unidade Gestora!";\r\n            }\r\n\r\n            if ($("#txtDataInicial").val() == "" || $("#txtDataInicial").val() == "") {\r\n                if ($(\'#cmbTipoEsportacaoDados\').find(\'option:selected\').val() == "6") { // igual a estoque\r\n                    if ($("#cmbMesInicial").val() == 0 || $("#cmbMesFinal").val() == 0) {\r\n                        if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                        msgErro += "Favor informar o campo Per\xedodo!";\r\n                    }\r\n                }\r\n            }\r\n\r\n            if ($(\'#cmbTipoEsportacaoDados\').find(\'option:selected\').val() != "7" && $(\'#cmbTipoEsportacaoDados\').find(\'option:selected\').val() != "8") {\r\n                if ($("#cmbExercicio").val() == "") {\r\n                    if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                    msgErro += "Favor informar o Ano da Vig\xeancia!";\r\n                }\r\n            } else {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro = validaDataInicialFinal("txtDataInicial", "txtDataFinal", true, false);\r\n            }\r\n        }\r\n\r\n\r\n    } else {\r\n        if ($("#txtDataInicial").val() != "" || $("#txtDataFinal").val() != "") {\r\n            if (!validaData("#txtDataInicial", true)) {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro += "Data Inicial inv\xe1lida.";\r\n            }\r\n            if (!validaData("#txtDataFinal", true)) {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro += "Data Final inv\xe1lida.";\r\n            }\r\n        }\r\n    }\r\n\r\n    //Valida\xe7\xe3o para as telas do AR\r\n    if ($("#hndAcao").val() == 2 && $("#hndItem").val() == 1 || $("#hndItem").val() == 2) {\r\n\r\n        if ($("#txtDataInicialAR").val() == "" || $("#txtDataFinalAR").val() == "") {\r\n            if ($("#txtDataInicialAR").is(":visible") || $("#txtDataFinalAR").is(":visible")) {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro += "Favor informar o campo Per\xedodo!";\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    // 1 - Arrecada\xe7\xe3o\r\n    if ($("#hndAcao").val() == 2) {\r\n        if ($("#hndItem").val() == 2 || $("#hndItem").val() == 1) //Receitas\r\n        {\r\n            if ($("#cmbAno").val() == "") {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro += "Favor informar o campo Ano!";\r\n            }\r\n\r\n        }\r\n    }\r\n    // 3-Financeiro, Credores\r\n    if ($("#hndAcao").val() == 3) {\r\n        //Valida\xe7\xe3o para todas as telas do CP\r\n        if ($("#cmbUnidadeCP").val() == "") {\r\n            if (msgErro != "") { msgErro += "\\n\\n"; }\r\n            msgErro += "Favor informar o campo Entidade!";\r\n        }\r\n\r\n        if ($("#hndItem").val() == 14 || $("#hndItem").val() == 20 || $("#hndItem").val() == 21) { // Transfer\xeancia Financeira\r\n            if (($("#cmbMesInicial").val() == "" || $("#cmbMesFinal").val() == "") || ($("#cmbMesInicial").val() == null || $("#cmbMesFinal").val() == null)) {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro += "Favor informar o campo Per\xedodo!";\r\n            }\r\n        }\r\n\r\n        if ($("#hndItem").val() == 11 || $("#hndItem").val() == 1 || $("#hndItem").val() == 3 || $("#hndItem").val() == 4 || $("#hndItem").val() == 7 || $("#hndItem").val() == 12 || $("#hndItem").val() == 8 || $("#hndItem").val() == 13 || $("#hndItem").val() == 15 || $("#hndItem").val() == 16 || $("#hndItem").val() == 17 || $("#hndItem").val() == 18 || $("#hndItem").val() == 19 || $("#hndItem").val() == 92)  //Receitas, Despesas Diarias, Empenhos a Pagar e Despesas Diarias Covid-19\r\n        {\r\n            if ($("#hndItem").val() != 13 && $("#hndItem").val() != 16 && $("#hndItem").val() != 17 && $("#hndItem").val() != 18 && $("#hndItem").val() != 19) {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro += validaDataInicialFinal("txtDataInicial", "txtDataFinal", true);\r\n            }\r\n\r\n            if ($("#hndItem").val() == 16) { // Transfer\xeancia Volunt\xe1ria Concedida\r\n                if ($("#cmbMesInicial").val() == "" || $("#cmbMesFinal").val() == "") {\r\n                    if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                    msgErro += "Favor informar o campo Per\xedodo!";\r\n                }\r\n                if ($("#cmbUnidadeGestora").val() == "") {\r\n                    if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                    msgErro += "Favor informar o campo Unidade Gestora!";\r\n                }\r\n            }\r\n\r\n            if ($("#hndItem").val() == 17) { // Transfer\xeancia Volunt\xe1ria Recebida\r\n                if ($("#cmbMesInicial").val() == "" || $("#cmbMesFinal").val() == "") {\r\n                    if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                    msgErro += "Favor informar o campo Per\xedodo!";\r\n                }\r\n                if ($("#cmbUnidadeGestora").val() == "") {\r\n                    if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                    msgErro += "Favor informar o campo Unidade Gestora!";\r\n                }\r\n            }\r\n\r\n            if ($("#hndItem").val() == 13) //Empenhos a Pagar\r\n            {\r\n                if ($("#cmbUnidadeGestora").val() == "") {\r\n                    if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                    // msgErro += "Favor informar o campo Unidade Gestora!";\r\n                }\r\n            }\r\n\r\n            if ($("#hndItem").val() == 19) {\r\n                if ($("#cmbUnidadeGestora").val() == "") {\r\n                    if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                    // msgErro += "Favor informar o campo Unidade Gestora!";\r\n                }\r\n            }\r\n            //Despesa Diaria - Covid-19 (Item  = 92)\r\n            if ($("#hndItem").val() == 11 || $("#hndItem").val() == 15 || $("#hndItem").val() == 92) //Despesa Diaria\r\n            {\r\n                if (!$("#ckEmpenhoOrcamentario").is(":checked") &&\r\n                    !$("#ckEmpenhoExtra").is(":checked") &&\r\n                    !$("#ckEmpenhoResto").is(":checked")) {\r\n                    if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                    msgErro += "Favor selecionar um Tipo de Empenho.";\r\n                }\r\n                if ($("#hndItem").val() == 15) {\r\n                    if ($("#cmbMesInicial").val() == "" || $("#cmbMesFinal").val() == "") {\r\n                        if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                        msgErro += "Favor informar o campo Per\xedodo!";\r\n                    }\r\n                    if ($("#cmbUnidadeGestora").val() == "") {\r\n                        if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                        msgErro += "Favor informar o campo Unidade Gestora!";\r\n                    }\r\n                }\r\n                if ($("#txtCPFCNPJFornecedor").val() != "") {\r\n                    var auxCPFCNPJ = $("#txtCPFCNPJFornecedor").val();\r\n                    auxCPFCNPJ = replaceAll(auxCPFCNPJ, ".", "");\r\n                    auxCPFCNPJ = replaceAll(auxCPFCNPJ, "-", "");\r\n                    auxCPFCNPJ = replaceAll(auxCPFCNPJ, "/", "");\r\n                    if (auxCPFCNPJ.length < 12) {\r\n                        if (!validaCPF(auxCPFCNPJ)) {\r\n                            if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                            msgErro += "CPF inv\xe1lido!";\r\n                        }\r\n                    }\r\n                    else {\r\n                        if (!validaCNPJ(auxCPFCNPJ)) {\r\n                            if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                            msgErro += "CNPJ inv\xe1lido!";\r\n                        }\r\n                    }\r\n                }\r\n                //Valida\xe7\xe3o de Diarias/passagens\r\n                if ($("#hndItem").val() == 15) //Despesa Diaria\r\n                {\r\n\r\n                    if ($("#cmbDiariasPassagens").val() == "") {\r\n                        if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                        msgErro += "Favor informar o Tipo de Despesa!";\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            if ($("#cmbReceitas").val() != "LAN\xc7AMENTO DAS RECEITAS") {\r\n                if ($("#cmbMesInicial").val() == "" || $("#cmbMesFinal").val() == "") {\r\n                    if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                    msgErro += "Favor informar o campo Per\xedodo!";\r\n                }\r\n            }\r\n            //Financeiro | Itens:A\xe7\xe3o, Categoria, Programa, Classifica\xe7\xe3o institucional, Esfera, Fonte categoria e funcional\r\n            if ($("#cmbReceitas").val() != "LAN\xc7AMENTO DAS RECEITAS") {\r\n                if ($("#hndItem").val() == 1 || $("#hndItem").val() == 2 || $("#hndItem").val() == 3 || $("#hndItem").val() == 4 || $("#hndItem").val() == 5 || $("#hndItem").val() == 6 || $("#hndItem").val() == 7 || $("#hndItem").val() == 8 || $("#hndItem").val() == 9 || $("#hndItem").val() == 10) {\r\n                    if ($("#cmbUnidadeGestora").val() == "") {\r\n                        if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                        msgErro += "Favor informar o campo Unidade Gestora!";\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Valida\xe7\xe3o Tela de Publica\xe7\xf5es //\r\n\r\n    if ($("#hndAcao").val() == 21) {\r\n\r\n        if ($("#txtReferenciaAtePublicacoes").val() != "" && $("#txtReferenciaDePublicacoes").val() == "") {\r\n            if (msgErro != "") { msgErro += "\\n\\n"; }\r\n            msgErro += "Favor preencher a data in\xedcial!"\r\n        }\r\n\r\n        if ($("#cmbPeriodoPublicacao").val() != 0) {\r\n            if ($("#cmbReferenciaDePublicacoes").val() == 0) {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro += "Informe a refer\xeancia!"\r\n            }\r\n        }\r\n\r\n        if ($("#hndItem").val() != 6) {\r\n            if ($("#cmbTemaPublicacoes").val() == "" ||\r\n                $("#cmbTemaPublicacoes").val() == "SELECIONE")\r\n            {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro += "Favor informar o Tema!";\r\n            }\r\n        }\r\n\r\n        var destino = $("#txtAreaDoTema");\r\n\r\n        /*if (destino.val() === \'0\') */\r\n        if ($("#txtAreaDoTema").val() == \'0\') {\r\n\r\n            $("#cmbAnoCargasPublicacoes").attr("disabled", true);\r\n            if ($("#txtReferenciaDePublicacoes").val() == \'0\' ||\r\n                $("#txtReferenciaAtePublicacoes").val() == \'0\') {\r\n                msgErro += "Favor informar per\xedodo da Refer\xeancia Inicial e Final!";\r\n            } else if ($("#txtReferenciaDePublicacoes").val() != \'0\') {\r\n                if ($("#txtReferenciaDePublicacoes").val().substring(6, 10) !=\r\n                    $("#txtReferenciaAtePublicacoes").val().substring(6, 10)) {\r\n                    msgErro += "Ano de Refer\xeancia Inicial e/ou Final inv\xe1lidos. O intervalo tem que est\xe1 no mesmo Ano!";\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            $("#cmbAnoCargasPublicacoes").attr("disabled", false);\r\n\r\n            if ($("#cmbAnoCargasPublicacoes").val() == "" ||\r\n                $("#cmbAnoCargasPublicacoes").val() == "SELECIONE") {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro += "Favor informar o Ano de Vig\xeancia!";\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    if ($("#hndAcao").val() == 4) {\r\n        if ($("#hndItem").val() == 3) {\r\n            if ($("#cmbVinculoGP").val() == "") {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro += "Favor selecionar o Tipo de V\xednculo!"\r\n            }\r\n        }\r\n        if ($("#hndItem").val() == 3 || $("#hndItem").val() == 7) {\r\n            if ($("#cmbMesInicialGP").val() == "0") {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro += "Favor informar o campo per\xedodo inicial."\r\n            }\r\n            if ($("#cmbMesFinalGP").val() == "0") {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro += "Favor informar o campo per\xedodo final."\r\n            }\r\n            if ($("#cmbMesInicialGP").val() != "0" && $("#cmbMesFinalGP").val() != "0") {\r\n                if (parseInt($("#cmbMesInicialGP").val()) > parseInt($("#cmbMesFinalGP").val())) {\r\n                    if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                    msgErro += "Per\xedodo inicial n\xe3o pode ser maior que per\xedodo final."\r\n                }\r\n            }\r\n            if ($("#cmbAnoGP").val() == "0") {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro += "Favor informar o campo ano."\r\n            }\r\n        } else if ($("#cmbDataGP").val() == null || $("#cmbDataGP").val() == "") {\r\n            if (msgErro != "") { msgErro += "\\n\\n"; }\r\n            msgErro += "Favor selecionar a Data!"\r\n        }\r\n        if ($("#hndItem").val() == 1) {\r\n            if ($("#ckTipoGestaoPessoas").val() == -1 && $("#ApresentarPorLotacaoCargos").css("display") != "none") {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro += "Favor selecionar a op\xe7\xe3o em: Apresentar Por!"\r\n            }\r\n        }\r\n    }\r\n\r\n    if ($("#hndAcao").val() == 1) //ADM\r\n    {\r\n        if (msgErro != "") { msgErro += "\\n\\n"; }\r\n        msgErro += validaDataInicialFinal("txtDataInicial", "txtDataFinal", false);\r\n\r\n\r\n        // Valida Calamidade \r\n        if ($("#hndItem").val() == 90 || $("#hndItem").val() == 91) {\r\n            if (msgErro != "") { msgErro += "\\n\\n"; }\r\n            msgErro += validaEntidadeCalamidade($("#cmbUnidadeLC").val());\r\n        }\r\n        if ($("#hndItem").val() == 92 || $("#hndItem").val() == 93 || $("#hndItem").val() == 94 || $("#hndItem").val() == 95 || $("#hndItem").val() == 97) {\r\n            if (msgErro != "") { msgErro += "\\n\\n"; }\r\n            msgErro += validaEntidadeCalamidade($("#cmbUnidadeCP").val());\r\n        }\r\n        if ($("#hndItem").val() == 96) {\r\n            if (msgErro != "") { msgErro += "\\n\\n"; }\r\n            msgErro += validaEntidadeCalamidade($("#cmbPatrimonioUnidadePP").val());\r\n        }\r\n\r\n        //Estoque = Item 5\r\n        //Validar Ano de Vigencia\r\n        if ($("#hndItem").val() != 5 && $("#hndItem").val() != 6 && $("#hndItem").val() != 7) {\r\n            //entidade\r\n            if ($("#cmbUnidadeLC").val() == "") {\r\n                if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                msgErro += "Favor informar a Entidade!";\r\n            }\r\n            //contrato\r\n            if ($("#hndItem").val() == 1 || ($("#hndItem").val() == 90 && $("#hndflagfiltrocontratos").val() == 1)) {\r\n                if ($("#hndDataVigenciaLC").val() == "") {\r\n                    if ($("#cmbDataVigenciaLC").val() == "") {\r\n                        if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                        msgErro += "Favor informar o Ano de Vig\xeancia!";\r\n                    }\r\n\r\n                }\r\n            }\r\n            //Processo\r\n            if ($("#hndItem").val() == 2 || ($("#hndItem").val() == 91 && $("#hndflagfiltrolicitacoes").val() == 1)) {\r\n                if ($("#txtAnoProcesso").val() == \'\') {\r\n                    if ($("#hndDataVigenciaLC").val() == "") {\r\n                        if ($("#cmbDataVigenciaLC").val() == "") {\r\n                            if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                            msgErro += "Favor informar o Ano de Vig\xeancia!";\r\n                        }\r\n\r\n                    }\r\n                }\r\n                // DRO - 9245 - 01/02/2019 - Inicio\r\n                if ($("#cmbDataVigenciaLC").val() == "" || $("#cmbDataVigenciaLC").val() == "SELECIONE") {\r\n                    if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                    msgErro += "Favor informar o Ano de Vig\xeancia!";\r\n                }\r\n                // DRO - 9245 - 01/02/2019 - Fim\r\n            }\r\n        }\r\n        //Estoque = Item 5\r\n        if ($("#hndItem").val() != 5 && $("#hndItem").val() != 6) {\r\n            if ($("#cmbUnidadeGestoraLC").val() == "") {\r\n                ($("#cmbUnidadeGestoraLC").val(-1))\r\n            }\r\n        }\r\n        switch ($("#hndItem").val()) {\r\n            case "90": //Contrato Calamidade jds 22-07-2020\r\n                {\r\n                    if ($("#hndflagfiltrocontratos").val() == 1) {\r\n                        if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                        ValidaContrato();\r\n                    };\r\n                } break;\r\n            case "1": //Contrato jds 22-07-2020\r\n                {\r\n                    if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                    ValidaContrato();\r\n                } break;\r\n            case "91": //Processos Calamidade\r\n                {\r\n                    if ($("#hndflagfiltrolicitacoes").val() == 1) {\r\n                        ValidaProcesso();\r\n                    };\r\n                } break;\r\n            case "2": //Processos\r\n                {\r\n                    if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                    ValidaProcesso();\r\n                } break;\r\n            //-------------------------jds 22-07-2020\r\n            case "3": //fornecedores\r\n                {\r\n                    if ($("#cmbEstado").val() == "") {\r\n                        if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                        msgErro += "Favor informar o campo Estado!";\r\n                    }\r\n                    else {\r\n                        if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                        if ($("#cmbMunicipio").val() == "") {\r\n                            msgErro += "Favor informar o campo Munic\xedpio!";\r\n                        }\r\n                    }\r\n\r\n                } break;\r\n\r\n            case "4": //Produtos\r\n                {\r\n                    if (msgErro == "") {\r\n                        //Se todos TipoContrato estiverem desmarcados ent\xe3o marca todos\r\n                        if (!$("#ckClassificacaoBensPatrimoniais").is(":checked") &&\r\n                            !$("#ckClassificacaoMaterialConsumo").is(":checked") &&\r\n                            !$("#ckClassificacaoObrasServicos").is(":checked")) {\r\n                            $("#ckClassificacaoBensPatrimoniais").attr("checked", true);\r\n                            $("#ckClassificacaoMaterialConsumo").attr("checked", true);\r\n                            $("#ckClassificacaoObrasServicos").attr("checked", true);\r\n                        }\r\n                    }\r\n                } break;\r\n\r\n            case "5": //Estoque\r\n                {\r\n\r\n                    if ($("#cmbEstoqueUnidadeCM").val() == "") {\r\n                        if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                        msgErro += "Favor informar o campo Entidade!";\r\n                    }\r\n                    if ($("#cmbEstoqueDataVigenciaLC").val() == "") {\r\n                        if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                        msgErro += "Favor informar o campo Ano!";\r\n                    }\r\n                    if ($("#cmbEstoqueUnidadeGestoraLC").val() == "") {\r\n                        if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                        msgErro += "Favor informar o campo Unidade Gestora!";\r\n                    }\r\n                    //if ($(\'#cmbEstoqueMesInicial :selected\').val() == 0) {\r\n                    //\tif (msgErro != "") { msgErro += "\\n\\n"; }\r\n                    //\tmsgErro += "Favor informar o campo M\xeas Inicial do Movimento!";\r\n                    //}\r\n                    //if ($(\'#cmbEstoqueMesFinal :selected\').val() == 0) {\r\n                    //\tif (msgErro != "") { msgErro += "\\n\\n"; }\r\n                    //\tmsgErro += "Favor informar o campo M\xeas Final do Movimento!";\r\n                    //}\r\n\r\n                } break;\r\n\r\n            case "6": //Patrimonio\r\n                {\r\n                    if ($("#cmbPatrimonioUnidadeCM").val() == "") {\r\n                        if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                        msgErro += "Favor informar o campo Entidade!";\r\n                    }\r\n                    if ($("#cmbPatrimonioDataVigenciaLC").val() == "") {\r\n                        if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                        msgErro += "Favor informar o campo Ano!";\r\n                    }\r\n                    if ($("#cmbPatrimonioUnidadeGestoraLC").val() == "") {\r\n                        if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                        msgErro += "Favor informar o campo Unidade Gestora!";\r\n                    }\r\n                } break;\r\n\r\n            case "7": //Frotas\r\n                {\r\n                    msgErro += ""\r\n                    if ($("#cmbFrotasUnidadeAF").val() == "") {\r\n                        if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                        msgErro += "Favor informar o campo Entidade!";\r\n                    }\r\n                    if ($("#cmbFrotasUnidadeGestora").val() == "") {\r\n                        if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                        msgErro += "Favor informar o campo Unidade Gestora!";\r\n                    }\r\n                } break;\r\n            case "96": //Patrimonio\r\n                {\r\n                    if ($("#cmbPatrimonioUnidadeCM").val() == "") {\r\n                        if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                        msgErro += "Favor informar o campo Entidade!";\r\n                    }\r\n                    if ($("#cmbPatrimonioUnidadeGestoraLC").val() == "") {\r\n                        if (msgErro != "") { msgErro += "\\n\\n"; }\r\n                        msgErro += "Favor informar o campo Unidade Gestora!";\r\n                    }\r\n                } break;\r\n        }\r\n    }\r\n    if (msgErro == "") {\r\n        if ($("#hndAcao").val() == 10)\r\n            return true;\r\n\r\n        PostForm();\r\n        exibirAguarde();\r\n    }\r\n    else {\r\n        jAlert(msgErro, \'Aten\xe7\xe3o\');\r\n        return false;\r\n    }\r\n}\r\n\r\nfunction exibirAguarde(param) {\r\n    var exibir = true;\r\n\r\n    if (param != undefined)\r\n        exibir = param;\r\n\r\n    var agd = document.getElementById("aguarde");\r\n    if (agd) {\r\n        if (exibir)\r\n            agd.style.display = "block";\r\n        else\r\n            agd.style.display = "none";\r\n\r\n        if (agd.getAttribute("primeiravez") == "1")\r\n            return;\r\n\r\n        window.scrollTo(0, 0);\r\n        resize();\r\n        agd.setAttribute("primeiravez", "1");\r\n    }\r\n}\r\n\r\nfunction resize() {\r\n    var agd = document.getElementById("aguarde");\r\n\r\n    if (agd) {\r\n        var htmlheight = document.body.scrollHeight || agd.parentElement.scrollHeight;\r\n        var htmlwidth = document.body.scrollWidth || agd.parentElement.scrollWidth;\r\n        agd.style.height = htmlheight + "px";\r\n        agd.style.width = htmlwidth + "px";\r\n    }\r\n    mover(\'aguardeinterno\');\r\n}\r\n\r\nfunction resizeLC() {\r\n    var agd = document.getElementById("aguarde");\r\n\r\n    if (agd) {\r\n        var htmlheight = document.body.scrollHeight || agd.parentElement.scrollHeight;\r\n        var htmlwidth = document.body.scrollWidth || agd.parentElement.scrollWidth;\r\n        agd.style.height = htmlheight + "px";\r\n        agd.style.width = htmlwidth + "px";\r\n    }\r\n    mover(\'aguardeinternoLC\');\r\n}\r\n\r\nfunction mover(idElemento) {\r\n    var elemento = $("#" + idElemento);\r\n    if (elemento) {\r\n        $(elemento).css("top", ($(window).height() - $(elemento).height()) / 2 + $(window).scrollTop() + "px");\r\n        $(elemento).css("left", ($(window).width() - $(elemento).width()) / 2 + $(window).scrollLeft() + "px");\r\n    }\r\n}\r\n\r\nfunction NovaJanela(idElemento) {\r\n    var elemento = $("#" + idElemento);\r\n    var elemento2 = $("#topo");\r\n    if (elemento) {\r\n        var conteudohtml = $(\'<div>\').append(elemento.clone()).html();\r\n        conteudohtml = $(\'<div>\').append(elemento2.clone()).html() + conteudohtml;\r\n        var novaJanela = window.open("", "NovaJanela", "scrollbars,status,resizable");\r\n        novaJanela.document.write("<html><head>"\r\n            + "<link href=\'style.css\' rel=\'stylesheet\' type=\'text/css\'></head>"\r\n            + "<body onload=\'$(\\"a\\").contents().unwrap();$(\\"#tbAtualizacao\\").remove();$(\\"#txtPaginacao\\").show();$(\\"#tbPageTop\\").remove();$(\\"#tbPageBottom\\").remove();\'>"\r\n            + "<script type=\'text/javascript\' src=\'script.js\'></script>"\r\n            + "<script type=\'text/javascript\' src=\'jquery-1.4.2.min.js\'></script>"\r\n            + "<script type=\'text/javascript\'>"\r\n            + "function Imprimir() { window.print(); }"\r\n            + "</script>"\r\n            + "<form>"\r\n            + conteudohtml\r\n            + "<br /><input type=\'button\' onclick=\'Imprimir();\' value=\'Imprimir\' />"\r\n            + "<input type=\'button\' style=\'margin-left:10px;\' onclick=\'window.close();\' value=\'Fechar\' />"\r\n            + "</form></body></html>");\r\n        novaJanela.document.close();\r\n    }\r\n}\r\n\r\n\r\n\r\n/*\r\n * Metodo respons\xe1vel pela configura\xe7\xe3o das datas da op\xe7\xe3o\r\n * de menu Exportar Dados\r\n */\r\nfunction ExibicaoPeriodoExportarDados(exercicio, data, meses) {\r\n    alteraEntidade();\r\n    if (exercicio.attr(\'selectedIndex\') > 0 || exercicio.val() != \'\') {\r\n        exibirEsconderControle(data, false)\r\n        exibirEsconderControle(meses, true)\r\n    }\r\n    else {\r\n        exibirEsconderControle(data, true)\r\n        exibirEsconderControle(meses, false)\r\n    }\r\n\r\n}\r\n\r\nfunction alteraEntidade(limpaCampo) {\r\n    if (limpaCampo === undefined) {\r\n        limpaCampo = true;\r\n    }\r\n    limparDados(\'cmbMesInicial\');\r\n    limparDados(\'cmbMesFinal\');\r\n    //limparDados(\'txtDataInicial\');\r\n    //limparDados(\'txtDataFinal\');\r\n    //limparDados(\'cmbUnidadeGestora\');\r\n    incializaValoresPadraoCP(limpaCampo);\r\n\r\n}\r\n\r\n\r\n\r\nfunction exibirEsconderControle(controle, exibir) {\r\n    if (exibir)\r\n        $(controle).show();\r\n    else\r\n        $(controle).hide();\r\n}\r\n\r\nfunction limparDadosFavoritos(objID) {\r\n    var obj = $("#" + objID);\r\n    if (obj) {\r\n        obj.find("option").remove().end().append("<option value=\'\'>Acesso R\xe1pido</option>").val("\'\'");\r\n    }\r\n}\r\n\r\n\r\nfunction limparDados(objID) {\r\n\r\n    var obj = $("#" + objID);\r\n    if (obj) {\r\n        //\'DRO - 353774 - 26/10/2018 - Inicio\r\n        //if ($("#hndAcao").val() != 1 && $("#hndAcao").val() != 10 && $("#hndAcao").val() != 21) {//ADM e ExpotarBD\r\n        if ($("#hndAcao").val() != 1 && $("#hndAcao").val() != 21) {//ADM e ExpotarBD\r\n            //\'DRO - 353774 - 26/10/2018 - Fim\r\n            if ($("#hndItem").val() == 90 || $("#hndItem").val() == 91 || $("#hndItem").val() == 92 || $("#hndItem").val() == 93 || $("#hndItem").val() == 94 || $("#hndItem").val() == 95 || $("#hndItem").val() == 97 || $("#hndItem").val() == 1 || $("#hndItem").val() == 2 || $("#hndItem").val() == 3 || $("#hndItem").val() == 4 || $("#hndItem").val() == 5 || $("#hndItem").val() == 6 || $("#hndItem").val() == 7 || $("#hndItem").val() == 8 || $("#hndItem").val() == 9 || $("#hndItem").val() == 10 || $("#hndItem").val() == 11 || $("#hndItem").val() == 12 || $("#hndItem").val() == 13 || $("#hndItem").val() == 14 || $("#hndItem").val() == 15 || $("#hndItem").val() == 16 || $("#hndItem").val() == 17 || $("#hndItem").val() == 18 || $("#hndItem").val() == 19 || $("#hndItem").val() == 20 || $("#hndItem").val() == 21) { //Licitacoes \r\n                if (obj.is("input")) {\r\n                    obj.val("");\r\n                } else {\r\n                    obj.find("option").remove().end().append("<option value=\'\'>SELECIONE</option>").val("\'\'");\r\n                    //Verficica qual a \xe1rea para permitir valores defaut via windows load na p\xe1gina principal.html\r\n                    if ($("#hndItem").val() == 90 || $("#hndItem").val() == 91 || $("#hndItem").val() == 92 || $("#hndItem").val() == 93 || $("#hndItem").val() == 94 || $("#hndItem").val() == 95 || $("#hndItem").val() == 97 || $("#hndItem").val() == 1 || $("#hndItem").val() == 2 || $("#hndItem").val() == 3 || $("#hndItem").val() == 4 || $("#hndItem").val() == 5 || $("#hndItem").val() == 6 || $("#hndItem").val() == 7 || $("#hndItem").val() == 8 || $("#hndItem").val() == 9 || $("#hndItem").val() == 10 || $("#hndItem").val() == 11 || $("#hndItem").val() == 12 || $("#hndItem").val() == 13 || $("#hndItem").val() == 14 || $("#hndItem").val() == 15 || $("#hndItem").val() == 16 || $("#hndItem").val() == 17 || $("#hndItem").val() == 18 || $("#hndItem").val() == 20 || $("#hndItem").val() == 21) {\r\n                        obj.find("option").remove();\r\n\r\n                    }\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        //Rotina para limpar o combo Entidade das Publica\xe7\xf5es e Auditorias\r\n        if ($("#hndAcao").val() == 21) {\r\n            obj.find("option").remove().end().append("<option value=\'\'>SELECIONE</option>").val("\'\'");\r\n        }\r\n\r\n    }\r\n}\r\n\r\nfunction consultarMes(maiorqueID, mesID, anoID, fato1, fato2) {\r\n    consultarDados("Mes", mesID, anoID, maiorqueID, fato1, fato2);\r\n}\r\n\r\nfunction AtualizaMesFinal(mesInicial, mesFinal) {\r\n\r\n    var valorSelecionado = $("#" + mesInicial + " option:selected").val();\r\n\r\n    if (valorSelecionado != "") {\r\n        LimpaCombo(mesFinal)\r\n        adicionarItem(mesFinal, "", "SELECIONE");\r\n        $("select#" + mesInicial).find(\'option\').each(function () {\r\n            if ($(this).val() != "" && parseInt($(this).val()) >= parseInt(valorSelecionado))\r\n                adicionarItem(mesFinal, $(this).val(), $(this).text());\r\n        });\r\n    }\r\n    else {\r\n        LimpaCombo(mesFinal)\r\n        adicionarItem(mesFinal, "", "SELECIONE");\r\n    }\r\n}\r\n\r\nfunction adicionarItem(select, val, tex) {\r\n    $("#" + select).append("<option value=\'" + val + "\'>" + tex + "</option>");\r\n}\r\n\r\nfunction LimpaCombo(select) {\r\n    $("#" + select + " > option").remove();\r\n\r\n}\r\n\r\n/* Publica\xe7\xf5es Inicio */\r\nfunction preencheComboTema() {\r\n\r\n    var destino = $("#cmbTemaPublicacoes");\r\n    if ((destino) && (destino.is(":visible"))) {\r\n        limparDados("cmbTemaPublicacoes");\r\n        destino.css("background-color", "#cecece");\r\n\r\n        destino.attr("disabled", true);\r\n        $.ajax({\r\n            type: "GET",\r\n            global: false,\r\n            url: "acao.asp",\r\n            data: "acao=PreencheTema",\r\n            dataType: "json",\r\n            async: false,\r\n            cache: false,\r\n            success: function (jdados) {\r\n                limparDados("cmbTemaPublicacoes");\r\n                if (jdados) {\r\n                    if (jdados.Dados.length > 0) {\r\n                        destino.removeAttr("disabled");\r\n                        for (x = 0; x < jdados.Dados.length; x++) {\r\n                            var dado = jdados.Dados[x];\r\n                            var optn = document.createElement("OPTION");\r\n                            optn.text = dado.text;\r\n                            optn.value = dado.id;\r\n                            destino.find("option").end().append("<option value=\'" + dado.id + "\'>" + dado.text + "</option>").val("\'" + dado.id + "\'");\r\n                        };\r\n                    }\r\n                }\r\n                destino.css("background-color", "#ffffff");\r\n                destino.attr("disabled", false);\r\n            },\r\n            error: function (jerro) {\r\n                alert(jerro.responseText);\r\n                destino.css("background-color", "#ffffff");\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nfunction preencheComboEntidadePublicacoes() {\r\n\r\n    var destino = $("#cmbEntidadePublicacoes");\r\n    var destino2 = $("#cmbPeriodoPublicacao");\r\n    if ((destino) && (destino.is(":visible"))) {\r\n        limparDados("cmbEntidadePublicacoes");\r\n        limparDados("cmbPeriodoPublicacao");\r\n        destino.css("background-color", "#cecece");\r\n\r\n        if ($("#cmbAnoCargasPublicacoes").select().val() != "") {\r\n            var comboMesesPublicacao = document.getElementById("cmbPeriodoPublicacao");\r\n\r\n            for (x = 0; x < 6; x++) {\r\n                var opt = document.createElement("option");\r\n                opt.value = x;\r\n                if (x == 0) {\r\n                    opt.text = "Livre";\r\n                } else if (x == 1) {\r\n                    opt.text = "Semestre";\r\n                } else if (x == 2) {\r\n                    opt.text = "Quadrimestre";\r\n                } else if (x == 3) {\r\n                    opt.text = "Trimestre";\r\n                } else if (x == 4) {\r\n                    opt.text = "Bimestre";\r\n                } else if (x == 5) {\r\n                    opt.text = "M\xeas";\r\n                }\r\n\r\n                comboMesesPublicacao.add(opt, comboMesesPublicacao.options[x]);\r\n            }\r\n\r\n            destino2.attr("disabled", false);\r\n\r\n        } else {\r\n            destino2.attr("disabled", true);\r\n            limparDados("cmbPeriodoPublicacao");\r\n            limparDados("cmbUnidadeGestoraPublicacoes");\r\n            $("#cmbRef").css("display", "none");\r\n            $("#txtRef").css("display", "block");\r\n        }\r\n\r\n        destino.attr("disabled", true);\r\n        $.ajax({\r\n            type: "GET",\r\n            global: false,\r\n            url: "acao.asp",\r\n            data: "acao=BuscaEntidadesPublicacoes&param1=" + $("#cmbAnoCargasPublicacoes").select().val() + "&param2=" + $("#cmbTemaPublicacoes").select().val(),\r\n            dataType: "json",\r\n            async: false,\r\n            cache: false,\r\n            success: function (jdados) {\r\n                limparDados("cmbEntidadePublicacoes");\r\n                if (jdados) {\r\n                    if (jdados.Dados.length > 0) {\r\n                        destino.removeAttr("disabled");\r\n                        for (x = 0; x < jdados.Dados.length; x++) {\r\n                            var dado = jdados.Dados[x];\r\n                            var optn = document.createElement("OPTION");\r\n                            optn.text = dado.text;\r\n                            optn.value = dado.id;\r\n                            destino.find("option").end().append("<option value=\'" + dado.id + "\'>" + dado.text + "</option>").val("\'" + dado.id + "\'");\r\n                        };\r\n                    }\r\n                }\r\n                destino.css("background-color", "#ffffff");\r\n                destino.attr("disabled", false);\r\n            },\r\n            error: function (jerro) {\r\n                alert(jerro.responseText);\r\n                destino.css("background-color", "#ffffff");\r\n            }\r\n        });\r\n    }\r\n\r\n}\r\n\r\n// DRO - 361507 - 26/02/2019 - Inicio\r\nfunction verificaAreaDoTema() {\r\n    var destino = $("#txtAreaDoTema");\r\n\r\n    //if ((destino) && (destino.is(":visible"))) {\r\n    if (destino) {\r\n        limparDados("txtAreaDoTema");\r\n        destino.css("background-color", "#cecece");\r\n\r\n        destino.attr("disabled", true);\r\n        $.ajax({\r\n            type: "GET",\r\n            global: false,\r\n            url: "acao.asp",\r\n            data: "acao=BuscaAreaDoTema&param1=" + $("#cmbTemaPublicacoes").select().val(),\r\n            dataType: "json",\r\n            async: false,\r\n            cache: false,\r\n            success: function (jdados) {\r\n                limparDados("txtAreaDoTema");\r\n                if (jdados !== "") {\r\n                    destino.val(jdados);\r\n                }\r\n\r\n                destino.css("background-color", "#ffffff");\r\n                destino.attr("disabled", true);\r\n\r\n                if (destino.val() === \'0\') {\r\n                    $("#cmbAnoCargasPublicacoes").attr("disabled", true);\r\n                }\r\n                else {\r\n                    $("#cmbAnoCargasPublicacoes").attr("disabled", false);\r\n                }\r\n            },\r\n            error: function (jerro) {\r\n                alert(jerro.responseText);\r\n                destino.css("background-color", "#ffffff");\r\n            }\r\n        });\r\n    }\r\n}\r\n// DRO - 361507 - 26/02/2019 - Fim\r\n\r\nfunction preencheComboUnidadeGestoraPublicacoes() {\r\n\r\n    var destino = $("#cmbUnidadeGestoraPublicacoes");\r\n    if ((destino) && (destino.is(":visible"))) {\r\n        limparDados("cmbUnidadeGestoraPublicacoes");\r\n        destino.css("background-color", "#cecece");\r\n\r\n        destino.attr("disabled", true);\r\n        $.ajax({\r\n            type: "GET",\r\n            global: false,\r\n            url: "acao.asp",\r\n            data: "acao=BuscaUnidadesGestorasPublicacoes&param1=" + $("#cmbEntidadePublicacoes").select().val() + "&param2=" + $("#cmbAnoCargasPublicacoes").select().val(),\r\n            dataType: "json",\r\n            async: false,\r\n            cache: false,\r\n            success: function (jdados) {\r\n                limparDados("cmbUnidadeGestoraPublicacoes");\r\n                if (jdados) {\r\n                    if (jdados.Dados.length > 0) {\r\n                        destino.removeAttr("disabled");\r\n                        for (x = 0; x < jdados.Dados.length; x++) {\r\n                            var dado = jdados.Dados[x];\r\n                            var optn = document.createElement("OPTION");\r\n                            optn.text = dado.text;\r\n                            optn.value = dado.id;\r\n                            destino.find("option").end().append("<option value=\'" + dado.id + "\'>" + dado.text + "</option>").val("\'" + dado.id + "\'");\r\n                        };\r\n                    }\r\n                }\r\n                destino.css("background-color", "#ffffff");\r\n                destino.attr("disabled", false);\r\n            },\r\n            error: function (jerro) {\r\n                alert(jerro.responseText);\r\n                destino.css("background-color", "#ffffff");\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n\r\n// 363871 - Pronim TB - Textos de negativas. (Demanda legal)\r\nfunction preencheComboTipoDespesa() {\r\n    var destino = $("#cmbDiariasPassagens");\r\n    $.ajax({\r\n        type: "GET",\r\n        global: false,\r\n        url: "acao.asp",\r\n        data: "acao=BuscaTipoDespesas",\r\n        dataType: "json",\r\n        async: false,\r\n        cache: false,\r\n        success: function (jdados) {\r\n\r\n            var dado = jdados.Dados[0];\r\n\r\n            if (dado == undefined) {\r\n                //Aqui ser\xe1 as op\xe7\xf5es de dados para apresentar somente as op\xe7\xf5es da combo marcada no TBNET.\r\n                destino.find("option").end().append("<option value=\'0\'>SELECIONE</option>").val("\'0\'");\r\n                destino.find("option").end().append("<option value=\'1\'>DI\xc1RIAS</option>").val("\'1\'");\r\n                destino.find("option").end().append("<option value=\'2\'>PASSAGENS E DESPESAS COM LOCOMO\xc7\xc3O</option>").val("\'2\'");\r\n                destino.find("option").end().append("<option value=\'3\'>ADIANTAMENTO DE VIAGEM</option>").val("\'3\'");\r\n            }\r\n\r\n            if (dado != undefined) {\r\n                var tipoDespesa = dado.text;\r\n                var msgTipoDespesa = $(".msgTipoDespesa");\r\n                var tituloForm = $("tamanhoTabela");\r\n\r\n                if (tipoDespesa == "7") {\r\n                    //Aqui ser\xe1 as op\xe7\xf5es de dados para apresentar somente as op\xe7\xf5es da combo marcada no TBNET.\r\n                    destino.find("option").end().append("<option value=\'0\'>SELECIONE</option>").val("\'0\'");\r\n                    destino.find("option").end().append("<option value=\'1\'>DI\xc1RIAS</option>").val("\'1\'");\r\n                    destino.find("option").end().append("<option value=\'2\'>PASSAGENS E DESPESAS COM LOCOMO\xc7\xc3O</option>").val("\'2\'");\r\n                    destino.find("option").end().append("<option value=\'3\'>ADIANTAMENTO DE VIAGEM</option>").val("\'3\'");\r\n                    tituloForm.find("ClassTituloForm").end().append("Teste").val("\'Teste\'");\r\n                }\r\n                else if (tipoDespesa == "6") {\r\n                    //Aqui ser\xe1 as op\xe7\xf5es de dados para apresentar somente as op\xe7\xf5es da combo marcada no TBNET.\r\n                    destino.find("option").end().append("<option value=\'0\'>SELECIONE</option>").val("\'0\'");\r\n                    destino.find("option").end().append("<option value=\'1\'>DI\xc1RIAS</option>").val("\'1\'");\r\n                    destino.find("option").end().append("<option value=\'2\'>PASSAGENS E DESPESAS COM LOCOMO\xc7\xc3O</option>").val("\'2\'");\r\n                    tituloForm.find("ClassTituloForm").end().append("Teste").val("\'Teste\'");\r\n\r\n                }\r\n                else if (tipoDespesa == "5") {\r\n                    //Aqui ser\xe1 as op\xe7\xf5es de dados para apresentar somente as op\xe7\xf5es da combo marcada no TBNET.\r\n                    destino.find("option").end().append("<option value=\'0\'>SELECIONE</option>").val("\'0\'");\r\n                    destino.find("option").end().append("<option value=\'1\'>DI\xc1RIAS</option>").val("\'1\'");\r\n                    destino.find("option").end().append("<option value=\'3\'>ADIANTAMENTO DE VIAGEM</option>").val("\'3\'");\r\n                    tituloForm.find("ClassTituloForm").end().append("Teste").val("\'Teste\'");\r\n                }\r\n                else if (tipoDespesa == "4") {\r\n                    //Aqui ser\xe1 as op\xe7\xf5es de dados para apresentar somente as op\xe7\xf5es da combo marcada no TBNET.\r\n                    destino.find("option").end().append("<option value=\'0\'>SELECIONE</option>").val("\'0\'");\r\n                    destino.find("option").end().append("<option value=\'2\'>PASSAGENS E DESPESAS COM LOCOMO\xc7\xc3O</option>").val("\'2\'");\r\n                    destino.find("option").end().append("<option value=\'3\'>ADIANTAMENTO DE VIAGEM</option>").val("\'3\'");\r\n                    tituloForm.find("ClassTituloForm").end().append("Teste").val("\'Teste\'");\r\n                }\r\n                else if (tipoDespesa == "3") {\r\n                    //Aqui ser\xe1 as op\xe7\xf5es de dados para apresentar somente as op\xe7\xf5es da combo marcada no TBNET.\r\n                    destino.find("option").end().append("<option value=\'0\'>SELECIONE</option>").val("\'0\'");\r\n                    destino.find("option").end().append("<option value=\'3\'>ADIANTAMENTO DE VIAGEM</option>").val("\'3\'");\r\n                    tituloForm.find("ClassTituloForm").end().append("Teste").val("\'Teste\'");\r\n                }\r\n                else if (tipoDespesa == "2") {\r\n                    //Aqui ser\xe1 as op\xe7\xf5es de dados para apresentar somente as op\xe7\xf5es da combo marcada no TBNET.\r\n                    destino.find("option").end().append("<option value=\'0\'>SELECIONE</option>").val("\'0\'");\r\n                    destino.find("option").end().append("<option value=\'2\'>PASSAGENS E DESPESAS COM LOCOMO\xc7\xc3O</option>").val("\'2\'");\r\n                    tituloForm.find("ClassTituloForm").end().append("Teste").val("\'Teste\'");\r\n                }\r\n                else if (tipoDespesa == "1") {\r\n                    //Aqui ser\xe1 as op\xe7\xf5es de dados para apresentar somente as op\xe7\xf5es da combo marcada no TBNET.\r\n                    destino.find("option").end().append("<option value=\'0\'>SELECIONE</option>").val("\'0\'");\r\n                    destino.find("option").end().append("<option value=\'1\'>DI\xc1RIAS</option>").val("\'1\'");\r\n                    tituloForm.find("ClassTituloForm").end().append("Teste").val("\'Teste\'");\r\n                } else {\r\n                    //Aqui ser\xe1 as op\xe7\xf5es de dados para apresentar somente as op\xe7\xf5es da combo marcada no TBNET.\r\n                    destino.find("option").end().append("<option value=\'0\'>SELECIONE</option>").val("\'0\'");\r\n                    destino.find("option").end().append("<option value=\'1\'>DI\xc1RIAS</option>").val("\'1\'");\r\n                    destino.find("option").end().append("<option value=\'2\'>PASSAGENS E DESPESAS COM LOCOMO\xc7\xc3O</option>").val("\'2\'");\r\n                    destino.find("option").end().append("<option value=\'3\'>ADIANTAMENTO DE VIAGEM</option>").val("\'3\'");\r\n                    tituloForm.remove();\r\n                }\r\n            }\r\n\r\n        },\r\n        error: function (jerro) {\r\n            //Aqui ser\xe1 as op\xe7\xf5es de dados para apresentar somente as op\xe7\xf5es da combo marcada no TBNET.\r\n            destino.find("option").end().append("<option value=\'0\'>SELECIONE</option>").val("\'0\'");\r\n            destino.find("option").end().append("<option value=\'1\'>DI\xc1RIAS</option>").val("\'1\'");\r\n            destino.find("option").end().append("<option value=\'2\'>PASSAGENS E DESPESAS COM LOCOMO\xc7\xc3O</option>").val("\'2\'");\r\n            destino.find("option").end().append("<option value=\'3\'>ADIANTAMENTO DE VIAGEM</option>").val("\'3\'");\r\n        }\r\n    });\r\n}\r\n\r\nfunction preencheNaturezaDespesa() {\r\n\r\n    var destino = $("#cmbDesdobramentoDespesa");\r\n    var comboDPassagens = $("#cmbDiariasPassagens").select().val();\r\n    var param1 = "";\r\n    if (comboDPassagens == "1") {\r\n        param1 = "14";\r\n    } else if (comboDPassagens == "2") {\r\n        param1 = "33";\r\n    } else {\r\n        param1 = "0";\r\n        destino.css("background-color", "#ffffff");\r\n        destino.attr("disabled", true);\r\n    }\r\n    var param2 = $("#cmbAno").select().val();\r\n\r\n    var param3 = $("#cmbUnidadeCP").select().val();\r\n\r\n    if ((destino) && (destino.is(":visible"))) {\r\n        limparDados("cmbDesdobramentoDespesa");\r\n        destino.css("background-color", "#cecece");\r\n\r\n        destino.attr("disabled", true);\r\n        $.ajax({\r\n            type: "GET",\r\n            global: false,\r\n            url: "acao.asp",\r\n            data: "acao=BuscaNaturezaDespesa&param1=" + param1 + "&param2=" + param2 + "&param3=" + param3,\r\n            dataType: "json",\r\n            async: false,\r\n            cache: false,\r\n            success: function (jdados) {\r\n                limparDados("cmbDesdobramentoDespesa");\r\n                if (jdados) {\r\n                    if (jdados.Dados.length > 0) {\r\n                        destino.removeAttr("disabled");\r\n                        for (x = 0; x < jdados.Dados.length; x++) {\r\n                            var dado = jdados.Dados[x];\r\n                            var optn = document.createElement("OPTION");\r\n                            optn.text = dado.text;\r\n                            optn.value = dado.id;\r\n                            destino.find("option").end().append("<option value=\'" + dado.id + "\'>" + dado.text + "</option>").val("\'" + dado.id + "\'");\r\n                        };\r\n                        destino.css("background-color", "#ffffff");\r\n                        destino.attr("disabled", false);\r\n                    }\r\n                }\r\n            },\r\n            error: function (jerro) {\r\n                alert(jerro.responseText);\r\n                destino.css("background-color", "#ffffff");\r\n            }\r\n        });\r\n    }\r\n\r\n}\r\n\r\nfunction alteraComboReferenciaPublicacoes() {\r\n\r\n    var destino = $("#cmbPeriodoPublicacao");\r\n    var destino2 = $("#cmbReferenciaDePublicacoes");\r\n\r\n    limparDados("cmbReferenciaDePublicacoes");\r\n    destino.css("background-color", "#cecece");\r\n\r\n    //$("#mensagemReferencia").css("display", "none");\r\n\r\n    if ($("#cmbPeriodoPublicacao").select().val() != 0) { // Se for diferente de Livre\r\n        $("#txtRef").css("display", "none");\r\n        $("#cmbRef").css("display", "block");\r\n\r\n    } else {\r\n        $("#cmbRef").css("display", "none");\r\n        $("#txtRef").css("display", "block");\r\n    }\r\n\r\n    if ($("#cmbPeriodoPublicacao").select().val() == 1) {// Semestre\r\n\r\n        LimpaCombo("cmbReferenciaDePublicacoes");\r\n\r\n        $("#cmbReferenciaAtePublicacoes").css("display", "none");\r\n        $("#mensagemAteCombo").css("display", "none");\r\n        //$("#mensagemReferencia").css("display", "block");\r\n        //$("#mensagemReferencia").removeAttr("display");\r\n\r\n        var comboMesesPublicacao = document.getElementById("cmbReferenciaDePublicacoes");\r\n\r\n        var opt0 = document.createElement("option");\r\n        opt0.value = "0";\r\n        opt0.text = "SELECIONE";\r\n        comboMesesPublicacao.add(opt0, comboMesesPublicacao.options[0]);\r\n\r\n        for (x = 1; x < 3; x++) {\r\n            var opt = document.createElement("option");\r\n            opt.value = x;\r\n            if (x == 1) {\r\n                opt.text = "Primeiro";\r\n            } else if (x == 2) {\r\n                opt.text = "Segundo";\r\n            }\r\n            comboMesesPublicacao.add(opt, comboMesesPublicacao.options[x]);\r\n        }\r\n\r\n    } else if ($("#cmbPeriodoPublicacao").select().val() == 2) {// Quadrimestre\r\n\r\n        LimpaCombo("cmbReferenciaDePublicacoes");\r\n        $("#cmbReferenciaAtePublicacoes").css("display", "none");\r\n        $("#mensagemAteCombo").css("display", "none");\r\n        //$("#mensagemReferencia").css("display", "block");\r\n        //$("#mensagemReferencia").removeAttr("display");\r\n\r\n        var comboMesesPublicacao = document.getElementById("cmbReferenciaDePublicacoes");\r\n\r\n        var opt0 = document.createElement("option");\r\n        opt0.value = "0";\r\n        opt0.text = "SELECIONE";\r\n        comboMesesPublicacao.add(opt0, comboMesesPublicacao.options[0]);\r\n\r\n        for (x = 1; x < 4; x++) {\r\n            var opt = document.createElement("option");\r\n            opt.value = x;\r\n            if (x == 1) {\r\n                opt.text = "Primeiro";\r\n            } else if (x == 2) {\r\n                opt.text = "Segundo";\r\n            } else if (x == 3) {\r\n                opt.text = "Terceiro";\r\n            }\r\n\r\n            comboMesesPublicacao.add(opt, comboMesesPublicacao.options[x]);\r\n        }\r\n\r\n    } else if ($("#cmbPeriodoPublicacao").select().val() == 3) {// Trimestre\r\n\r\n        LimpaCombo("cmbReferenciaDePublicacoes");\r\n        $("#cmbReferenciaAtePublicacoes").css("display", "none");\r\n        $("#mensagemAteCombo").css("display", "none");\r\n        //$("#mensagemReferencia").css("display", "block");\r\n        //$("#mensagemReferencia").removeAttr("display");\r\n\r\n        var comboMesesPublicacao = document.getElementById("cmbReferenciaDePublicacoes");\r\n\r\n        var opt0 = document.createElement("option");\r\n        opt0.value = "0";\r\n        opt0.text = "SELECIONE";\r\n        comboMesesPublicacao.add(opt0, comboMesesPublicacao.options[0]);\r\n\r\n        for (x = 1; x < 5; x++) {\r\n            var opt = document.createElement("option");\r\n            opt.value = x;\r\n            if (x == 1) {\r\n                opt.text = "Primeiro";\r\n            } else if (x == 2) {\r\n                opt.text = "Segundo";\r\n            } else if (x == 3) {\r\n                opt.text = "Terceiro";\r\n            } else if (x == 4) {\r\n                opt.text = "Quarto";\r\n            }\r\n\r\n            comboMesesPublicacao.add(opt, comboMesesPublicacao.options[x]);\r\n        }\r\n\r\n    } else if ($("#cmbPeriodoPublicacao").select().val() == 4) {// Bimestre\r\n\r\n        LimpaCombo("cmbReferenciaDePublicacoes");\r\n        $("#cmbReferenciaAtePublicacoes").css("display", "none");\r\n        $("#mensagemAteCombo").css("display", "none");\r\n        // $("#mensagemReferencia").css("display", "block");\r\n        // $("#mensagemReferencia").removeAttr("display");\r\n\r\n        var comboMesesPublicacao = document.getElementById("cmbReferenciaDePublicacoes");\r\n\r\n        var opt0 = document.createElement("option");\r\n        opt0.value = "0";\r\n        opt0.text = "SELECIONE";\r\n        comboMesesPublicacao.add(opt0, comboMesesPublicacao.options[0]);\r\n\r\n        for (x = 1; x < 7; x++) {\r\n            var opt = document.createElement("option");\r\n            opt.value = x;\r\n            if (x == 1) {\r\n                opt.text = "Primeiro";\r\n            } else if (x == 2) {\r\n                opt.text = "Segundo";\r\n            } else if (x == 3) {\r\n                opt.text = "Terceiro";\r\n            } else if (x == 4) {\r\n                opt.text = "Quarto";\r\n            } else if (x == 5) {\r\n                opt.text = "Quinto";\r\n            } else if (x == 6) {\r\n                opt.text = "Sexto";\r\n            }\r\n\r\n            comboMesesPublicacao.add(opt, comboMesesPublicacao.options[x]);\r\n        }\r\n\r\n    } else if ($("#cmbPeriodoPublicacao").select().val() == 5) {// M\xeas\r\n\r\n        LimpaCombo("cmbReferenciaDePublicacoes");\r\n        LimpaCombo("cmbReferenciaAtePublicacoes");\r\n\r\n        $("#cmbReferenciaAtePublicacoes").css("display", "block");\r\n        $("#mensagemAteCombo").css("display", "block");\r\n\r\n        $("#cmbReferenciaAtePublicacoes").removeAttr("style");\r\n        $("#mensagemAteCombo").removeAttr("style");\r\n\r\n        var comboMesesPublicacao;\r\n\r\n        for (xx = 0; xx < 2; xx++) {\r\n\r\n            if (xx == 0) {\r\n                comboMesesPublicacao = document.getElementById("cmbReferenciaDePublicacoes");\r\n            } else {\r\n                comboMesesPublicacao = document.getElementById("cmbReferenciaAtePublicacoes");\r\n            }\r\n\r\n            var opt0 = document.createElement("option");\r\n            opt0.value = "0";\r\n            opt0.text = "SELECIONE";\r\n            comboMesesPublicacao.add(opt0, comboMesesPublicacao.options[0]);\r\n\r\n            for (x = 1; x < 13; x++) {\r\n                var opt = document.createElement("option");\r\n                opt.value = x;\r\n                if (x == 1) {\r\n                    opt.text = "Janeiro";\r\n                } else if (x == 2) {\r\n                    opt.text = "Fevereiro";\r\n                } else if (x == 3) {\r\n                    opt.text = "Mar\xe7o";\r\n                } else if (x == 4) {\r\n                    opt.text = "Abril";\r\n                } else if (x == 5) {\r\n                    opt.text = "Maio";\r\n                } else if (x == 6) {\r\n                    opt.text = "Junho";\r\n                } else if (x == 7) {\r\n                    opt.text = "Julho";\r\n                } else if (x == 8) {\r\n                    opt.text = "Agosto";\r\n                } else if (x == 9) {\r\n                    opt.text = "Setembro";\r\n                } else if (x == 10) {\r\n                    opt.text = "Outubro";\r\n                } else if (x == 11) {\r\n                    opt.text = "Novembro";\r\n                } else if (x == 12) {\r\n                    opt.text = "Dezembro";\r\n                }\r\n\r\n                comboMesesPublicacao.add(opt, comboMesesPublicacao.options[x]);\r\n            };\r\n        };\r\n\r\n    } else {\r\n        limparDados("cmbReferenciaDePublicacoes");\r\n    }\r\n}\r\n\r\nfunction preencheComboReferenciaAtePublicacoes() {\r\n\r\n    var valorCombo = $("#cmbReferenciaDePublicacoes").select().val();\r\n\r\n    LimpaCombo("cmbReferenciaAtePublicacoes");\r\n\r\n    var comboMesesPublicacao = document.getElementById("cmbReferenciaAtePublicacoes");\r\n\r\n    var opt0 = document.createElement("option");\r\n    opt0.value = "0";\r\n    opt0.text = "SELECIONE";\r\n    comboMesesPublicacao.add(opt0, comboMesesPublicacao.options[0]);\r\n\r\n    for (x = valorCombo; x < 13; x++) {\r\n        var opt = document.createElement("option");\r\n        opt.value = x;\r\n        if (x == 1) {\r\n            opt.text = "Janeiro";\r\n        } else if (x == 2) {\r\n            opt.text = "Fevereiro";\r\n        } else if (x == 3) {\r\n            opt.text = "Mar\xe7o";\r\n        } else if (x == 4) {\r\n            opt.text = "Abril";\r\n        } else if (x == 5) {\r\n            opt.text = "Maio";\r\n        } else if (x == 6) {\r\n            opt.text = "Junho";\r\n        } else if (x == 7) {\r\n            opt.text = "Julho";\r\n        } else if (x == 8) {\r\n            opt.text = "Agosto";\r\n        } else if (x == 9) {\r\n            opt.text = "Setembro";\r\n        } else if (x == 10) {\r\n            opt.text = "Outubro";\r\n        } else if (x == 11) {\r\n            opt.text = "Novembro";\r\n        } else if (x == 12) {\r\n            opt.text = "Dezembro";\r\n        }\r\n\r\n        comboMesesPublicacao.add(opt, comboMesesPublicacao.options[x]);\r\n    };\r\n}\r\n\r\n/* Publica\xe7\xf5es Fim */\r\n\r\n\r\nfunction consultarMesGeral(parametros) {\r\n    var dados = parametros.split(\'#\');\r\n\r\n    var destino = $("#cmbMesInicial");\r\n    if ((destino) && (destino.is(":visible"))) {\r\n        var params = "";\r\n        if ($("#hndAcao").val() == 10 && $("#hndItem").val() == 3) //ADM\r\n        {\r\n            dados[5] = $("#cmbUnidadeCP option:selected").val().split(\'|\')[1];\r\n        }\r\n        var obj = $("#" + dados[0] + " option:selected").text();\r\n        if (obj != "")\r\n            params += "&param1=" + obj;\r\n        else\r\n            limparDados("cmbMesInicial");\r\n\r\n        params += "&param2=\'\'";\r\n\r\n        params += "&param3=" + dados[2];\r\n        params += "&param4=" + dados[3];\r\n        params += "&param5=" + dados[4];\r\n        params += "&param6=" + (dados[5] == \'\' ? $("#" + dados[0] + " option:selected").val() : dados[5]);\r\n        destino.css("background-color", "#cecece");\r\n\r\n        destino.attr("disabled", true);\r\n        $.ajax({\r\n            type: "GET",\r\n            global: false,\r\n            url: "acao.asp",\r\n            data: "acao=MesGeral" + replaceAll(params, "/", "|"),\r\n            dataType: "json",\r\n            async: false,\r\n            cache: false,\r\n            success: function (jdados) {\r\n                limparDados("cmbMesInicial");\r\n                if (jdados) {\r\n                    if (jdados.Dados.length > 0) {\r\n                        destino.removeAttr("disabled");\r\n                        for (x = 0; x < jdados.Dados.length; x++) {\r\n                            var dado = jdados.Dados[x];\r\n                            var optn = document.createElement("OPTION");\r\n                            optn.text = dado.text;\r\n                            optn.value = dado.id;\r\n                            destino.find("option").end().append("<option value=\'" + dado.id + "\'>" + dado.text + "</option>").val("\'" + dado.id + "\'");\r\n                        };\r\n                    }\r\n                    else {\r\n                        alert("N\xe3o h\xe1 dados de contratos para esse exerc\xedcio!")\r\n                    }\r\n                }\r\n                destino.css("background-color", "#ffffff");\r\n                destino.attr("disabled", false);\r\n            },\r\n            error: function (jerro) {\r\n                alert(jerro.responseText);\r\n                destino.css("background-color", "#ffffff");\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nfunction consultarMesTransferencia(parametros) {\r\n    var dados = parametros.split(\'#\');\r\n\r\n    var destino = $("#cmbMesInicial");\r\n\r\n    var params = "";\r\n    //var obj = $("#cmbAno option:selected").text();\r\n    var obj = $("#" + dados[0] + " option:selected").text();\r\n    params += "&param1=" + obj;\r\n\r\n    //var obj = $(\'#cmbUnidadeCP option:selected\').val();\r\n    var obj = $("#" + dados[1] + " option:selected").val();\r\n    params += "&param2=" + obj;\r\n\r\n\r\n    destino.css("background-color", "#cecece");\r\n    destino.attr("disabled", true);\r\n    $.ajax({\r\n        type: "GET",\r\n        global: false,\r\n        url: "acao.asp",\r\n        data: "acao=MesTransferencia" + replaceAll(params, "/", "|"),\r\n        dataType: "json",\r\n        async: false,\r\n        cache: false,\r\n        success: function (jdados) {\r\n            limparDados("cmbMesInicial");\r\n            if (jdados) {\r\n                if (jdados.Dados.length > 0) {\r\n                    destino.removeAttr("disabled");\r\n                    for (x = 0; x < jdados.Dados.length; x++) {\r\n                        var dado = jdados.Dados[x];\r\n                        var optn = document.createElement("OPTION");\r\n                        optn.text = dado.text;\r\n                        optn.value = dado.id;\r\n                        destino.find("option").end().append("<option value=\'" + dado.id + "\'>" + dado.text + "</option>").val("\'" + dado.id + "\'");\r\n                    };\r\n                }\r\n            }\r\n            destino.css("background-color", "#ffffff");\r\n            destino.attr("disabled", false);\r\n        },\r\n        error: function (jerro) {\r\n            alert(jerro.responseText);\r\n            destino.css("background-color", "#ffffff");\r\n        }\r\n    });\r\n}\r\n\r\nfunction consultarSituacoesEmergenciaLC(prFuncao, prDestino, prParam1, prParam2) {\r\n    var params = "";\r\n    var destino = $("#" + prDestino);\r\n\r\n    if (destino && $("#" + prParam1).val() != "" && $("#" + prParam2).val() != "") {\r\n\r\n        if ($("#" + prParam1) && $("#" + prParam1).val() != "") {\r\n            params += "&param1=" + $("#" + prParam1).val();\r\n        }\r\n\r\n        if ($("#" + prParam2) && $("#" + prParam2).val() != "") {\r\n            params += "&param2=" + $("#" + prParam2).val();\r\n        }\r\n\r\n        if (prDestino != "null") {\r\n\r\n            $.ajax({\r\n                type: "GET",\r\n                global: false,\r\n                url: "acao.asp",\r\n                data: "acao=" + prFuncao + replaceAll(params, "/", "|"),\r\n                dataType: "json",\r\n                async: false,\r\n                cache: false,\r\n                success: function (result) {\r\n                    if (result) {\r\n                        if (result.Dados.length > 0) {\r\n                            $("#" + prDestino).empty();\r\n                            $("#" + prDestino).append("<option value=\'0\'>TODOS</option>")\r\n                            for (x = 0; x < result.Dados.length; x++) {\r\n                                var dado = result.Dados[x];\r\n                                if (dado.id != "0") {\r\n                                    var option = document.createElement("OPTION");\r\n                                    option.value = dado.id;\r\n                                    option.text = dado.text;\r\n                                    destino.find("option").end().append("<option value=\'" + dado.id + "\'>" + dado.text.split(\';\')[0] + "</option>").val("\'" + dado.id + "\'");\r\n                                }\r\n                            };\r\n                        }\r\n                    }\r\n                    destino.css("background-color", "#ffffff");\r\n                },\r\n                error: function (erro) {\r\n                    alert(erro.responseText);\r\n                    destino.css("background-color", "#ffffff");\r\n                }\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\nfunction consultarSituacoesEmergenciaCP(prFuncao, prDestino, prParam1) {\r\n    var params = "";\r\n    var destino = $("#" + prDestino);\r\n\r\n    if (destino && $("#" + prParam1).val() != "") {\r\n\r\n        if ($("#" + prParam1) && $("#" + prParam1).val().split(\'|\')[0] != "") {\r\n            params += "&param1=" + $("#" + prParam1).val().split(\'|\')[0];\r\n        }\r\n\r\n        if (prDestino != "null") {\r\n\r\n            $.ajax({\r\n                type: "GET",\r\n                global: false,\r\n                url: "acao.asp",\r\n                data: "acao=" + prFuncao + replaceAll(params, "/", "|"),\r\n                dataType: "json",\r\n                async: false,\r\n                cache: false,\r\n                success: function (result) {\r\n                    if (result) {\r\n                        if (result.Dados.length > 0) {\r\n                            $("#" + prDestino).empty();\r\n                            $("#" + prDestino).append("<option value=\'0\'>TODOS</option>")\r\n                            $("#" + prDestino).append("<option value=\'1\'>COVID-19</option>")\r\n                            for (x = 0; x < result.Dados.length; x++) {\r\n                                var dado = result.Dados[x];\r\n                                if (dado.id != "0") {\r\n                                    var option = document.createElement("OPTION");\r\n                                    option.value = dado.id;\r\n                                    option.text = dado.text;\r\n                                    destino.find("option").end().append("<option value=\'" + dado.id + "\'>" + dado.text + "</option>").val("\'" + dado.id + "\'");\r\n                                }\r\n                            };\r\n                        }\r\n                        else {\r\n                            $("#" + prDestino).empty();\r\n                            $("#" + prDestino).append("<option value=\'0\'>TODOS</option>")\r\n                            $("#" + prDestino).append("<option value=\'1\'>COVID-19</option>")\r\n                        }\r\n                    }\r\n                    destino.css("background-color", "#ffffff");\r\n                },\r\n                error: function (erro) {\r\n                    alert(erro.responseText);\r\n                    destino.css("background-color", "#ffffff");\r\n                }\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\nfunction consultarFonteRecursoCodigoAplicacaoAcaoGovernoCP(prFuncao, prDestino, prParam1, prParam2) {\r\n    var params = "";\r\n    var destino = $("#" + prDestino);\r\n\r\n    if (destino && $("#" + prParam1).val() != "" && $("#" + prParam2).val() != "") {\r\n\r\n        if ($("#" + prParam1) && $("#" + prParam1).val().split(\'|\')[0] != "") {\r\n            params += "&param1=" + $("#" + prParam1).val().split(\'|\')[0];\r\n        }\r\n\r\n        if ($("#" + prParam2) && $("#" + prParam2).val() != "") {\r\n            params += "&param2=" + $("#" + prParam2).val();\r\n        }\r\n\r\n        if (prDestino != "null") {\r\n\r\n            $.ajax({\r\n                type: "GET",\r\n                global: false,\r\n                url: "acao.asp",\r\n                data: "acao=" + prFuncao + replaceAll(params, "/", "|"),\r\n                dataType: "json",\r\n                async: false,\r\n                cache: false,\r\n                success: function (result) {\r\n                    if (result) {\r\n                        if (result.Dados.length > 0) {\r\n                            $("#" + prDestino).empty();\r\n\r\n                            var cdsFonteRecurso = \'(\';\r\n                            var cdsAplicacao = \'(\';\r\n                            var cdsProjetoAtividade = \'(\';\r\n\r\n                            for (x = 0; x < result.Dados.length; x++) {\r\n                                var dado = result.Dados[x];\r\n\r\n                                if (dado.id != "0") {\r\n\r\n                                    var str = dado.text.substr(0, dado.text.length - 1);\r\n                                    var textSplitted = str.split(\';\');\r\n\r\n                                    for (y = 0; y < textSplitted.length; y++) {\r\n                                        var option = document.createElement("OPTION");\r\n                                        var recurso = textSplitted[y].split(\',\')[0];\r\n                                        var aplicacao = textSplitted[y].split(\',\')[1];\r\n                                        var atividade = textSplitted[y].split(\',\')[2];\r\n\r\n                                        cdsFonteRecurso += recurso + \',\';\r\n                                        cdsAplicacao += aplicacao + \',\';\r\n                                        cdsProjetoAtividade += atividade + \',\';\r\n\r\n                                        // TODO: Ajustar texto a ser exibido.\r\n                                        option.text = \'(\' + recurso + \');(\' + aplicacao + \');(\' + atividade + \')\';\r\n                                        option.value = \'(\' + recurso + \');(\' + aplicacao + \');(\' + atividade + \')\';\r\n                                        destino.find("option").end().append("<option value=\'" + option.value + "\'>" + option.text + "</option>").val("\'" + option.value + "\'");\r\n                                    };\r\n                                }\r\n                            };\r\n\r\n                            cdsFonteRecurso = cdsFonteRecurso.substr(0, cdsFonteRecurso.length - 1) + \')\';\r\n                            cdsAplicacao = cdsAplicacao.substr(0, cdsAplicacao.length - 1) + \')\';\r\n                            cdsProjetoAtividade = cdsProjetoAtividade.substr(0, cdsProjetoAtividade.length - 1) + \')\';\r\n\r\n                            var cdTodos = cdsFonteRecurso + \';\' + cdsAplicacao + \';\' + cdsProjetoAtividade;\r\n                            destino.find("option").end().prepend("<option value=\'" + cdTodos + "\'>" + "TODOS" + "</option>").val("\'" + cdTodos + "\'");\r\n                        }\r\n                        else {\r\n                            $("#" + prDestino).empty(); // Para COVID => value=\'\'\r\n                            $("#" + prDestino).append("<option value=\'\'>TODOS</option>")\r\n                        }\r\n                    }\r\n                    destino.css("background-color", "#ffffff");\r\n                },\r\n                error: function (erro) {\r\n                    alert(erro.responseText);\r\n                    destino.css("background-color", "#ffffff");\r\n                }\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\nfunction consultarAnosCargaLC(prFuncao, prDestino, prParam1) {\r\n\r\n    var destino = $("#" + prDestino);\r\n    var params = "";\r\n\r\n    if (destino && $("#" + prParam1).val() != "") {\r\n\r\n        // valida\xe7\xe3o campo #1\r\n        if ($("#" + prParam1) && $("#" + prParam1).val() != "") {\r\n            params += "&param1=" + $("#" + prParam1).val();\r\n        }\r\n        // chamada ajax\r\n        $.ajax({\r\n            type: "GET",\r\n            global: false,\r\n            url: "acao.asp",\r\n            data: "acao=" + prFuncao + replaceAll(params, "/", "|"),\r\n            dataType: "json",\r\n            async: false,\r\n            cache: false,\r\n            success: function (jdados) {\r\n                if (jdados) {\r\n                    if (jdados.Dados.length > 0) {\r\n                        for (x = 0; x < jdados.Dados.length; x++) {\r\n                            var dado = jdados.Dados[x];\r\n                            var optn = document.createElement("OPTION");\r\n                            optn.text = dado.text;\r\n                            optn.value = dado.id;\r\n                            destino.find("option").end().append("<option value=\'" + dado.id + "\'>" + dado.text + "</option>").val("\'" + dado.id + "\'");\r\n                        };\r\n                    }\r\n                }\r\n                destino.css("background-color", "#ffffff");\r\n            },\r\n            error: function (jerro) {\r\n                alert(jerro.responseText);\r\n                destino.css("background-color", "#ffffff");\r\n            }\r\n        });\r\n    }\r\n}\r\nfunction consultarDadosComboFuncao(prFuncao, prDestino, param1) {\r\n    var base = $("#" + param1).val().split("|")[1];\r\n    var destino = $("#" + prDestino);\r\n    limparDados(prDestino);\r\n    destino.find(\'option\')\r\n        .remove()\r\n        .end()\r\n        .append(\'<option value="">SELECIONE</option>\')\r\n        .val(\'\');\r\n    destino.trigger("change");\r\n    postDataAjaxCP(destino, prFuncao, base);\r\n}\r\n\r\nfunction consultarDadosComboLC(prFuncao, prDestino, prParam1, prParam2) {\r\n    var destino = $("#" + prDestino);\r\n    var params = "";\r\n\r\n    limparDados(prDestino);\r\n    //limparDados("cmbUnidadeGestoraLC");\r\n\r\n    destino.find(\'option\')\r\n        .remove()\r\n        .end()\r\n        .append(\'<option value="">SELECIONE</option>\')\r\n        .val(\'\');\r\n\r\n    destino.trigger("change");\r\n\r\n    if (destino && $("#" + prParam1).val() != "" && $("#" + prParam2).val() != "") {\r\n\r\n        // valida\xe7\xe3o campo #1\r\n        if ($("#" + prParam1) && $("#" + prParam1).val() != "") {\r\n            params += "&param1=" + $("#" + prParam1).val();\r\n        }\r\n\r\n        // valida\xe7\xe3o campo #2\r\n        if ($("#" + prParam2).val() != "") {\r\n\r\n            if ($("#" + prParam2) && $("#" + prParam2).val() != "") {\r\n                params += "&param2=" + $("#" + prParam2).val();\r\n            }\r\n        }\r\n\r\n        // chamada ajax\r\n        postDataAjaxLc(destino, prFuncao, params);\r\n\r\n    }\r\n}\r\n\r\n\r\nfunction consultarDadosLC(prOrigem, prDestino) {\r\n    var destino = $("#" + prDestino);\r\n\r\n    if ($("#" + prOrigem).val() != "" || $("#" + prOrigem).val() == "") {\r\n        //LimpaCombo(destino);\r\n        destino.find(\'option\')\r\n            .remove()\r\n            .end()\r\n            .append(\'<option value="">SELECIONE</option>\')\r\n            .val(\'\');\r\n    }\r\n    destino.trigger("change");\r\n}\r\n\r\nfunction postDataAjaxCP(destino, prFuncao, base) {\r\n    console.log("acao.asp?acao=" + prFuncao + "&base=" + base)\r\n    $("#cmbFuncao").attr("disabled", false);\r\n    $(\'#confirma\').attr(\'disabled\', false);\r\n    $.ajax({\r\n        type: "POST",\r\n        url: "acao.asp?acao=" + prFuncao + "&base=" + base,\r\n        data: "",\r\n        async: false,\r\n        cache: false,\r\n        success: function (d) {\r\n            if (d && d.length > 0) {\r\n                var dados = d.split("|");\r\n                for (x = 0; x < dados.length; x++) {\r\n                    var dado = dados[x];\r\n                    var dadosID = dado.split("#")\r\n                    if (dado != "") {\r\n                        destino.append("<option value=\'" + dadosID[1] + "\'>" + dadosID[0] + "</option>").val("\'" + dadosID[1] + "\'");\r\n                    }\r\n                    destino.removeAttr("disabled");\r\n                };\r\n            };\r\n\r\n            var funcaoSelecionada = getUrlVars()[\'funcao\'];\r\n            console.log(funcaoSelecionada);\r\n            console.log("x");\r\n            if ($(\'#cmbFuncao option[value=\' + funcaoSelecionada + \']\').length > 0) {\r\n                console.log("y");\r\n                if (funcaoSelecionada.trim()) {\r\n                    console.log("y1");\r\n                    $(\'#cmbFuncao option[value=\' + funcaoSelecionada + \']\').attr(\'selected\', \'selected\');\r\n                    $("#cmbFuncao").attr("disabled", true);\r\n                }\r\n                else {\r\n                    console.log("y2");\r\n                    alert(\'A fun\xe7\xe3o n\xe3o est\xe1 dispon\xedvel para o ano selecionado.\\r\\nVoc\xea pode selecionar outras fun\xe7\xf5es dispon\xedveis.\');\r\n                    $(\'#confirma\').attr(\'disabled\', true);\r\n                }\r\n\r\n            }\r\n\r\n\r\n        },\r\n\r\n        error: function (jerro) {\r\n            destino.attr(\'disabled\', true);\r\n            alert(jerro.responseText);\r\n        }\r\n    });\r\n}\r\n\r\nfunction getUrlVars() {\r\n    var vars = [], hash;\r\n    var hashes = window.location.href.slice(window.location.href.indexOf(\'?\') + 1).split(\'&\');\r\n    for (var i = 0; i < hashes.length; i++) {\r\n        hash = hashes[i].split(\'=\');\r\n        vars.push(hash[0]);\r\n        vars[hash[0]] = hash[1];\r\n    }\r\n    return vars;\r\n}\r\n\r\nfunction postDataAjaxLc(destino, prFuncao, params) {\r\n    $.ajax({\r\n        type: "POST",\r\n        url: "acao.asp?acao=" + prFuncao + replaceAll(params, "/", "|"),\r\n        data: "",\r\n        async: false,\r\n        cache: false,\r\n        success: function (d) {\r\n            if (d && d.length > 0) {\r\n                var dados = d.split("|");\r\n                for (x = 0; x < dados.length; x++) {\r\n                    var dado = dados[x];\r\n                    var dadosID = dado.split("#")\r\n                    if (dado != "") {\r\n                        destino.append("<option value=\'" + dadosID[1] + "\'>" + dadosID[0] + "</option>").val("\'" + dadosID[1] + "\'");\r\n                    }\r\n                    destino.removeAttr("disabled");\r\n                };\r\n            }\r\n        },\r\n\r\n        error: function (jerro) {\r\n            destino.attr(\'disabled\', true);\r\n            alert(jerro.responseText);\r\n        }\r\n    });\r\n}\r\n\r\nfunction consultarDadosEXportaBDCP(prFuncao, prDestino, prParam1, prParam2, prParam3, prParam4, prParam5, prParam6) {\r\n\r\n    var params = "";\r\n    var obj = $("#" + prParam5);\r\n\r\n    var pr6 = "";\r\n    if ($("#hndAcao").val() == 10 || $("#hndItem").val() == 3) //ADM\r\n    {\r\n        pr6 = "cmbUnidadeCP";\r\n    } else {\r\n        pr6 = $("#" + prParam6 + " option:selected").text() + \'|\' + $("#" + prParam6 + " option:selected").val().split(\'|\')[1];\r\n    }\r\n\r\n    if (obj && obj.val() != "") {\r\n        consultarDados(prFuncao, prDestino, prParam1, prParam2, prParam3, prParam4, pr6);\r\n    } else {\r\n        consultarDados(prFuncao, prDestino, prParam1, prParam2, prParam3, prParam4, "");\r\n    }\r\n}\r\n\r\nfunction consultarDadosCP(prFuncao, prDestino, prParam1, prParam2, prParam3, prParam4, prParam5, prLimpar) {\r\n\r\n    var naturezaDespesa = $("#cmbDesdobramentoDespesa");\r\n\r\n    if (naturezaDespesa != "") {\r\n        preencheNaturezaDespesa();\r\n    }\r\n\r\n    if (prLimpar === undefined) {\r\n        prLimpar = true;\r\n    }\r\n\r\n    var params = "";\r\n    var obj = $("#" + prParam5);\r\n\r\n    if (obj && obj.val() != "") {\r\n        consultarDados(prFuncao, prDestino, prParam1, prParam2, prParam3, prParam4, prParam5, prLimpar);\r\n    } else {\r\n        consultarDados(prFuncao, prDestino, prParam1, prParam2, prParam3, prParam4, "", prLimpar);\r\n    }\r\n}\r\n\r\nfunction changeTipoEsportaDados() {\r\n    var dscAjuda = "Todas as informa\xe7\xf5es referente a parte de administra\xe7\xe3o.";\r\n    var valTipoExporta = $(\'#cmbTipoEsportacaoDados\').find(\'option:selected\').val();\r\n\r\n\r\n    $(\'#txtDataInicial\').parent(\'td\').parent(\'tr\').show();\r\n    $(\'#txtDataFinal\').parent(\'td\').parent(\'tr\').show();\r\n\r\n    $(\'#txtDataInicial\').val("");\r\n    $(\'#txtDataFinal\').val("");\r\n\r\n    $(\'#cmbMesInicial\').parent(\'td\').parent(\'tr\').hide();\r\n    $(\'#cmbMesFinal\').parent(\'td\').parent(\'tr\').hide();\r\n    $(\'#cmbMesInicial option[value=""]\').attr(\'selected\', \'selected\');\r\n    $(\'#cmbMesFinal option[value=""]\').attr(\'selected\', \'selected\');\r\n    $(\'#cmbExercicio option[value=""]\').attr(\'selected\', \'selected\');\r\n\r\n\r\n    switch (valTipoExporta) {\r\n        case "2"://LC\r\n            dscAjuda = "Informa\xe7\xf5es de Licita\xe7\xf5es, Contratos, Produtos e Fornecedores";\r\n            $("#cmbExercicio").parent(\'td\').parent(\'tr\').show();\r\n            $("#cmbUnidadeLC")[0].setAttribute("onchange", "consultarDadosLC(\'cmbUnidadeLC\', \'cmbExercicio\'); consultarAnosCargaLC(\'ConsultarDataLC\', \'cmbExercicio\', \'cmbUnidadeLC\')");\r\n            $("#cmbExercicio")[0].setAttribute("onchange", "consultarDadosLC(\'cmbExercicio\', \'cmbUnidadeGestoraLC\');consultarDadosComboLC(\'ConsultarUnidadeGestoraLC\', \'cmbUnidadeGestoraLC\', \'cmbExercicio\', \'cmbUnidadeLC\'); ExibicaoPeriodoExportarDados($(\'#cmbExercicio\'),$(\'#txtDataInicial\').parent(\'td\').parent(\'tr\'), $(\'#cmbMesInicial\').parent(\'td\').parent(\'tr\')),consultarMesGeral(\'cmbExercicio##LC_Dim_Tempo#LC_Fato_ContratoProcessos#dt_Homologacao#\' + $(\'#cmbUnidadeLC option:selected\').val());");\r\n            break;\r\n        case "6": //CM\r\n            dscAjuda = "Informa\xe7\xf5es de Itens de Estoque";\r\n            $("#cmbExercicio").parent(\'td\').parent(\'tr\').show();\r\n            //Este Deve ser alterado\r\n            $("#cmbUnidadeLC")[0].setAttribute("onchange", "consultarDadosLC(\'cmbUnidadeLC\', \'cmbExercicio\'); consultarAnosCargaLC(\'ConsultarDataCM\', \'cmbExercicio\',\'cmbUnidadeLC\');");\r\n            $("#cmbExercicio")[0].setAttribute("onchange", "consultarDadosLC(\'cmbExercicio\', \'cmbUnidadeGestoraLC\'); consultarDados(\'RetornaUnidadeGestoraCM\', \'cmbUnidadeGestoraLC\', this.id,\'cmbUnidadeLC\');");\r\n            $(\'#cmbExercicio\').change(function () {\r\n                if (this.value > 0) {\r\n\r\n                    $(\'#cmbMesInicial\').parent(\'td\').parent(\'tr\').show();\r\n                    $(\'#cmbMesFinal\').parent(\'td\').parent(\'tr\').show();\r\n                    $(\'#txtDataInicial\').parent(\'td\').parent(\'tr\').hide();\r\n                    $(\'#txtDataFinal\').parent(\'td\').parent(\'tr\').hide();\r\n\r\n\r\n                    LimpaCombo("cmbMesInicial");\r\n                    LimpaCombo("cmbMesFinal");\r\n\r\n                    $("#cmbMesInicial").css("display", "block");\r\n                    //$("#mensagemAteCombo").css("display", "block");\r\n\r\n                    $("#cmbMesInicial").removeAttr("style");\r\n                    //$("#mensagemAteCombo").removeAttr("style");\r\n\r\n                    var comboMesesEstoque;\r\n\r\n                    for (xx = 0; xx < 2; xx++) {\r\n\r\n                        if (xx == 0) {\r\n                            comboMesesEstoque = document.getElementById("cmbMesInicial");\r\n                        } else {\r\n                            comboMesesEstoque = document.getElementById("cmbMesFinal");\r\n                        }\r\n\r\n                        var opt0 = document.createElement("option");\r\n                        opt0.value = "0";\r\n                        opt0.text = "SELECIONE";\r\n                        comboMesesEstoque.add(opt0, comboMesesEstoque.options[0]);\r\n\r\n                        for (x = 1; x < 13; x++) {\r\n                            var opt = document.createElement("option");\r\n                            opt.value = x;\r\n                            if (x == 1) {\r\n                                opt.text = "JANEIRO";\r\n                            } else if (x == 2) {\r\n                                opt.text = "FEVEREIRO";\r\n                            } else if (x == 3) {\r\n                                opt.text = "MAR\xc7O";\r\n                            } else if (x == 4) {\r\n                                opt.text = "ABRIL";\r\n                            } else if (x == 5) {\r\n                                opt.text = "MAIO";\r\n                            } else if (x == 6) {\r\n                                opt.text = "JUNHO";\r\n                            } else if (x == 7) {\r\n                                opt.text = "JULHO";\r\n                            } else if (x == 8) {\r\n                                opt.text = "AGOSTO";\r\n                            } else if (x == 9) {\r\n                                opt.text = "SETEMBRO";\r\n                            } else if (x == 10) {\r\n                                opt.text = "OUTUBRO";\r\n                            } else if (x == 11) {\r\n                                opt.text = "NOVEMBRO";\r\n                            } else if (x == 12) {\r\n                                opt.text = "DEZEMBRO";\r\n                            }\r\n                            comboMesesEstoque.add(opt, comboMesesEstoque.options[x]);\r\n                        };\r\n                    };\r\n\r\n                } else {\r\n                    limparDados("cmbMesInicial");\r\n                }\r\n            }).change();\r\n\r\n            break;\r\n        case "7": //PP\r\n            dscAjuda = "Informa\xe7\xf5es de Itens Patrimoniais";\r\n            $("#cmbExercicio").parent(\'td\').parent(\'tr\').hide();\r\n            $("#cmbUnidadeLC")[0].setAttribute("onchange", "consultarDadosLC(\'cmbUnidadeLC\', \'cmbUnidadeGestoraLC\'); consultarDados(\'RetornaUnidadeGestoraPP\', \'cmbUnidadeGestoraLC\', \'cmbUnidadeLC\')");;\r\n            break;\r\n        case "8": //AF\r\n            dscAjuda = "Informa\xe7\xf5es da Frota Municipal";\r\n            $("#cmbExercicio").parent(\'td\').parent(\'tr\').hide();\r\n            $("#cmbUnidadeLC")[0].setAttribute("onchange", "consultarDadosLC(\'cmbUnidadeLC\', \'cmbUnidadeGestoraLC\'); consultarDados(\'RetornaUnidadeGestoraAF\', \'cmbUnidadeGestoraLC\', \'cmbUnidadeLC\')");;\r\n            break;\r\n\r\n    }\r\n    consultarDadosLC(\'cmbTipoEsportacaoDados\', \'cmbUnidadeLC\');\r\n    consultarAnosCargaLC(\'RetornaTodosDatabases\', \'cmbUnidadeLC\', \'cmbTipoEsportacaoDados\');\r\n    $(\'#dscTipo\').text(dscAjuda);\r\n}\r\n\r\nfunction SetarBancoDados(prFuncao, prDestino, prParam1, prParam2, prParam3, prParam4, prParam5, prLimpar) {\r\n\r\n    if (prLimpar === undefined) {\r\n        prLimpar = true;\r\n    }\r\n\r\n    var destino = $("#" + prDestino);\r\n\r\n    var params = "";\r\n    var obj = $("#" + prParam1);\r\n    if (obj && obj.val() != "") {\r\n        params += "&param1=" + obj.val();\r\n    }\r\n    else if (prLimpar) {\r\n        limparDados(prDestino);\r\n    }\r\n\r\n    if (prParam2 != "") {\r\n        obj = $("#" + prParam2);\r\n        if (obj) {\r\n            params += "&param2=" + obj.val();\r\n        }\r\n    }\r\n\r\n    if (prParam3 != "") {\r\n        obj = $("#" + prParam3);\r\n        if (obj) {\r\n            if (obj.val()) {\r\n                params += "&param3=" + obj.val();\r\n            }\r\n            else {\r\n                params += "&param3=" + prParam3;\r\n            }\r\n        }\r\n    }\r\n    if (prParam4 != "") {\r\n        obj = $("#" + prParam4);\r\n        if (obj) {\r\n            if (obj.val()) {\r\n                params += "&param4=" + obj.val();\r\n            }\r\n            else {\r\n                params += "&param4=" + prParam4;\r\n            }\r\n        }\r\n    }\r\n    if (prParam5 != "") {\r\n        obj = $("#" + prParam5);\r\n        if (obj) {\r\n            if (obj.val()) {\r\n                params += "&param5=" + obj.val();\r\n            }\r\n            else {\r\n                params += "&param5=" + prParam5;\r\n            }\r\n        }\r\n    }\r\n    destino.css("background-color", "#cecece");\r\n    destino.attr("disabled", true);\r\n    $.ajax({\r\n        type: "GET",\r\n        global: false,\r\n        url: "acao.asp",\r\n        data: "acao=" + prFuncao + replaceAll(params, "/", "|"),\r\n        dataType: "json",\r\n        async: false,\r\n        cache: false,\r\n        success: function (jdados) {\r\n            if (prLimpar) {\r\n                limparDados(prDestino);\r\n            }\r\n            if (jdados) {\r\n                if (jdados.Dados.length > 0) {\r\n                    destino.removeAttr("disabled");\r\n                    for (x = 0; x < jdados.Dados.length; x++) {\r\n                        var dado = jdados.Dados[x];\r\n                        var optn = document.createElement("OPTION");\r\n                        optn.text = dado.text;\r\n                        optn.value = dado.id;\r\n                        destino.find("option").end().append("<option value=\'" + dado.id + "\'>" + dado.text + "</option>").val("\'" + dado.id + "\'");\r\n                    };\r\n                }\r\n            }\r\n            //else {\r\n            //    destino.attr("disabled", true);\r\n            //}\r\n            destino.css("background-color", "#ffffff");\r\n            destino.attr("disabled", false);\r\n        },\r\n        // error: function (jerro) {\r\n        //var w = window.open("", "Erro", "scrollbars,status,resizable")\r\n        //w.document.write(jerro.responseText);\r\n        //w.document.close();\r\n        // alert(jerro.responseText);\r\n        // destino.css("background-color", "#ffffff");\r\n        //}\r\n    });\r\n\r\n}\r\n\r\n\r\nfunction consultarDados(prFuncao, prDestino, prParam1, prParam2, prParam3, prParam4, prParam5, prLimpar) {\r\n\r\n    if (prLimpar === undefined) {\r\n        prLimpar = true;\r\n    }\r\n\r\n    var destino = $("#" + prDestino);\r\n\r\n    if ((destino) && (destino.is(":visible"))) {\r\n\r\n        var params = "";\r\n        var obj = $("#" + prParam1);\r\n        if (obj && obj.val() != "") {\r\n            params += "&param1=" + obj.val();\r\n        }\r\n        else if (prLimpar) {\r\n            limparDados(prDestino);\r\n        }\r\n\r\n        if (prParam2 != "") {\r\n            obj = $("#" + prParam2);\r\n            if (obj) {\r\n                params += "&param2=" + obj.val();\r\n            }\r\n        }\r\n\r\n        if (prParam3 != "") {\r\n            obj = $("#" + prParam3);\r\n            if (obj) {\r\n                if (obj.val()) {\r\n                    params += "&param3=" + obj.val();\r\n                }\r\n                else {\r\n                    params += "&param3=" + prParam3;\r\n                }\r\n            }\r\n        }\r\n        if (prParam4 != "") {\r\n            obj = $("#" + prParam4);\r\n            if (obj) {\r\n                if (obj.val()) {\r\n                    params += "&param4=" + obj.val();\r\n                }\r\n                else {\r\n                    params += "&param4=" + prParam4;\r\n                }\r\n            }\r\n        }\r\n        if (prParam5 != "") {\r\n            obj = $("#" + prParam5);\r\n            if (obj) {\r\n                if (obj.val()) {\r\n                    params += "&param5=" + obj.val();\r\n                }\r\n                else {\r\n                    params += "&param5=" + prParam5;\r\n                }\r\n            }\r\n        }\r\n        destino.css("background-color", "#cecece");\r\n        destino.attr("disabled", true);\r\n        $.ajax({\r\n            type: "GET",\r\n            global: false,\r\n            url: "acao.asp",\r\n            data: "acao=" + prFuncao + replaceAll(params, "/", "|"),\r\n            dataType: "json",\r\n            async: false,\r\n            cache: false,\r\n            success: function (jdados) {\r\n                if (prLimpar) {\r\n                    limparDados(prDestino);\r\n                }\r\n                if (jdados) {\r\n                    if (jdados.Dados.length > 0) {\r\n                        destino.removeAttr("disabled");\r\n                        for (x = 0; x < jdados.Dados.length; x++) {\r\n                            var dado = jdados.Dados[x];\r\n                            var optn = document.createElement("OPTION");\r\n                            optn.text = dado.text;\r\n                            optn.value = dado.id;\r\n                            destino.find("option").end().append("<option value=\'" + dado.id + "\'>" + dado.text + "</option>").val("\'" + dado.id + "\'");\r\n                        };\r\n                    }\r\n                }\r\n                //else {\r\n                //    destino.attr("disabled", true);\r\n                //}\r\n                destino.css("background-color", "#ffffff");\r\n                destino.attr("disabled", false);\r\n            },\r\n            // error: function (jerro) {\r\n            //var w = window.open("", "Erro", "scrollbars,status,resizable")\r\n            //w.document.write(jerro.responseText);\r\n            //w.document.close();\r\n            // alert(jerro.responseText);\r\n            // destino.css("background-color", "#ffffff");\r\n            //}\r\n        });\r\n    }\r\n}\r\n\r\nfunction consultarDadosCondicao(prFuncao, prDestino, prParam1, prParam2, prParam3, prParam4, prParam5, prParam6) {\r\n\r\n    var destino = $("#" + prDestino);\r\n    if ((destino) && (destino.is(":visible"))) {\r\n        var params = "";\r\n        var obj = $("#" + prParam1);\r\n        if (obj && obj.val() != "") {\r\n            params += "&param1=" + obj.val();\r\n        }\r\n        else {\r\n            limparDados(prDestino);\r\n        }\r\n\r\n        if (prParam2 != "") {\r\n            obj = $("#" + prParam2);\r\n            if (obj) {\r\n                if (obj.val()) {\r\n                    params += "&param2=" + obj.val();\r\n                }\r\n            }\r\n        }\r\n\r\n        if (prParam3 != "") {\r\n            obj = $("#" + prParam3);\r\n            if (obj) {\r\n                if (obj.val()) {\r\n                    params += "&param3=" + obj.val();\r\n                }\r\n                else {\r\n                    params += "&param3=" + prParam3;\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        if (prParam4 != "") {\r\n            obj = $("#" + prParam4);\r\n            if (obj) {\r\n                if (obj.val()) {\r\n                    params += "&param4=" + obj.val();\r\n                }\r\n                else {\r\n                    params += "&param4=" + prParam4;\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        if (prParam5 != "") {\r\n            obj = $("#" + prParam5);\r\n            if (obj) {\r\n                if (obj.val()) {\r\n                    params += "&param5=" + obj.val();\r\n                }\r\n                else {\r\n                    params += "&param5=" + prParam5;\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        if (prParam6 != "") {\r\n            params += "&param6=" + prParam6;\r\n        }\r\n\r\n\r\n        destino.css("background-color", "#cecece");\r\n        destino.attr("disabled", true);\r\n        $.ajax({\r\n            type: "GET",\r\n            global: false,\r\n            url: "acao.asp",\r\n            data: "acao=" + prFuncao + replaceAll(params, "/", "|"),\r\n            dataType: "json",\r\n            async: false,\r\n            cache: false,\r\n            success: function (jdados) {\r\n                limparDados(prDestino);\r\n                if (jdados) {\r\n                    if (jdados.Dados.length > 0) {\r\n                        destino.removeAttr("disabled");\r\n                        for (x = 0; x < jdados.Dados.length; x++) {\r\n                            var dado = jdados.Dados[x];\r\n                            var optn = document.createElement("OPTION");\r\n                            optn.text = dado.text;\r\n                            optn.value = dado.id;\r\n                            destino.find("option").end().append("<option value=\'" + dado.id + "\'>" + dado.text + "</option>").val("\'" + dado.id + "\'");\r\n                        };\r\n                    }\r\n                }\r\n                //else {\r\n                //    destino.attr("disabled", true);\r\n                //}\r\n                destino.css("background-color", "#ffffff");\r\n                destino.attr("disabled", false);\r\n            },\r\n            error: function (jerro) {\r\n                /*var w = window.open("", "Erro", "scrollbars,status,resizable")\r\n                w.document.write(jerro.responseText);\r\n                w.document.close();*/\r\n                alert(jerro.responseText);\r\n                destino.css("background-color", "#ffffff");\r\n            }\r\n        });\r\n    }\r\n\r\n}\r\n\r\nfunction replaceAll(string, texto, novotexto) {\r\n    while (string.indexOf(texto) != -1) {\r\n        string = string.replace(texto, novotexto);\r\n    }\r\n    return string;\r\n}\r\n\r\nfunction atualizaFiltroPagina() {\r\n    var aux = readCookie("ckAno");\r\n    if (aux) {\r\n        $("#cmbAno").val(aux);\r\n        $("#cmbAno").change();\r\n\r\n    }\r\n\r\n    var aux = readCookie("ckDataVigenciaLC")\r\n    if (aux) {\r\n        $("#cmbDataVigenciaLC").val(aux);\r\n    }\r\n\r\n    var aux = readCookie("ckSitProcessoLicit")\r\n    if (aux) {\r\n        $("#cmbSitProcessoLicit").val(aux);\r\n    }\r\n    if ($("#cmbSitProcessoLicit").size() > 0) {\r\n        licSituacaoFiltrarPor($("#cmbSitProcessoLicit"));\r\n    }\r\n\r\n    aux = readCookie("ckLeiLicitacoes");\r\n    if (aux) {\r\n        $("#cmbLeiLicitacoes").val(aux);\r\n    }\r\n\r\n    aux = readCookie("ckLicitacaoCompartilhada");\r\n    if (aux) {\r\n        $("#cmbLicitacaoCompartilhada").val(aux);\r\n    }\r\n    \r\n    aux = readCookie("ckModoExecucaoModalidade");\r\n    if (aux) {\r\n        $("#cmbModoExecucaoModalidade").val(aux);\r\n    }\r\n\r\n    aux = readCookie("ckRegistroPrecos");\r\n    if (aux) {\r\n        $("#cmbRegistroPrecos").val(aux);\r\n    }\r\n\r\n    aux = readCookie("ckSituacaoEmergenciaLicitacoes");\r\n    if (aux) {\r\n        $("#cmbSituacaoEmergenciaLicitacoes").val(aux);\r\n    }\r\n\r\n    aux = readCookie("ckSituacaoEmergenciaContratos");\r\n    if (aux) {\r\n        $("#cmbSituacaoEmergenciaContratos").val(aux);\r\n    }\r\n\r\n    aux = readCookie("ckSituacaoEmergenciaReceitasDespesas");\r\n    if (aux) {\r\n        $("#cmbSituacaoEmergenciaReceitasDespesas").val(aux);\r\n    }\r\n\r\n    aux = readCookie("ckFonteRecursoCodigoAplicacaoAcaoGoverno");\r\n    if (aux) {\r\n        $("#cmbFonteRecursoCodigoAplicacaoAcaoGoverno").val(aux);\r\n    }\r\n\r\n    aux = readCookie("ckExercicio");\r\n    if (aux) {\r\n        $("#cmbExercicio").val(aux);\r\n    }\r\n\r\n\r\n    aux = readCookie("ckDataGP");\r\n    if (aux) {\r\n        $("#cmbDataGP").val(aux);\r\n    }\r\n    aux = readCookie("ckUnidadeCP");\r\n    if (aux) {\r\n        $("#cmbUnidadeCP").val(aux);\r\n        $("#cmbUnidadeCP").change();\r\n    }\r\n    aux = readCookie("ckDataInicial");\r\n    if (aux) {\r\n        $("#txtDataInicial").val(aux);\r\n    }\r\n    aux = readCookie("ckDataFinal");\r\n    if (aux) {\r\n        $("#txtDataFinal").val(aux);\r\n        $("#txtDataFinal").blur();\r\n    }\r\n\r\n    aux = readCookie("ckDataInicialAR");\r\n    if (aux) {\r\n        $("#txtDataInicialAR").val(aux);\r\n    }\r\n    aux = readCookie("ckDataFinalAR");\r\n    if (aux) {\r\n        $("#txtDataFinalAR").val(aux);\r\n        $("#txtDataFinalAR").blur();\r\n    }\r\n\r\n    aux = readCookie("ckMesInicial");\r\n    if (aux) {\r\n        $("#cmbMesInicial").val(aux);\r\n        $("#cmbMesInicial").change();\r\n        aux = readCookie("ckMesFinal");\r\n        if (aux) {\r\n            $("#cmbMesFinal").val(aux);\r\n            $("#cmbMesFinal").change();\r\n        }\r\n    }\r\n\r\n    aux = readCookie("ckMesInicialGP");\r\n    if (aux) {\r\n        $("#cmbMesInicialGP").val(aux);\r\n        $("#cmbMesInicialGP").change();\r\n        aux = readCookie("ckMesFinalGP");\r\n        if (aux) {\r\n            $("#cmbMesFinalGP").val(aux);\r\n            $("#cmbMesFinalGP").change();\r\n        }\r\n    }\r\n\r\n    aux = readCookie("ckUnidadeGestora");\r\n    if (aux) {\r\n        $("#cmbUnidadeGestora").val(aux);\r\n    }\r\n    aux = readCookie("ckCategoria");\r\n    if (aux) {\r\n        $("#cmbCategoria").val(aux.split(\',\'));\r\n    }\r\n    aux = readCookie("ckApresentarPor");\r\n    if (aux) {\r\n        $("#cmbApresentarPor").val(aux);\r\n    }\r\n    aux = readCookie("ckEmpenhoOrcamentario");\r\n    if (aux) {\r\n        $("#ckEmpenhoOrcamentario").val(aux);\r\n    }\r\n    aux = readCookie("ckEmpenhoExtra");\r\n    if (aux) {\r\n        $("#ckEmpenhoExtra").val(aux);\r\n    }\r\n    aux = readCookie("ckEmpenhoResto");\r\n    if (aux) {\r\n        $("#ckEmpenhoResto").val(aux);\r\n    }\r\n    aux = readCookie("ckEstado");\r\n    if (aux) {\r\n        $("#cmbEstado").val(aux);\r\n        aux = readCookie("ckMunicipio");\r\n        if (aux) {\r\n            $("#cmbEstado").change();\r\n            $("#cmbMunicipio").val(aux);\r\n        }\r\n    }\r\n    aux = readCookie("ckDataFiltro");\r\n    if (aux) {\r\n        $("#cmbDataFiltro").val(aux);\r\n    }\r\n    //Filtro oculto\r\n    if ($("#hndAcao").val() == 1) //ADM\r\n    {\r\n        if ($("#hndItem").val() == 2) //Licitacoes\r\n        {\r\n            Exibir(\'trTipoLicitacaoConcurso1\', $(\'#ckTipoModalidadeConcurso\').is(\':checked\'));\r\n            Exibir(\'trTipoLicitacaoConcurso2\', $(\'#ckTipoModalidadeConcurso\').is(\':checked\'));\r\n        }\r\n    }\r\n}\r\n\r\nfunction createCookie(name, value, days) {\r\n    window.localStorage.setItem(name, value);\r\n}\r\n\r\nfunction MinMax(iconeID, tableID) {\r\n    $("#" + tableID).find("tr").each(function (index) {\r\n        if (index > 0) {\r\n            var child = $(this);\r\n            if (child.css("display") == "none") {\r\n                child.show();\r\n            }\r\n            else {\r\n                child.hide();\r\n            }\r\n        }\r\n    });\r\n    var icone = $("#" + iconeID);\r\n    if (icone.attr("alt") == "Minimizar") {\r\n        icone.attr("alt", "Maximizar");\r\n        icone.attr("src", "max.png");\r\n    }\r\n    else {\r\n        icone.attr("alt", "Minimizar");\r\n        icone.attr("src", "min.png");\r\n    }\r\n}\r\n\r\nfunction PreencheHidden(cmbID, hndID) {\r\n    $("#" + hndID).val($("#" + cmbID + " option:selected").text());\r\n\r\n    if ($("#" + cmbID).attr("type") == "select-multiple") {\r\n        var str = "";\r\n        $("#" + cmbID + " option:selected").each(function () {\r\n            str += $(this).text() + ",<br>";\r\n        });\r\n        $("#" + hndID).val(str.slice(0, -5));\r\n    }\r\n}\r\n\r\nfunction montaURLDetalhamentoItem(urlItem) {\r\n    exibirAguarde();\r\n    window.location.href = urlItem\r\n    exibirAguarde(false);\r\n}\r\n\r\nfunction fnRedirecionarTelaLC(urlItemLC) {\r\n    //alert("Ao clicar em [OK] ser\xe1 aberta a tela de pesquisa de processo licitat\xf3rio, onde ser\xe1 poss\xedvel efetuar a sele\xe7\xe3o de dados atrav\xe9s da indica\xe7\xe3o de par\xe2metros.", "Aten\xe7\xe3o");\r\n    var exibir = true;\r\n\r\n    var agd = document.getElementById("redirecionaLC");\r\n    agd.style.display = "block";\r\n\r\n    window.scrollTo(0, 0);\r\n    resizeLC();\r\n\r\n    $(\'<a>\', {\r\n        class: \'linkRedirecionar\',\r\n        href: urlItemLC,\r\n        target: \'_blank\',\r\n        text: \'OK\'\r\n    }).appendTo(\'#aguardeinternoLCTable\');\r\n\r\n}\r\n\r\nfunction fecharJanela() {\r\n    var agd = document.getElementById("redirecionaLC");\r\n    agd.style.display = "none";\r\n    $(\'.linkRedirecionar\').remove();\r\n}\r\n\r\nfunction IncluirHistorico(linhaID) {\r\n    var linha = $("#" + linhaID);\r\n    var tabela = linha.parent().parent();\r\n    var texto = ""\r\n    var link = ""\r\n    linha.children().each(function (index) {\r\n        var child = $(this);\r\n        if (child.attr("exibir")) {\r\n            if (child.attr("exibir") != 0) {\r\n                for (x = 0; x < parseInt(child.attr("exibir")); x++) {\r\n                    texto += "|";\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            if (texto != "") { texto += "|"; }\r\n            //Busca a legenda do table e s\xf3 adiciono se n\xe3o houver nenhum texto\r\n            if (texto.replace("|", "") == "") {\r\n                texto = tabela.attr("legenda") + texto;\r\n            }\r\n            texto += child.text();\r\n        }\r\n        if (index == 0) {\r\n            link = child.find("a").attr("href");\r\n        }\r\n    });\r\n    if (tabela.attr("novocab")) {\r\n        if (tabela.attr("novocab") != "") {\r\n            texto = tabela.attr("novocab") + texto;\r\n        }\r\n    }\r\n\r\n    var spl\r\n    spl = link.split(\';\');\r\n    link = "";\r\n    for (x = 0; x < spl.length; x++) {\r\n        if (x > 0) {\r\n            if (spl[x].substring(0, 25) == "montaURLDetalhamentoItem(") {\r\n                link += spl[x].substring(26, spl[x].length - 2);\r\n            }\r\n        }\r\n    }\r\n    link = escape(link);\r\n    $.ajax({\r\n        type: "POST",\r\n        url: "acao.asp?acao=IncluirHistorico&visao=" + $("#hndvisao").val() +\r\n            "&produto=" + $("#hndAcao").val() +\r\n            "&nivel=" + QueryString("nivel") +\r\n            "&link=" + link,\r\n        data: texto,\r\n        async: false,\r\n        cache: false,\r\n        error: function (jerro) {\r\n            alert(jerro.responseText);\r\n        }\r\n    });\r\n}\r\n\r\nfunction ExcluirHistorico(linha) {\r\n    $.ajax({\r\n        type: "POST",\r\n        url: "acao.asp?acao=ExcluirHistorico&visao=" + linha,\r\n        data: "",\r\n        async: false,\r\n        cache: false,\r\n        error: function (jerro) {\r\n            alert(jerro.responseText);\r\n        }\r\n    });\r\n}\r\n\r\nfunction QueryString(variavel) {\r\n    var result = ""\r\n    var variaveis = location.search.replace(/\\x3F/, "").replace(/\\x2B/g, " ").split("&");\r\n    var nvar;\r\n    if (variaveis != "") {\r\n        var qs = [];\r\n        for (var i = 0; i < variaveis.length; i++) {\r\n            nvar = variaveis[i].split("=");\r\n            qs[nvar[0]] = unescape(nvar[1]);\r\n        }\r\n        if (qs[variavel]) { result = qs[variavel]; }\r\n    }\r\n    return result;\r\n}\r\n\r\nfunction SetNotCheckBox(idCheck, idTodos) {\r\n    $("#" + idCheck).attr("checked", !$("#" + idCheck).is(":checked"));\r\n    if (!$("#" + idCheck).is(":checked")) {\r\n        $("#" + idTodos).attr("checked", false);\r\n    }\r\n}\r\n\r\nfunction SetGroupCheckBox(elemHtml, checked) {\r\n    jQuery.each($(elemHtml + " input:checkbox"), function () {\r\n\r\n        var elem = $(this);\r\n\r\n        if (checked) {\r\n            if (elem.attr("disabled") == \'\') {\r\n                $(this).attr("checked", true);\r\n            }\r\n        }\r\n        else {\r\n            $(this).attr("checked", false);\r\n        }\r\n    });\r\n}\r\n\r\nfunction SetTodosCheckBox(idCheck, idTodos, idAux1, idAux2, idAux3) {\r\n    if (!$("#" + idCheck).is(":checked")) {\r\n        $("#" + idTodos).attr("checked", false);\r\n    }\r\n    if (!$("#" + idCheck).is(":checked") && idAux1) {\r\n        $("#" + idAux1).attr("checked", $("#" + idCheck).is(":checked"));\r\n    }\r\n    if (!$("#" + idCheck).is(":checked") && idAux2) {\r\n        $("#" + idAux2).attr("checked", $("#" + idCheck).is(":checked"));\r\n    }\r\n    //    if (!$("#"+idCheck).is(":checked") && idAux3)\r\n    //    {\r\n    //        $("#"+idAux3).attr("checked", $("#"+idCheck).is(":checked"));\r\n    //    }\r\n}\r\n\r\nfunction Exibir(idObj, exibir) {\r\n    if (exibir) {\r\n        $("#" + idObj).show();\r\n    }\r\n    else {\r\n        $("#" + idObj).hide();\r\n    }\r\n}\r\n\r\nfunction getLastDateOfMonth(Year, Month) {\r\n    return (new Date((new Date(Year, Month, 1)) - 1));\r\n}\r\n\r\nfunction createObjectURL(file) {\r\n    if (window.webkitURL) {\r\n        return window.webkitURL.createObjectURL(file);\r\n    } else if (window.URL && window.URL.createObjectURL) {\r\n        return window.URL.createObjectURL(file);\r\n    } else if (URL.createObjectURL) {\r\n        return URL.createObjectURL(file);\r\n    } else {\r\n        return createObjectURL(file);\r\n    }\r\n}\r\n\r\nfunction downloadXML(itemMenu) {\r\n\r\n    var dataInicial = "";\r\n    var ano = "";\r\n    var dataFinal = "";\r\n    var unidadeGestora = "-1";\r\n    var banco = "";\r\n    var NomeFornecedor = "";\r\n    var CPFCNPJFornecedor = "";\r\n    var TipoDespesa = "";\r\n    var tipoEsportacao = "";\r\n\r\n    if (ValidaForm() == true) {\r\n\r\n        //\'DRO - 353774 - 26/10/2018 - Inicio\r\n        //if ($(\'#cmbExercicio option:selected\').index() == 0) { // Por data\r\n        //    if ($(\'#txtDataInicial\').val() != "" && $(\'#txtDataFinal\').val() != "") {\r\n        //        dataInicial = $(\'#txtDataInicial\').val().substr(6, 4) + $(\'#txtDataInicial\').val().substr(3, 2) + $(\'#txtDataInicial\').val().substr(0, 2);\r\n        //        dataFinal = $(\'#txtDataFinal\').val().substr(6, 4) + $(\'#txtDataFinal\').val().substr(3, 2) + $(\'#txtDataFinal\').val().substr(0, 2);;\r\n        //    }\r\n        //\r\n        //}\r\n        //else { // Por mes\r\n        //    if (($(\'#cmbAno option:selected\').val() == \'\') || ($(\'#cmbAno option:selected\').index() == -1)) {\r\n        //        dataInicial = $(\'#cmbExercicio option:selected\').text() + (\'0\' + $(\'#cmbMesInicial option:selected\').val()).slice(-2) + \'01\';\r\n        //        dataFinal =\r\n        //\t\t\t$(\'#cmbExercicio option:selected\').text() +\r\n        //\t\t\t(\'0\' + $(\'#cmbMesFinal option:selected\').val()).slice(-2) +\r\n        //\t\t\t(\'0\' + getLastDateOfMonth($(\'#cmbExercicio option:selected\').text(), $(\'#cmbMesFinal option:selected\').val()).getDate()).slice(-2);\r\n        //   }\r\n        //    else {\r\n        //        dataInicial = $(\'#cmbAno option:selected\').text() + (\'0\' + $(\'#cmbMesInicial option:selected\').val()).slice(-2) + \'01\';\r\n        //        dataFinal =\r\n        //\t\t\t$(\'#cmbAno option:selected\').text() +\r\n        //\t\t\t(\'0\' + $(\'#cmbMesFinal option:selected\').val()).slice(-2) +\r\n        //\t\t\t(\'0\' + getLastDateOfMonth($(\'#cmbAno option:selected\').text(), $(\'#cmbMesFinal option:selected\').val()).getDate()).slice(-2);\r\n        //   }\r\n        //}\r\n\r\n        if ($(\'#cmbExercicio option:selected\').index() == 0) { // Por data\r\n            if ($(\'#txtDataInicial\').val() != "" && $(\'#txtDataFinal\').val() != "") {\r\n                dataInicial = $(\'#txtDataInicial\').val().substr(6, 4) + $(\'#txtDataInicial\').val().substr(3, 2) + $(\'#txtDataInicial\').val().substr(0, 2);\r\n                dataFinal = $(\'#txtDataFinal\').val().substr(6, 4) + $(\'#txtDataFinal\').val().substr(3, 2) + $(\'#txtDataFinal\').val().substr(0, 2);;\r\n            }\r\n            else {\r\n                if ($(\'#cmbMesInicial option:selected\').text() != "" && $(\'#cmbMesInicial option:selected\').text() != "") {\r\n                    dataInicial = $(\'#cmbAno option:selected\').text() + (\'0\' + $(\'#cmbMesFinal option:selected\').val()).slice(-2) + \'01\';\r\n                    dataFinal =\r\n                        $(\'#cmbAno option:selected\').text() +\r\n                        (\'0\' + $(\'#cmbMesFinal option:selected\').val()).slice(-2) +\r\n                        (\'0\' + getLastDateOfMonth($(\'#cmbAno option:selected\').text(), $(\'#cmbMesFinal option:selected\').val()).getDate()).slice(-2);\r\n                }\r\n            }\r\n        }\r\n        else { // Por mes\r\n            if (($(\'#cmbAno option:selected\').val() == \'\') || ($(\'#cmbAno option:selected\').index() == -1)) {\r\n                dataInicial = $(\'#cmbExercicio option:selected\').text() + (\'0\' + $(\'#cmbMesInicial option:selected\').val()).slice(-2) + \'01\';\r\n                dataFinal =\r\n                    $(\'#cmbExercicio option:selected\').text() +\r\n                    (\'0\' + $(\'#cmbMesFinal option:selected\').val()).slice(-2) +\r\n                    (\'0\' + getLastDateOfMonth($(\'#cmbExercicio option:selected\').text(), $(\'#cmbMesFinal option:selected\').val()).getDate()).slice(-2);\r\n            }\r\n            else {\r\n                dataInicial = $(\'#cmbAno option:selected\').text() + (\'0\' + $(\'#cmbMesInicial option:selected\').val()).slice(-2) + \'01\';\r\n                dataFinal =\r\n                    $(\'#cmbAno option:selected\').text() +\r\n                    (\'0\' + $(\'#cmbMesFinal option:selected\').val()).slice(-2) +\r\n                    (\'0\' + getLastDateOfMonth($(\'#cmbAno option:selected\').text(), $(\'#cmbMesFinal option:selected\').val()).getDate()).slice(-2);\r\n            }\r\n        }\r\n        //\'DRO - 353774 - 26/10/2018 - Fim\r\n\r\n        //Ano\r\n        if (($(\'#cmbAno option:selected\').val() == \'\') || ($(\'#cmbAno option:selected\').index() == -1)) {\r\n            ano = $(\'#cmbExercicio option:selected\').text();\r\n        }\r\n        else {\r\n            ano = $(\'#cmbAno option:selected\').text();\r\n        }\r\n\r\n        //Unidade Gestora\r\n        //\'DRO - 353774 - 26/10/2018 - Inicio\r\n        //if ($(\'#cmbUnidadeGestora option:selected\').val() != "")\r\n        //    unidadeGestora = $(\'#cmbUnidadeGestora option:selected\').val();\r\n        if ($(\'#cmbUnidadeGestora option:selected\').val() != \'\' && $(\'#cmbUnidadeGestora option:selected\').index() != -1) {\r\n            unidadeGestora = $(\'#cmbUnidadeGestora option:selected\').val();\r\n        }\r\n        else {\r\n            unidadeGestora = "-1";\r\n        }\r\n        //\'DRO - 353774 - 26/10/2018 - Fim\r\n\r\n        //NomeFornecedor\r\n        if ($(\'#txtNomeFornecedor\').val() != "")\r\n            NomeFornecedor = $(\'#txtNomeFornecedor\').val();\r\n        //CPFCNPJFornecedor\r\n        if ($(\'#txtCPFCNPJFornecedor\').val() != "")\r\n            CPFCNPJFornecedor = $(\'#txtCPFCNPJFornecedor\').val();\r\n        //Unidade Gestora LC\r\n        if ($(\'#cmbUnidadeGestoraLC option:selected\').val() != "")\r\n            unidadeGestora = $(\'#cmbUnidadeGestoraLC option:selected\').val();\r\n\r\n        if (banco == "" || banco == null) { banco = $(\'#cmbUnidadeLC\').val() };\r\n        if (banco == "" || banco == null) {\r\n            if ($(\'#cmbUnidadeCP\').val() != null) {\r\n                banco = $(\'#cmbUnidadeCP\').val().split(\'|\')[1]\r\n            }\r\n\r\n        };\r\n        if (banco == "" || banco == null) { banco = $(\'#cmbUnidadeAR\').val() };\r\n\r\n        //  Prepara URL com par\xe2metros de consulta\r\n        var strURL = "geraxml.asp"\r\n            + "?item=" + itemMenu\r\n            + "&banco=" + banco\r\n            + "&exercicio=" + ano\r\n            + "&dataInicial=" + dataInicial\r\n            + "&dataFinal=" + dataFinal\r\n            + "&unidadeGestora=" + unidadeGestora\r\n            + "&nmFornecedor=" + NomeFornecedor;\r\n\r\n        if ($(\'#txtCPFCNPJFornecedor\').val() != "") {\r\n            CPFCNPJFornecedor = $(\'#txtCPFCNPJFornecedor\').val();\r\n            strURL = strURL + "&CPFCNPJFornecedor=" + CPFCNPJFornecedor;\r\n        }\r\n        if ($(\'#cmbDiariasPassagens\').val() != "") {\r\n            TipoDespesa = $(\'#cmbDiariasPassagens\').val();\r\n            strURL = strURL + "&TipoDespesa=" + TipoDespesa;\r\n        }\r\n        if ($(\'#cmbTipoTransferencia\').val() != "") {\r\n            TipoDespesa = $(\'#cmbTipoTransferencia\').val();\r\n            strURL = strURL + "&TipoDespesa=" + TipoDespesa;\r\n        }\r\n        if ($(\'#cmbTipoEsportacaoDados\').find(\'option:selected\').val() != "") {\r\n            var tipoEsportacao = $(\'#cmbTipoEsportacaoDados\').find(\'option:selected\').val();\r\n            strURL = strURL + "&TipoEsportacaoDados=" + tipoEsportacao;\r\n        }\r\n\r\n\r\n        var iframe = document.createElement("iframe");\r\n        exibirAguarde();\r\n        iframe.id = "ifrmDownload";\r\n        iframe.style.display = "none";\r\n\r\n        var htm = "<iframe id=\'ifrmDownload\' src=\'" + strURL + "\' onload=\'finalizaDownload();\'></iframe>";\r\n        document.getElementById(\'conteudo\').innerHTML = htm;\r\n\r\n        var ST_LOADING = 1\r\n        var ST_LOADED = 4\r\n\r\n        //Verifica erros\r\n        var client = new XMLHttpRequest();\r\n        client.open("GET", strURL, true);\r\n        client.responseType = "blob";\r\n        client.send();\r\n        client.onreadystatechange = function () {\r\n            if (this.readyState == ST_LOADED) {\r\n                if (this.getResponseHeader("ERRO")) {\r\n                    jAlert(this.getResponseHeader("ERRO"), "Aten\xe7\xe3o");\r\n                    exibirAguarde(false);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction finalizaDownload() {\r\n    exibirAguarde(false);\r\n    if (document.getElementById("ifrmDownload").contentWindow.document.getElementById("lnkDownload") != null) {\r\n        document.getElementById("ifrmDownload").src = document.getElementById("ifrmDownload").contentWindow.document.getElementById("lnkDownload").href;\r\n    }\r\n}\r\n\r\nfunction licSituacaoFiltrarPor(item) {\r\n    var sel = $(item).find(\'option:selected\').val();\r\n    if (sel == "Aberta" || sel == "Deserta" || sel == "Frustrada") {\r\n        $("#cmbDataFiltro").find("option[value=3]").remove();\r\n    } else {\r\n        if ($("#cmbDataFiltro").find("option[value=3]").size() == 0) {\r\n            $("#cmbDataFiltro").append($("<option>").val(3).text("DATA DE HOMOLOGA\xc7\xc3O"));\r\n        }\r\n    }\r\n}\r\n\r\n/// Download utilizado para gerar arquivo xml para estrutura organizacional e perguntas frequentes\r\nfunction downloadXMLNovo(itemMenu) {\r\n\r\n    var dataInicial = "";\r\n    var ano = "";\r\n    var dataFinal = "";\r\n    var unidadeGestora = "-1";\r\n    var banco = "";\r\n    var NomeFornecedor = "";\r\n    var CPFCNPJFornecedor = "";\r\n    var TipoDespesa = "";\r\n\r\n\r\n    //  Prepara URL com par\xe2metros de consulta\r\n    var strURL = "geraxml.asp"\r\n        + "?item=" + itemMenu\r\n\r\n    var iframe = document.createElement("iframe");\r\n    exibirAguarde();\r\n    iframe.id = "ifrmDownload";\r\n    iframe.style.display = "none";\r\n\r\n    var htm = "<iframe id=\'ifrmDownload\' src=\'" + strURL + "\' onload=\'finalizaDownload();\'></iframe>";\r\n    document.getElementById(\'conteudo\').innerHTML = htm;\r\n\r\n    var ST_LOADING = 1\r\n    var ST_LOADED = 4\r\n\r\n    //Verifica erros\r\n    var client = new XMLHttpRequest();\r\n    client.open("GET", strURL, true);\r\n    client.responseType = "blob";\r\n    client.send();\r\n    client.onreadystatechange = function () {\r\n        if (this.readyState == ST_LOADED) {\r\n            if (this.getResponseHeader("ERRO")) {\r\n                jAlert(this.getResponseHeader("ERRO"), "Aten\xe7\xe3o");\r\n                exibirAguarde(false);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\nfunction URLoader_Timeout() {\r\n\r\n    if ($(\'#ifrmDownload\').contents().attr(\'readyState\') == \'loading\')\r\n        setTimeout(URLoader_Timeout, 100);\r\n    else {\r\n        exibirAguarde(false);\r\n        document.body.removeChild(document.getElementById("ifrmDownload"));\r\n    }\r\n}\r\nfunction exportarXLS() {\r\n    exportar(1);\r\n}\r\n\r\nfunction exportarPDF() {\r\n    exportar(2);\r\n}\r\n\r\nfunction exportarCSV() {\r\n    exportar(3);\r\n}\r\n\r\nfunction exportarODT() {\r\n    exportar(4);\r\n}\r\n\r\nfunction exportarODS() {\r\n    exportar(5);\r\n}\r\n\r\n\r\nfunction exportar(tipoArquivo) {\r\n\r\n    // var pageCount = $("#tbPageTop").find("tr").find("a").length;\r\n    // if (pageCount > 200) {\r\n    //     alert("N\xe3o \xe9 poss\xedvel realizar exporta\xe7\xe3o com mais de 200 p\xe1ginas de resultado. Por favor refine sua busca.");\r\n    //     return;\r\n    // }\r\n\r\n    exibirAguarde();\r\n\r\n    var locationSearch = window.location.search\r\n    locationSearch = locationSearch.replace("&reestruturacao", "");\r\n\r\n    var url = "index.asp" + locationSearch + "&itensPorPagina=100000&tipoArquivo=" + tipoArquivo;\r\n    url = url.replace("numpag", "undefined");\r\n\r\n    if (window.location.search.indexOf("visao") == -1)\r\n        url = url + "&visao=" + $("#hndvisao").val();\r\n\r\n    $.ajax({\r\n        type: "GET",\r\n        url: url,\r\n        success: function (data) {\r\n            var file = $(data).find("#file").html();\r\n            if (file == null || file == "") {\r\n                alert("N\xe3o h\xe1 informa\xe7\xe3o gerada para exportar!");\r\n                exibirAguarde(false);\r\n            } else {\r\n                window.open(file);\r\n                exibirAguarde(false);\r\n            }\r\n        },\r\n        error: function (jerro) {\r\n            console.log(jerro.responseText);\r\n            exibirAguarde(false);\r\n            alert("Erro ao gerar arquivo! Esta vis\xe3o ainda n\xe3o suporta esse tipo de exporta\xe7\xe3o.");\r\n        }\r\n    });\r\n}\r\n\r\nfunction ExportToCsv(fileName, arquivo) {\r\n    // var data = GetCellValues(arquivo);\r\n    // var csv = ConvertToCsv(data);\r\n    // EstruturaOrganizacional\r\n    //alert("Procedimento dispon\xedvel somente para IE, Chrome e Firefox!")\r\n\r\n    //var download = function(content, fileName, mimeType) {\r\n    //download(csvContent, \'dowload.csv\', \'text/csv\');\r\n\r\n    var fileName = fileName + ".csv";\r\n    var content = arquivo;\r\n    var mimeType = \'text/csv\';\r\n    var a = document.createElement(\'a\');\r\n    mimeType = mimeType || \'application/octet-stream\';\r\n\r\n    if (navigator.msSaveBlob) { // IE10\r\n        return navigator.msSaveBlob(new Blob([content], { type: mimeType }), fileName);\r\n    } else if (\'download\' in a) { //html5 A[download]\r\n        a.href = \'data:\' + mimeType + \',\' + encodeURIComponent(content);\r\n        a.setAttribute(\'download\', fileName);\r\n        document.body.appendChild(a);\r\n        setTimeout(function () {\r\n            a.click();\r\n            document.body.removeChild(a);\r\n        }, 66);\r\n        return true;\r\n    } else { //do iframe dataURL download (old ch+FF):\r\n\r\n        alert("Procedimento dispon\xedvel somente para IE, Chrome, Firefox e Opera!")\r\n\r\n    }\r\n\r\n};\r\nfunction validaCkTipoDespesa() {\r\n    var totalNaoChecadas = 0;\r\n    var totalChecadas = 0;\r\n    $.each($(".tipoDespesa"), function () {\r\n        if (!$(this).attr(\'checked\')) {\r\n            totalNaoChecadas++;\r\n        } else {\r\n            totalChecadas++;\r\n        }\r\n    });\r\n    if (totalChecadas == 0) {\r\n        $(\'.tipoDespesaTodas\').attr(\'checked\', "checked");\r\n        $(\'.tipoDespesa\').attr(\'checked\', \'checked\');\r\n    }\r\n\r\n}\r\nfunction retornaFiltroDespesas() {\r\n    var destino = $("#gridHistMovFrotas tbody");\r\n    var nrMoviemtos;\r\n    var params = "";\r\n    var url_parms = URLParameters();\r\n\r\n    params += "&param1=" + url_parms.id_Veiculo\r\n\r\n    if ($("#quantEspecf").val() != "") {\r\n        params += "&param2=" + $("#quantEspecf").val();\r\n    } else {\r\n        if ($("input[name=\'nrMovimentos\']:checked").val() == undefined) {\r\n            alert(\'Informe uma quantidade de movimentos!\');\r\n            return;\r\n        }\r\n        params += "&param2=" + $("input[name=\'nrMovimentos\']:checked").val()\r\n    }    // quantidade especifica\r\n    if ($("#txtFrotasDespesasIni") && $("#txtFrotasDespesasIni").val() != "") {\r\n        params += "&param3=" + $("#txtFrotasDespesasIni").val().replaceAll("/", "");\r\n    }   //\r\n    if ($("#txtFrotasDespesasFim") && $("#txtFrotasDespesasFim").val() != "") {\r\n        params += "&param4=" + $("#txtFrotasDespesasFim").val().replaceAll("/", "");\r\n    }   //\r\n\r\n    validaCkTipoDespesa();\r\n\r\n    if ($("#ckAbastecimento").is(":checked"))\r\n        params += "&param5=" + $("#ckAbastecimento").val();\r\n    //\r\n    if ($("#ckOutrasManutencoes").is(":checked"))\r\n        params += "&param6=" + $("#ckOutrasManutencoes").val();\r\n    //\r\n    if ($("#ckImpostos").is(":checked"))\r\n        params += "&param7=" + $("#ckImpostos").val();\r\n    //\r\n    if ($("#ckTodasDespesasFrotas").is(":checked"))\r\n        params += "&param8=" + $("#ckTodasDespesasFrotas").val();\r\n\r\n    params += "&param9=" + $("input[name=\'ordenacao\']:checked").val();\r\n    //\r\n    //console.log(params)\r\n    $.ajax({\r\n        type: "GET",\r\n        url: "acao.asp?acao=RetornaMontaFrotasItens" + replaceAll(params, "/", "|"),\r\n        dataType: "json",\r\n        success: function (jdados) {\r\n            $(\'.histMovi\').remove();\r\n            var htm = "";\r\n            if (jdados.Dados.length > 0) {\r\n\r\n                htm = "";\r\n                for (x = 0; x < jdados.Dados.length; x++) {\r\n                    var dado = jdados.Dados[x];\r\n                    htm += "<tr class=\'histMovi\'>";\r\n                    htm += "<td style=\'white-space: nowrap;\' align=\'center\'>" + dado.dtEvento + "</td>";\r\n                    htm += "<td style=\'white-space: nowrap;\' align=\'left\'>" + dado.dsEvento + "</td>";\r\n                    htm += "<td style=\'white-space: nowrap;\' align=\'right\'>" + dado.qtLancamento + "</td>";\r\n                    htm += "<td style=\'white-space: nowrap;\' align=\'center\'>" + dado.vlLancamento + "</td>";\r\n                    htm += "<td style=\'white-space: nowrap;\' align=\'center\'>" + dado.vlTotalDespesa + "</td>";\r\n                    htm += "</tr>";\r\n                };\r\n            } else {\r\n                htm += "<tr class=\'histMovi\'>";\r\n                htm += "<td colspan=\'5\' style=\'white-space: nowrap;\' align=\'center\'>N\xe3o existe movimentos nesse per\xedodo.</td>";\r\n                htm += "</tr>";\r\n            }\r\n            $(\'#gridHistMovFrotas\').append(htm);\r\n        },\r\n        error: function (jerro) {\r\n            var htm = "";\r\n            htm += "<tr class=\'histMovi\'>";\r\n            htm += "<td colspan=\'5\' style=\'white-space: nowrap;\' align=\'center\'>Erro ao retornar movimentos para o per\xedodo.</td>";\r\n            htm += "</tr>";\r\n            $(\'#gridHistMovFrotas\').append(htm);\r\n        }\r\n    });\r\n}\r\nfunction URLParameters() {\r\n    var result = {};\r\n\r\n    var params = window.location.search.split(/\\?|\\&/);\r\n\r\n    params.forEach(function (it) {\r\n        if (it) {\r\n            var param = it.split("=");\r\n            result[param[0]] = param[1];\r\n        }\r\n    });\r\n\r\n    return result;\r\n}\r\n\r\n\r\n\r\nfunction atualizarNomes() {\r\n    var paramNome = $("#txtNomeFornecedor");\r\n    var paramDataBase = "";\r\n    var arrayResult = [];\r\n    var obj = $("#cmbUnidadeCP");\r\n    if (obj && obj.val() != "") {\r\n        paramDataBase = obj.val().split(\'|\')[1];\r\n    }\r\n    if (paramDataBase != "") {\r\n        $.ajax({\r\n            type: "GET",\r\n            url: "acao.asp?acao=ConsultaNomeServidor&param1=" + paramNome.val() + "&param2=" + paramDataBase,\r\n            dataType: "json",\r\n            success: function (jdados) {\r\n                for (var i = 0; i < jdados.length; i++) {\r\n                    var objResult = jdados[i];\r\n                    arrayResult.push(objResult.Nome);\r\n                }\r\n                $(function () {\r\n                    $("#txtNomeFornecedor").autocomplete({\r\n                        source: arrayResult\r\n                    });\r\n                });\r\n            },\r\n            error: function (jerro) {\r\n                if (jerro.responseText != "")\r\n                    alert(jerro.responseText + "Erro ao fazer a consulta auto-complete dos Nomes!");\r\n            }\r\n        });\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\nfunction preencheComboUnidadeGestoraAR() {\r\n\r\n    var destino = $("#cmbUnidadeGestoraAR");\r\n    if ((destino) && (destino.is(":visible"))) {\r\n        limparDados("cmbUnidadeGestoraAR");\r\n        destino.css("background-color", "#cecece");\r\n\r\n        destino.attr("disabled", true);\r\n        $.ajax({\r\n            type: "GET",\r\n            global: false,\r\n            url: "acao.asp",\r\n            data: "acao=RetornaUnidadeGestoraAR&param1=" + $("#cmbUnidadeAR").select().val() + "&param2=" + $("#cmbAno").select().val() + "&param3=" + $("#cmbUnidadeAR").find(":selected").text(),\r\n            dataType: "json",\r\n            cache: false,\r\n            success: function (jdados) {\r\n                limparDados("cmbUnidadeGestoraAR");\r\n                if (jdados) {\r\n                    if (jdados.Dados.length > 0) {\r\n                        destino.removeAttr("disabled");\r\n                        for (x = 0; x < jdados.Dados.length; x++) {\r\n                            var dado = jdados.Dados[x];\r\n                            var optn = document.createElement("OPTION");\r\n                            optn.text = dado.text;\r\n                            optn.value = dado.id;\r\n                            destino.find("option").end().append("<option value=\'" + dado.id + "\'>" + dado.text + "</option>").val("\'" + dado.id + "\'");\r\n                        };\r\n                    }\r\n                }\r\n                destino.css("background-color", "#ffffff");\r\n                destino.attr("disabled", false);\r\n            },\r\n            error: function (jerro) {\r\n                alert(jerro.responseText);\r\n                destino.css("background-color", "#ffffff");\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n\r\n\r\nfunction incializaValoresPadraoCP(limpaCampo) {\r\n\r\n    if (limpaCampo === undefined) {\r\n        limpaCampo = true;\r\n    }\r\n\r\n    // DRO - 355383 - 23/11/2018 - Inicio\r\n    //setTimeout(function () {\r\n    //    consultarMes(\'\', \'cmbMesInicial\', \'cmbUnidadeCP\', \'CP_Fato_EmpenhoDespesa\', \'CP_Fato_saldodespesa\');\r\n    //}, 0);\r\n    //setTimeout(function () {\r\n    //    if ($("#cmbMesInicial").val() != null) {\r\n    //        consultarMes(\'cmbMesInicial\', \'cmbMesFinal\', \'cmbUnidadeCP\', \'CP_Fato_EmpenhoDespesa\', \'CP_Fato_saldodespesa\');\r\n    //    }\r\n    //}, 10);\r\n    // DRO - 355383 - 23/11/2018 - Fim\r\n\r\n    //Formata data dd//mm/yyyy\r\n    function dataFormatada(dataAtual, dia) {\r\n        var data = dataAtual,\r\n            // dia = data.getDate(),\r\n            mes = ("0" + (data.getMonth() + 1)).slice(-2),\r\n            ano = data.getFullYear();\r\n        if ($(\'#cmbAno option:selected\').text() != data.getFullYear()) {\r\n            if ($(\'#cmbAno option:selected\').text() != "") {\r\n                ano = $(\'#cmbAno option:selected\').text();\r\n            };\r\n        };\r\n        return [dia, mes, ano].join(\'/\');\r\n    }\r\n\r\n\r\n    //Retorna \xfaltimo dia do m\xeas\r\n    function retornaUltimoDiaDoMes(data) {\r\n        return (new Date(data.getFullYear(), data.getMonth() + 1, 0)).getDate();\r\n    }\r\n    if ($("#hndAcao").val() == 3) {                                                                                                                                                                                                                                                                                                                                                                                                                                             //DRO - 19522 - 21/06/2021\r\n        if ($("#hndItem").val() == 11 || $("#hndItem").val() == 12 || $("#hndItem").val() == 8 || $("#hndItem").val() == 9 || $("#hndItem").val() == 13 || $("#hndItem").val() == 4 || $("#hndItem").val() == 7 || $("#hndItem").val() == 3 || $("#hndItem").val() == 1 || $("#hndItem").val() == 2 || $("#hndItem").val() == 6 || $("#hndItem").val() == 5 || $("#hndItem").val() == 15 || $("#hndItem").val() == 16 || $("#hndItem").val() == 17 || $("#hndItem").val() == 10 || $("#hndItem").val() == 92) {\r\n            $("#txtDataInicial").val(dataFormatada(new Date, \'01\'));\r\n            $("#txtDataFinal").val(dataFormatada(new Date, retornaUltimoDiaDoMes(new Date)));\r\n        }\r\n        // DRO - 355686 - 11/12/2018 - Inicio\r\n        // DRO - 356474 - 13/12/2018 - Inicio\r\n        // else if ($("#hndItem").val() == 20 || $("#hndItem").val() == 21) {\r\n        else if ($("#hndItem").val() == 20 || $("#hndItem").val() == 21 || $("#hndItem").val() == 14) {\r\n            // DRO - 356474 - 13/12/2018 - Fim\r\n            consultarMes(\'\', \'cmbMesInicial\', \'cmbUnidadeCP\', \'CP_Fato_EmpenhoDespesa\', \'CP_Fato_saldodespesa\');\r\n\r\n            if ($("#cmbMesInicial").val() != null) {\r\n                consultarMes(\'cmbMesInicial\', \'cmbMesFinal\', \'cmbUnidadeCP\', \'CP_Fato_EmpenhoDespesa\', \'CP_Fato_saldodespesa\');\r\n            }\r\n        }\r\n        // DRO - 355686 - 11/12/2018 - Fim\r\n    }\r\n\r\n\r\n    var cmbMesFinal = $("#cmbMesFinal");\r\n\r\n    //Como a chamada \xe9 feita para o mesmo m\xe9todo que recebe v\xe1rios parametroso timeout controla a sequencia para n\xe1o enviar valores ainda n\xe3o carregados.\r\n    //Sugest\xe3o de melhoria criar metodos espec\xedficos e carregar no callback quando houver depend\xeancia.\r\n    setTimeout(function () {\r\n        //Verifica se o campo \xe9 tipo text ou select para aplicar valores default \r\n        if (cmbMesFinal.val() != null && cmbMesFinal.val() != \'\') {\r\n            consultarDadosCP(\'UnidadeGestoraMes\', \'cmbUnidadeGestora\', \'cmbMesInicial\', \'cmbMesFinal\', \'CP_Fato_EmpenhoDespesa\', \'CP_Fato_saldodespesa\', \'cmbUnidadeCP\');\r\n            var ultimaOpcaoMesFinal;\r\n            $("#cmbMesFinal option").each(function () {\r\n                ultimaOpcaoMesFinal = $(this).val();\r\n            });\r\n            $("#cmbMesFinal").val(ultimaOpcaoMesFinal);\r\n\r\n        } else if ($("#cmbUnidadeCP").val() != null && $("#cmbUnidadeCP").val() != \'\') {\r\n            //DRO - 353374 - 24/10/2018 - Inicio\r\n            //consultarDadosCP(\'UnidadeGestora\', \'cmbUnidadeGestora\', \'txtDataInicial\', \'txtDataFinal\', \'CP_Fato_MovimentoReceita\', \'\', \'cmbUnidadeCP\', limpaCampo);\r\n            //consultarDadosCP(\'UnidadeGestora\', \'cmbUnidadeGestora\', \'txtDataInicial\', \'txtDataFinal\', \'CP_Fato_EmpenhoDespesa\', \'CP_Fato_saldodespesa\', \'cmbUnidadeCP\', limpaCampo);\r\n            if ($("#hndItem").val() == 92 || $("#hndItem").val() == 94 || $("#hndItem").val() == 95 || $("#hndItem").val() == 97) {\r\n                SetarBancoDados(\'UnidadeGestoraCP\', \'cmbUnidadeGestora\', \'txtDataInicial\', \'txtDataFinal\', \'CP_Fato_EmpenhoDespesa\', \'CP_Fato_saldodespesa\', \'cmbUnidadeCP\', \'\');\r\n            } else {\r\n                consultarDadosCP(\'UnidadeGestoraCP\', \'cmbUnidadeGestora\', \'txtDataInicial\', \'txtDataFinal\', \'CP_Fato_EmpenhoDespesa\', \'CP_Fato_saldodespesa\', \'cmbUnidadeCP\', limpaCampo);\r\n                //DRO - 353374 - 24/10/2018 - Fim\r\n            };\r\n\r\n        }\r\n    }, 20);\r\n}\r\n\r\n\r\n\r\nfunction alteraAno() {\r\n    //CP\r\n    limparDados(\'cmbUnidadeCP\');\r\n    limparDados(\'cmbMesInicial\');\r\n    limparDados(\'cmbMesFinal\');\r\n    limparDados(\'txtDataInicial\');\r\n    limparDados(\'txtDataFinal\');\r\n    limparDados(\'cmbUnidadeGestora\');\r\n    limparDados(\'cmbCategoria\');\r\n    limparDados(\'cmbEstoqueUnidadeCM\');\r\n\r\n\r\n\r\n\r\n    consultarDados(\'ConsultarUnidadeCP\', \'cmbUnidadeCP\', \'cmbAno\');\r\n    alteraEntidade();\r\n}\r\n\r\nfunction retornaNomeAplicacaoDWS() {\r\n    var url = window.location.href;\r\n\r\n    var urls = url.split("/");\r\n\r\n    for (var i = 0; i < urls.length; i++) {\r\n\r\n        if (i == 3) {\r\n            if (urls[i] === "index.asp") {\r\n                nomeAplicacaoDWS = "pronimtb";\r\n            } else {\r\n                nomeAplicacaoDWS = urls[i];\r\n                servidorUnico = true;\r\n            }\r\n\r\n        } else {\r\n            if (!servidorUnico) {\r\n                nomeAplicacaoDWS = "pronimtb";\r\n            }\r\n        }\r\n\r\n    }\r\n}\r\n\r\nfunction PublicacoesCovid(pagina) {\r\n\r\n    retornaNomeAplicacaoDWS();\r\n    var meuHost = location.host;\r\n    var meuprotocolo = location.protocol;\r\n\r\n    if (pagina == "paginaprincipalcovid") {\r\n        window.location.href = meuprotocolo + "//" + meuHost + "/" + nomeAplicacaoDWS + "/index.asp?acao=21&item=1&visao=paginaprincipalcovid";\r\n    }\r\n    if (pagina == "publicacaocovid") {\r\n        window.location.href = meuprotocolo + "//" + meuHost + "/" + nomeAplicacaoDWS + "/index.asp?acao=21&item=1&visao=publicacaocovid";\r\n    }\r\n}\r\n\r\nfunction LicitacoesCalamidadePublica() {\r\n\r\n    retornaNomeAplicacaoDWS();\r\n    var meuHost = location.host;\r\n    var meuprotocolo = location.protocol;\r\n\r\n    window.location.href = meuprotocolo + "//" + meuHost + "/" + nomeAplicacaoDWS + "/index.asp?acao=1&item=91&visao=0";\r\n}\r\nfunction ContratosCalamidadePublica() {\r\n\r\n    retornaNomeAplicacaoDWS()\r\n    var meuHost = location.host;\r\n    var meuprotocolo = location.protocol;\r\n\r\n    window.location.href = meuprotocolo + "//" + meuHost + "/" + nomeAplicacaoDWS + "/index.asp?acao=1&item=90&visao=0";\r\n}\r\nfunction DespesasCalamidadePublica() {\r\n\r\n    retornaNomeAplicacaoDWS()\r\n    var meuHost = location.host;\r\n    var meuprotocolo = location.protocol;\r\n\r\n    window.location.href = meuprotocolo + "//" + meuHost + "/" + nomeAplicacaoDWS + "/index.asp?acao=3&item=92&visao=0";\r\n}\r\nfunction ReceitasCalamidadePublica() {\r\n\r\n    retornaNomeAplicacaoDWS()\r\n    var meuHost = location.host;\r\n    var meuprotocolo = location.protocol;\r\n\r\n    window.location.href = meuprotocolo + "//" + meuHost + "/" + nomeAplicacaoDWS + "/index.asp?acao=3&item=94&visao=0";\r\n}\r\n\r\nfunction ReceitasXDespesasCalamidadePublica() {\r\n    var meuHost = location.host;\r\n    var meuprotocolo = location.protocol;\r\n    window.location.href = meuprotocolo + "//" + meuHost + "/" + nomeAplicacaoDWS + "/index.asp?acao=3&item=95&visao=0";\r\n}\r\n\r\n\r\nfunction PessoalCalamidadePublica() {\r\n\r\n    retornaNomeAplicacaoDWS()\r\n    var meuHost = location.host;\r\n    var meuprotocolo = location.protocol;\r\n\r\n    window.location.href = meuprotocolo + "//" + meuHost + "/" + nomeAplicacaoDWS + "/index.asp?acao=4&item=93&visao=0";\r\n}\r\n\r\nfunction PatrimonioCalamidadePublica() {\r\n\r\n    retornaNomeAplicacaoDWS()\r\n    var meuHost = location.host;\r\n    var meuprotocolo = location.protocol;\r\n\r\n    window.location.href = meuprotocolo + "//" + meuHost + "/" + nomeAplicacaoDWS + "/index.asp?acao=1&item=96&visao=0";\r\n}\r\n\r\nfunction ComprasDiretasCalamidadePublica() {\r\n    retornaNomeAplicacaoDWS()\r\n    var meuHost = location.host;\r\n    var meuprotocolo = location.protocol;\r\n\r\n    window.location.href = meuprotocolo + "//" + meuHost + "/" + nomeAplicacaoDWS + "/index.asp?acao=3&item=97&visao=0";\r\n}\r\n\r\nfunction RedirecionaFiltroLicitacoes() {\r\n    var meuHost = location.host;\r\n    var meuprotocolo = location.protocol;\r\n    window.location.href = meuprotocolo + "//" + meuHost + "/pronimtb/index.asp?acao=1&item=2&flagRedFiltroLicitacao=1";\r\n}\r\n\r\nfunction RetornaTemaCovid(idTema) {\r\n    var meuHost = location.host;\r\n    var meuprotocolo = location.protocol;\r\n    window.location.href = meuprotocolo + "//" + meuHost + "/" + nomeAplicacaoDWS + "/index.asp?acao=21&item=1&visao=publicacaocalamidade&IdTema=" + idTema;\r\n\r\n}\r\n\r\n//Monta Mapa do site\r\n\r\nfunction retornaTamanhoMenu(menuVetor) {\r\n    if (menuVetor === 0) {\r\n        tamanhoMenu = st_menus[0].bodys.length;\r\n        return tamanhoMenu;\r\n    } else {\r\n        tamanhoMenu = (st_menus[0].bodys.length - 1);\r\n        temSubMenu = true;\r\n        return tamanhoMenu;\r\n    }\r\n}\r\nvar tamanhoMenu = 0;\r\nvar temSubMenu = false;\r\n\r\nvar objJSON = [];\r\nvar listaSubMenu = [];\r\nvar listaSubMenuFilho = [];\r\nvar subMenuJSON = "";\r\nvar subMenuFilhoJSON = "";\r\nvar jaPassou = false;\r\nvar retornogeradorMenu = false;\r\n\r\nfunction montaMapaSite(st_menus) {\r\n    var menus = st_menus;\r\n    var html = "";\r\n    var cont = 0;\r\n\r\n    $("#home").css("display", "none");\r\n    $("#conteudo").css("display", "none");\r\n    $(".ClassForm").css("display", "none");\r\n    $("#formulario").css("display", "none");\r\n    $("#cmbRef").css("display", "none");\r\n    $(".finalidade").css("display", "none");\r\n    $("#mapaSite").css("display", "block");\r\n\r\n    html += "<ul style=\'list-style-type: none;\'>";\r\n    tamanhoMenu = retornaTamanhoMenu(0);\r\n    //Monta vis\xe3o 0 do menu\r\n    for (var i = 0; i < tamanhoMenu; i++) {\r\n        subMenuJSON = "";\r\n        if (menus[0].bodys[0].items[i] !== undefined) {\r\n            if (menus[0].bodys[0].items[i].url === "") {\r\n                html += "<li style=\'cursor: grab;\'><strong>" + menus[0].bodys[0].items[i].text + "</strong></li>";\r\n\r\n                if (menus[0].bodys[0].items[i].sub === null) {\r\n                    cont = cont + 1;\r\n                } else {\r\n                    cont = menus[0].bodys[0].items[i].sub[1];\r\n                }\r\n\r\n                var subMenu = menus[0].bodys[cont].items;\r\n                var temSubMenus = menus[0].bodys[cont].items.length;\r\n                var sHbhtml = montaSubmenu(subMenu, i, "", false, temSubMenus);\r\n                jaPassou = false;\r\n\r\n                html += sHbhtml;\r\n            } else {\r\n                if (temSubMenu) {\r\n                    cont = cont + 1;\r\n                    html += "<li title=\'" + menus[0].bodys[0].items[i].text + "\'><a href=" + montaURLDetalhamentoItemMapaSite(menus[0].bodys[0].items[i].url) + ">" + menus[0].bodys[0].items[i].text + "</a></li>";\r\n                    objJSON.push({\r\n                        "nome": menus[0].bodys[0].items[i].text,\r\n                        "url": montaURLDetalhamentoItemMapaSite(menus[0].bodys[0].items[i].url),\r\n                        "subMenu": ""\r\n                    });\r\n                    jaPassou = true;\r\n                } else {\r\n                    html += "<li title=\'" + menus[0].bodys[0].items[i].text + "\'><a href=" + montaURLDetalhamentoItemMapaSite(menus[0].bodys[0].items[i].url) + ">" + menus[0].bodys[0].items[i].text + "</a></li>";\r\n\r\n                    objJSON.push({\r\n                        "nome": menus[0].bodys[0].items[i].text,\r\n                        "url": montaURLDetalhamentoItemMapaSite(menus[0].bodys[0].items[i].url),\r\n                        "subMenu": ""\r\n                    });\r\n                    jaPassou = true;\r\n                }\r\n\r\n            }\r\n\r\n            if (temSubMenu && jaPassou === false) {\r\n                objJSON.push({\r\n                    "nome": menus[0].bodys[0].items[i].text,\r\n                    "url": "",\r\n                    "subMenu": JSON.parse(JSON.stringify(listaSubMenu))\r\n                });\r\n            } else if (temSubMenus > 0 && temSubMenu === false && jaPassou === false) {\r\n                objJSON.push({\r\n                    "nome": menus[0].bodys[0].items[i].text,\r\n                    "url": "",\r\n                    "subMenu": JSON.parse(JSON.stringify(listaSubMenu))\r\n                });\r\n            }\r\n\r\n            listaSubMenu = [];\r\n\r\n        }\r\n\r\n    }\r\n    html += "</ul>";\r\n    document.getElementById(\'listaMenuMapaSite\').innerHTML = html;\r\n    retornogeradorMenu = false;\r\n    //var url = window.location.href;\r\n    //verificaChamadaGeraMenuJSON(url);\r\n    //if (retornogeradorMenu === true) {\r\n    //    montaObjItensMenuPeloMapaSite();\r\n    //}\r\n\r\n}\r\n\r\n//Monta o submenu\r\nvar eSubMenuFilho = false;\r\nfunction montaSubmenu(subMenu, iTitulo, titulo, temSubMenus) {\r\n    var htm = "<ul style=\'list-style-type: none;\'>";\r\n    listaSubMenuFilho = [];\r\n    subMenuFilhoJSON = "";\r\n    subMenuJSON = "";\r\n    var nivel;\r\n    for (var x = 0; x < subMenu.length; x++) {\r\n        subMenuJSON = "";\r\n        subMenuFilhoJSON = "";\r\n        if (subMenu[x].url !== "") {\r\n            if (titulo !== "") {\r\n                htm += "<li style=\'padding-top: 5px;\' title=\'" + st_menus[0].bodys[0].items[iTitulo].text + " -> " + titulo + " -> " + subMenu[x].text + "\'><a href=" + montaURLDetalhamentoItemMapaSite(subMenu[x].url) + ">" + subMenu[x].text + "</a></li>";\r\n                if (eSubMenuFilho) {\r\n                    subMenuFilhoJSON = {\r\n                        "nome": subMenu[x].text,\r\n                        "url": montaURLDetalhamentoItemMapaSite(subMenu[x].url),\r\n                        "subMenu": []\r\n                    };\r\n                } else {\r\n                    subMenuJSON = {\r\n                        "nome": titulo,\r\n                        "url": montaURLDetalhamentoItemMapaSite(subMenu[x].url),\r\n                        "subMenu": []\r\n                    };\r\n                }\r\n\r\n            } else {\r\n                htm += "<li style=\'padding-top: 5px;\' title=\'" + st_menus[0].bodys[0].items[iTitulo].text + " -> " + subMenu[x].text + "\'><a href=" + montaURLDetalhamentoItemMapaSite(subMenu[x].url) + ">" + subMenu[x].text + "</a></li>";\r\n\r\n                if (eSubMenuFilho) {\r\n                    subMenuFilhoJSON = {\r\n                        "nome": subMenu[x].text,\r\n                        "url": montaURLDetalhamentoItemMapaSite(subMenu[x].url),\r\n                        "subMenu": []\r\n                    };\r\n                } else {\r\n                    subMenuJSON = {\r\n                        "nome": subMenu[x].text,\r\n                        "url": montaURLDetalhamentoItemMapaSite(subMenu[x].url),\r\n                        "subMenu": []\r\n                    };\r\n                }\r\n\r\n            }\r\n\r\n        } else {\r\n            htm += "<li style=\'cursor: grab;\' id=\'box-toggle\' title=\'" + st_menus[0].bodys[0].items[iTitulo].text + " -> " + subMenu[x].text + "\'><strong>" + subMenu[x].text + "</strong></li>";\r\n\r\n            if (eSubMenuFilho) {\r\n                subMenuFilhoJSON = {\r\n                    "nome": subMenu[x].text,\r\n                    "url": "",\r\n                    "subMenu": []\r\n                };\r\n            } else {\r\n                subMenuJSON = {\r\n                    "nome": subMenu[x].text,\r\n                    "url": "",\r\n                    "subMenu": []\r\n                };\r\n            }\r\n\r\n            if (subMenu[x].url === "") {\r\n                eSubMenuFilho = true;\r\n                tamanhoMenu = retornaTamanhoMenu(-1);\r\n                nivel = subMenu[x].sub[1];\r\n                var xhtml = montaSubmenu(st_menus[0].bodys[nivel].items, iTitulo, subMenu[x].text);\r\n                eSubMenuFilho = false;\r\n                htm += xhtml;\r\n            }\r\n\r\n        }\r\n        if (eSubMenuFilho) {\r\n            listaSubMenuFilho.push(subMenuFilhoJSON);\r\n            if (nivel !== undefined) {\r\n                jaPassou = false;\r\n            } else {\r\n                jaPassou = true;\r\n            }\r\n\r\n        } else {\r\n            if (subMenuJSON !== "" && (subMenuJSON.url === "\'index.asp?acao=3&item=12\'" || subMenuJSON.url === "\'./Help_TB/TransparenciaBR_Receitas/index.htm\'" || subMenuJSON.url === "\'./Help_TB/TransparenciaBR_Despesas/index.htm\'" || subMenuJSON.url === "\'./Help_TB/TransparenciaBR_GestaodePessoas/index.htm\'")) {\r\n                listaSubMenu.push(subMenuJSON);\r\n            }\r\n            else if (listaSubMenuFilho.length < 1 && eSubMenuFilho === false && jaPassou === false) {\r\n                listaSubMenu.push(subMenuJSON);\r\n            } else if (temSubMenus > 0) {\r\n                listaSubMenu.push(subMenuJSON);\r\n            } else if (temSubMenus === false && eSubMenuFilho === false && listaSubMenuFilho.length < 1 && jaPassou && nivel === undefined) {\r\n                listaSubMenu.push(subMenuJSON);\r\n            }\r\n        }\r\n\r\n\r\n    }\r\n    if (eSubMenuFilho) {\r\n        subMenuJSON = {\r\n            "nome": titulo,\r\n            "url": "",\r\n            "subMenu": JSON.parse(JSON.stringify(listaSubMenuFilho))\r\n        };\r\n        listaSubMenu.push(subMenuJSON);\r\n        listaSubMenuFilho = [];\r\n    }\r\n    eSubMenuFilho = false;\r\n    htm += "</ul>";\r\n    return htm;\r\n}\r\n\r\nfunction montaURLDetalhamentoItemMapaSite(urlItem) {\r\n    var link = urlItem.split("\'");\r\n    return "\'" + link[1].replace("\'", "") + "\'";\r\n}\r\n//Fim Mapa do site\r\n\r\n//In\xedcio: Monta um objeto JSON dos Itens de menu\r\nfunction verificaChamadaGeraMenuJSON(url) {\r\n    var urls = url.split(\'?\');\r\n    for (var i = 0; i < urls.length; i++) {\r\n        if (urls[i] === "geradorMenu") {\r\n            retornogeradorMenu = true;\r\n        }\r\n    }\r\n}\r\nfunction montaObjItensMenuPeloMapaSite() {\r\n    montaMapaSite(st_menus);\r\n    document.getElementById(\'listaMenuMapaSite\').innerHTML = JSON.stringify(objJSON);\r\n    downloadDiv("menu.json", "listaMenuMapaSite", "application/json");\r\n}\r\n\r\nfunction downloadDiv(nomeArquivo, elementoId, mimeType) {\r\n\r\n    if ($(\'#listaMenuMapaSite\').html() == "") {\r\n\r\n        console.log("Erro!", "Menu est\xe1 vazio.", "error");\r\n\r\n    } else {\r\n\r\n        var elementoHtml = document.getElementById(elementoId).innerHTML;\r\n        var link = document.createElement(\'a\');\r\n        var file = new Blob([elementoHtml], { type: mimeType });\r\n\r\n        link.setAttribute(\'download\', nomeArquivo);\r\n        link.href = URL.createObjectURL(file);\r\n        link.click();\r\n\r\n        console.log("Sucesso!", "Foi feito o download dos menus em JSON com sucesso!", "success");\r\n\r\n    }\r\n\r\n}\r\n\r\n//Fim: Monta um objeto JSON dos Itens de menu\r\n\r\n//Caminho Pecorrido da Paginas\r\nfunction CaminhoPag(st_menus) {\r\n    var CaminhoPagPec = st_menus;\r\n    var tamanhoMenu = retornaTamanhoMenu(0);\r\n    var url = window.location.href.replace(window.location.origin + \'/\', \'\');\r\n    var count = 0;\r\n    var nomeCaminho;\r\n    // em caso de debug nomeAplicacaoDWS dever\xe1 ser = pronimtb\r\n    url = url.replace(nomeAplicacaoDWS, \'\');\r\n    url = url.replace(\'/\', \'\');\r\n    url = "javascript:limparCookies();location.href=\'" + url + "\'";\r\n    // em caso  de sub menu fun\xe7\xe3o obter mais submenu\r\n    if (window.location.search.substring(0, 14) === \'?acao=3&item=7\') {\r\n        nomeCaminho = "In\xedcio > Despesas > Fun\xe7\xe3o";\r\n    }\r\n    for (var i = 0; i < tamanhoMenu; i++) {\r\n        if (nomeCaminho == undefined) {\r\n            if (CaminhoPagPec[0].bodys[0].items[i] !== undefined) {\r\n                if (CaminhoPagPec[0].bodys[0].items[i].url === "") {\r\n                    if (CaminhoPagPec[0].bodys[0].items[i].sub === null) {\r\n                        count = count + 1\r\n                    } else {\r\n                        count = CaminhoPagPec[0].bodys[0].items[i].sub[1];\r\n                    }\r\n                }\r\n            }\r\n            var CaminhoPagPecsubMenu = CaminhoPagPec[0].bodys[count].items;\r\n            for (var x = 0; x < CaminhoPagPecsubMenu.length; x++) {\r\n                var subMenu = "";\r\n                if (CaminhoPagPecsubMenu[x].url === "" && url != 0) {\r\n                    var nivel = CaminhoPagPecsubMenu[x].sub[1];\r\n                    tamanhoMenu = retornaTamanhoMenu(-1);\r\n                    subMenu = CaminhoPagPecsubMenu[x].text;\r\n                    var subMenu2 = st_menus[0].bodys[nivel].items;\r\n                    for (var y = 0; y < subMenu2.length; y++) {\r\n                        if (subMenu2[y].url === url) {\r\n                            nomeCaminho = "In\xedcio > " + CaminhoPagPec[0].bodys[0].items[i].text + " > " + subMenu + " > " + subMenu2[y].text;\r\n                            subMenu = "";\r\n                        }\r\n                    }\r\n                } else if (CaminhoPagPecsubMenu[x].url !== "" && url != "" && CaminhoPagPecsubMenu[x].url == url) {\r\n                    if (CaminhoPagPecsubMenu[x].url == url && url != "" && nomeCaminho === undefined) {\r\n                        nomeCaminho = "In\xedcio > " + CaminhoPagPec[0].bodys[0].items[i].text + " > " + CaminhoPagPecsubMenu[x].text;\r\n                        url = 0;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (nomeCaminho != undefined) {\r\n            document.getElementById("caminhoPag").innerHTML = nomeCaminho;\r\n        }\r\n    }\r\n}\r\n'}